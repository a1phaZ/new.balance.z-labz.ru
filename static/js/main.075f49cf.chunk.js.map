{"version":3,"sources":["handlers/currency.js","components/ListOfItems.js","state/actions.js","state/index.js","components/InfoSnackbar.js","components/MonthSwitch.js","panels/Home.js","handlers/useApi.js","handlers/validate.js","components/modals/AddAccount.js","components/modals/AddMoney.js","handlers/mapRichCell.js","handlers/sort.js","handlers/reduce.js","panels/AccountInfo.js","panels/Budgets.js","components/modals/AddBudget.js","panels/BudgetInfo.js","panels/Stats.js","handlers/mapStats.js","panels/InitialScreen.js","App.js","index.js"],"names":["number","Intl","NumberFormat","style","currency","format","data","showAll","dispatch","itemsName","needHide","useState","isShow","setIsShow","length","list","sort","a","b","sum","map","account","index","console","log","key","indicator","expandable","data-id","_id","onClick","e","type","payload","id","currentTarget","dataset","view","panel","title","weight","marginBottom","push","initialState","accounts","budgets","budget","modal","successMessage","error","activeView","activePanel","popout","editedItem","currentDate","Date","history","modalsHistory","popoutHistory","canClose","scheme","reducer","state","action","window","pushState","lastHistoryState","backEl","newHistory","pop","accountId","find","item","budgetId","message","date","State","createContext","StateProvider","children","value","useReducer","Provider","InfoSnackbar","useContext","snackbar","setSnackbar","useEffect","onClose","before","color","onRefresh","disabled","isAfter","addMonths","clickTime","setClickTime","timeNow","subMonths","mode","asideContent","textAlign","fontWeight","locale","ru","toLocaleUpperCase","Home","isFetching","sumOfAll","el","reduce","acc","cur","left","MonthSwitch","header","separator","level","ListOfItems","url","isLoading","setLoading","response","setResponse","setError","options","setOptions","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","process","headers","queryString","parse","location","search","axios","then","catch","Error","fetchData","validity","valid","status","badInput","valueMissing","tooLong","typeMismatch","rangeOverflow","rangeUnderflow","titleValidation","sumValidation","stateForm","dispatchForm","useApi","onSubmit","preventDefault","placeholder","top","required","maxLength","bottom","onChange","replace","validate","max","min","step","size","income","description","price","quantity","tags","boxPrice","validateForm","apiStr","accountList","tag","marginRight","itemFrom","defaultValue","name","defaultChecked","join","toLowerCase","split","display","flexWrap","mapRichCell","titleDate","caps","ruLocale","multiline","caption","after","aDate","bDate","compareAsc","prev","curr","isEqual","isOpened","setIsOpened","operations","items","setItems","filteredItems","setFilteredItems","accountItemsList","toggleContext","alert","actions","autoclose","aside","transform","opened","str","filter","indexOf","budgetsStartSum","startSum","budgetsSum","deletedCount","alertDelete","itemsList","flat","localeCompare","setOperations","prevItem","array","slice","data-title","loading","icon","stretched","App","os","platform","needFetch","setNeedFetch","lastBackAction","setLastBackAction","bridge","subscribe","detail","send","onpopstate","modalBack","activeModal","ANDROID","right","IOS","AddAccount","AddMoney","AddBudget","onStoryChange","story","tabBar","selected","data-story","data-panel","text","activeStory","tabbar","InitialScreen","AccountInfo","BudgetInfo","Budgets","Stats","ReactDOM","render","document","getElementById","URL","href","searchParams","get","toString"],"mappings":"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","file":"static/js/main.075f49cf.chunk.js","sourcesContent":["export default (number) => {\r\n\treturn new Intl.NumberFormat('ru-RU', {style: 'currency', currency: 'RUB'}).format(number);\r\n}","import React, {useState} from 'react';\r\nimport Cell from \"@vkontakte/vkui/dist/components/Cell/Cell\";\r\nimport {Footer, Text} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport {SET_ACCOUNT, SET_ACTIVE_VIEW, SET_BUDGET} from \"../state/actions\";\r\n\r\nexport default ({data, showAll = false, dispatch, itemsName, needHide = true}) => {\r\n\tconst [isShow, setIsShow] = useState(() => {\r\n\t\treturn showAll;\r\n\t});\r\n\r\n\tif (data.length === 0) {\r\n\t\tif (itemsName === 'accounts') {\r\n\t\t\treturn <Footer>Нет счетов для отображения</Footer>\r\n\t\t}\r\n\t\tif (itemsName === 'budgets') {\r\n\t\t\treturn <Footer>Нет бюджетов для отображения</Footer>\r\n\t\t}\r\n\t}\r\n\r\n\tlet list = data\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn b.sum - a.sum;\r\n\t\t})\r\n\t\t.map((account, index) => {\r\n\t\t\tconsole.log(account);\r\n\t\t\tif (index === 3 && !isShow) {\r\n\t\t\t\treturn <Cell\r\n\t\t\t\t\tkey={index}\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetIsShow(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t\t\tПоказать все\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t</Cell>\r\n\t\t\t}\r\n\t\t\tif (index > 3 && !isShow) {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t\treturn <Cell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tindicator={currency(account.sum)}\r\n\t\t\t\texpandable\r\n\t\t\t\tdata-id={account._id}\r\n\t\t\t\tonClick={async (e) => {\r\n\t\t\t\t\tif (itemsName === 'accounts') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACCOUNT, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'account'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (itemsName === 'budgets') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_BUDGET, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'budget'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{account.title}\r\n\t\t\t</Cell>\r\n\t\t});\r\n\tif (needHide) {\r\n\t\tif (isShow) list.push(<Cell\r\n\t\t\tkey={data.length}\r\n\t\t\texpandable\r\n\t\t\tonClick={() => {\r\n\t\t\t\tsetIsShow(false);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t{itemsName === 'accounts' ? 'Скрыть счета' : 'Скрыть бюджеты'}\r\n\t\t\t</Text>\r\n\t\t</Cell>);\r\n\t}\r\n\r\n\r\n\treturn list;\r\n}","export const SET_ACCOUNTS = 'SET_ACCOUNTS';\r\nexport const SET_BUDGETS = 'SET_BUDGETS';\r\nexport const SET_BUDGET = 'SET_BUDGET';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_SUCCESS_MESSAGE = 'SET_SUCCESS_MESSAGE';\r\nexport const SET_ACTIVE_VIEW = 'SET_ACTIVE_VIEW';\r\nexport const SET_ACTIVE_PANEL= 'SET_ACTIVE_PANEL';\r\nexport const SET_ACCOUNT = 'SET_ACCOUNT';\r\nexport const SET_POPOUT = 'SET_POPOUT';\r\nexport const SET_EDITED_ITEM = 'SET_EDITED_ITEM';\r\nexport const SET_DATE = 'SET_DATE';\r\nexport const SET_HISTORY_BACK = 'SET_HISTORY_BACK';\r\nexport const SET_COLOR_SCHEME = 'SET_COLOR_SCHEME';","import React, {createContext, useReducer} from 'react';\r\nimport {\r\n\tSET_ACCOUNT,\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_VIEW,\r\n\tSET_BUDGET,\r\n\tSET_BUDGETS,\r\n\tSET_DATE,\r\n\tSET_EDITED_ITEM,\r\n\tSET_ERROR,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_SUCCESS_MESSAGE,\r\n\tSET_COLOR_SCHEME\r\n} from './actions';\r\n\r\nconst initialState = {\r\n\taccounts: [],\r\n\tbudgets: [],\r\n\taccount: null,\r\n\tbudget: null,\r\n\tmodal: null,\r\n\tsuccessMessage: null,\r\n\terror: null,\r\n\tactiveView: 'init',\r\n\tactivePanel: 'init',\r\n\tpopout: null,\r\n\teditedItem: null,\r\n\tcurrentDate: new Date(),\r\n\thistory: [],\r\n\tmodalsHistory: [],\r\n\tpopoutHistory: [],\r\n\tcanClose: true,\r\n\tscheme: 'client_light'\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_COLOR_SCHEME: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tscheme: action.payload.scheme\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACTIVE_VIEW: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\r\n\t\t\tlet history = state.history;\r\n\t\t\tif (history.length !== 0) {\r\n\t\t\t\tlet lastHistoryState = history[history.length - 1];\r\n\t\t\t\tif (lastHistoryState.view === action.payload.view && lastHistoryState.panel === action.payload.panel) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state,\r\n\t\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\t\tcanClose: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\tcanClose: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_HISTORY_BACK: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\t\t\tconst backEl = state.history[state.history.length - 2];\r\n\t\t\tlet popoutHistory = state.popoutHistory || [];\r\n\t\t\tlet modalsHistory = state.modalsHistory || [];\r\n\r\n\t\t\tif (popoutHistory.length !== 0) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tpopout: null,\r\n\t\t\t\t\tpopoutHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (modalsHistory.length !== 0) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tmodal: null,\r\n\t\t\t\t\tmodalsHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!backEl) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: 'home',\r\n\t\t\t\t\tactivePanel: 'home',\r\n\t\t\t\t\thistory: [],\r\n\t\t\t\t\tcanClose: true,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst canClose = (backEl.view === 'home' && backEl.panel === 'home');\r\n\t\t\t\tconst newHistory = state.history;\r\n\t\t\t\tnewHistory.pop();\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: backEl.view,\r\n\t\t\t\t\tactivePanel: backEl.panel,\r\n\t\t\t\t\thistory: [...newHistory],\r\n\t\t\t\t\teditedItem: null,\r\n\t\t\t\t\tcanClose: canClose\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tcase SET_ACCOUNTS: {\r\n\t\t\tconst accountId = state.account?._id;\r\n\t\t\tconst account = !accountId ? accountId : action.payload.accounts.find(item => {\r\n\t\t\t\treturn item._id === accountId;\r\n\t\t\t})\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccounts: action.payload.accounts,\r\n\t\t\t\taccount: account\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGETS: {\r\n\t\t\tconst budgetId = state.budget?._id;\r\n\t\t\tconst budget = !budgetId ? budgetId : action.payload.budgets.find(item => item._id === budgetId)\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudgets: action.payload.budgets,\r\n\t\t\t\tbudget: budget\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACCOUNT: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccount: state.accounts.find(item => {\r\n\t\t\t\t\treturn item._id === id;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGET: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudget: !id ? id : state.budgets.find(item => item._id === id)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_EDITED_ITEM: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\teditedItem: action.payload.item\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_POPOUT: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.popout) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.popout;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.popout) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout,\r\n\t\t\t\tpopoutHistory: action.payload.popout ? [action.payload.popout] : [],\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_MODAL: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.modal) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.modal;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.modal) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tmodal: action.payload.modal,\r\n\t\t\t\tmodalsHistory: action.payload.modal ? [action.payload.modal] : [],\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_SUCCESS_MESSAGE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsuccessMessage: action.payload.message\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ERROR: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_DATE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tcurrentDate: new Date(action.payload.date)\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\nimport Icon24CheckCircleOn from '@vkontakte/icons/dist/24/check_circle_on';\r\n\r\nconst InfoSnackbar = () => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.successMessage) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24CheckCircleOn style={{color: 'var(--accent)'}}/>}\r\n\t\t>\r\n\t\t\t{state.successMessage}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.successMessage]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;","import React, {useContext, useState} from 'react';\r\nimport {addMonths, format, subMonths, isAfter} from 'date-fns';\r\nimport {ru} from 'date-fns/locale';\r\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\r\nimport Icon24BrowserForward from '@vkontakte/icons/dist/24/browser_forward';\r\nimport {State} from \"../state\";\r\nimport {Button, Cell, Group} from \"@vkontakte/vkui\";\r\n\r\nexport default ({onRefresh}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst dateFormat = 'LLLL yyyy';\r\n\tconst disabled = isAfter(addMonths(state.currentDate, 1), new Date());\r\n\tconst [clickTime, setClickTime] = useState(0);\r\n\t\r\n\tconst nextMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (addMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\tconst prevMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (subMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Group>\r\n\t\t\t<Cell\r\n\t\t\t\tbefore={<Button onClick={prevMonth} mode={'secondary'}><Icon24BrowserBack/></Button>}\r\n\t\t\t\tasideContent={<Button disabled={disabled} onClick={nextMonth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmode={'secondary'}><Icon24BrowserForward/></Button>}\r\n\t\t\t\tstyle={{textAlign: 'center', fontWeight: 'bold'}}\r\n\t\t\t>\r\n\t\t\t\t{format(state.currentDate, dateFormat, {locale: ru}).toLocaleUpperCase()}\r\n\t\t\t</Cell>\r\n\t\t</Group>\r\n\t)\r\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport {Header, List, PanelHeaderButton, PullToRefresh, Title} from \"@vkontakte/vkui\";\nimport currency from \"../handlers/currency\";\nimport ListOfItems from \"../components/ListOfItems\";\nimport {SET_ACCOUNT, SET_MODAL} from \"../state/actions\";\nimport Icon28MarketAddBadgeOutline from '@vkontakte/icons/dist/28/market_add_badge_outline';\nimport Icon28ListAddOutline from '@vkontakte/icons/dist/28/list_add_outline';\nimport InfoSnackbar from \"../components/InfoSnackbar\";\nimport MonthSwitch from \"../components/MonthSwitch\";\n\nconst Home = ({id, accounts, budgets, dispatch, onRefresh, isFetching}) => {\n\tconst sumOfAll = accounts.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader\n\t\t\t\tleft={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28ListAddOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>\n\t\t\t\t\t\t{accounts.length !== 0 && <PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_ACCOUNT, payload: {id: null}});\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>}\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t>Баланс</PanelHeader>\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\n\t\t\t<PullToRefresh onRefresh={onRefresh} isFetching={isFetching}>\n\t\t\t\t<List>\n\t\t\t\t\t<Group\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Ваши счета</Header>}\n\t\t\t\t\t\tseparator=\"show\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(sumOfAll)}</Title>\n\t\t\t\t\t\t\t<ListOfItems data={accounts} dispatch={dispatch} showAll={false} itemsName={'accounts'}/>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Group>\n\t\t\t\t\t<Group\n\t\t\t\t\t\theader={<Header mode={'secondary'}>Ваши бюджеты</Header>}\n\t\t\t\t\t\tseparator={'show'}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={false} itemsName={'budgets'}/>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Group>\n\t\t\t\t</List>\n\t\t\t</PullToRefresh>\n\t\t\t<InfoSnackbar/>\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Home;\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {SET_ERROR, SET_MODAL, SET_POPOUT, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport {State} from \"../state\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = process.env.NODE_ENV !== 'development' ? process.env.REACT_APP_BASEURL : process.env.REACT_APP_BASEURL_DEV;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}});\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search)} : {...queryString.parse(window.location.search)},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (!isLoading) return;\r\n\r\n\t\tconst fetchData = async () => {\r\n\t\t\tsetLoading(false);\r\n\t\t\treturn await axios(axiosOptions)\r\n\t\t\t\t.then(async (response) => {\r\n\t\t\t\t\tsetResponse(response.data.data);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: response.data.message}});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tlet e = error?.response ? error.response.data.error : new Error('Проблемы с подключением к API');\r\n\t\t\t\t\tsetError(e);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: e}});\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","export default (e) => {\r\n\tconst validity = e.currentTarget.validity;\r\n\tif (validity.valid && e.currentTarget.value !== ' ') {\r\n\t\treturn {status: 'valid', message: null}\r\n\t} else {\r\n\t\tif (validity.badInput || validity.valueMissing || e.currentTarget.value === ' ') {\r\n\t\t\treturn {status: 'error', message: 'Неверный формат ввода | Отсутствует значение'}\r\n\t\t}\r\n\t\tif (validity.tooLong) {\r\n\t\t\treturn {status: 'error', message: 'Превышена максимальная длина'}\r\n\t\t}\r\n\t\tif (validity.typeMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Несоответствие типа'}\r\n\t\t}\r\n\t\tif (validity.rangeOverflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести будущую дату'}\r\n\t\t\treturn {status: 'error', message: 'Слишком большое число'}\r\n\t\t}\r\n\t\tif (validity.rangeUnderflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести дату раньше 1 января 2015'}\r\n\t\t\treturn {status: 'error', message: 'Нельзя вводить отрицательные числа'}\r\n\t\t}\r\n\r\n\t\treturn {status: 'default', message: null}\r\n\t}\r\n}","import React, {useEffect, useReducer} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tsum: '',\r\n\ttitleValidation: {},\r\n\tsumValidation: {}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload} = action;\r\n\t\t\t// if (payload.title === ' ' && state.title === '') {\r\n\t\t\t// \tconsole.log(payload.title);\r\n\t\t\t// \treturn {\r\n\t\t\t// \t\t...state,\r\n\t\t\t// \t\ttitle: payload.title,\r\n\t\t\t// \t\ttitleValidation: payload.titleValidation\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({onRefresh}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [{response}, doApiFetch] = useApi('/money-box');\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tonRefresh();\r\n\t}, [response, onRefresh]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.sum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Карта, наличные, счет в банке'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.titleValidation.status}\r\n\t\t\t\t\t\t bottom={stateForm.titleValidation.message ? stateForm.titleValidation.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {title: e.currentTarget.value.replace(/^\\s*/g, ''), titleValidation: validate(e)}})}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Баланс счета'} value={stateForm.sum}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.sumValidation.status}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.sumValidation.message ? stateForm.sumValidation.message : 'Денежные средства, находящиеся на счете в данный момент'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {sum: e.currentTarget.value, sumValidation: validate(e)}})}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {format} from 'date-fns';\r\nimport {Button, Checkbox, Counter, Div, FormLayout, Input, Radio, Select, Textarea} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\n\r\nconst initialState = {\r\n\taccount: '',\r\n\ttitle: '',\r\n\tdate: format(new Date(), 'yyyy-MM-dd'),\r\n\tincome: false,\r\n\tdescription: '',\r\n\tprice: '',\r\n\tquantity: '',\r\n\ttags: [],\r\n\tboxPrice: false,\r\n\tvalidate: {\r\n\t\taccount: {},\r\n\t\ttitle: {},\r\n\t\tdescription: {},\r\n\t\tprice: {},\r\n\t\tquantity: {},\r\n\t\ttags: {},\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({accounts, id = null, editedItem = null, onRefresh}) => {\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/item' : `/item/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\tconst [state, dispatch] = useReducer(reducer, initialState);\r\n\tconst accountList = accounts.map(item => {\r\n\t\treturn (<option key={item._id} value={item._id}>{item.title} ({currency(item.sum)})</option>)\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\teditedItem.date = format(new Date(editedItem.date), 'yyyy-MM-dd');\r\n\t\tdispatch({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tonRefresh();\r\n\t}, [response, onRefresh]);\r\n\r\n\tconst tags = state.tags.map((tag, index) => <Counter style={{marginRight: '5px', marginBottom: '5px'}} key={index}>{tag}</Counter>);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tdoApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\tdate: state.date,\r\n\t\t\t\t\ttitle: state.title,\r\n\t\t\t\t\tdescription: state.description,\r\n\t\t\t\t\tprice: state.boxPrice ? state.price / state.quantity : state.price,\r\n\t\t\t\t\tquantity: state.quantity,\r\n\t\t\t\t\tincome: state.income,\r\n\t\t\t\t\ttags: state.tags,\r\n\t\t\t\t\titemFrom: state.account || id\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Select top={'Счет'}\r\n\t\t\t\t\t\t\tplaceholder={'Выберите счет'}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\tpayload: {account: e.currentTarget.value, validateForm: {account: validate(e)}}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdefaultValue={editedItem?.itemFrom || id || state.account} required={true}\r\n\t\t\t\t\t\t\tstatus={state.validate?.account?.status}\r\n\t\t\t\t\t\t\tbottom={state.validate?.account?.message}\r\n\t\t\t>\r\n\t\t\t\t{accountList}\r\n\t\t\t</Select>\r\n\t\t\t<Input type={'date'}\r\n\t\t\t\t\t\t top={'Дата'}\r\n\t\t\t\t\t\t value={state.date}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t min={'2015-01-01'}\r\n\t\t\t\t\t\t max={format(new Date(), 'yyyy-MM-dd')}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {date: e.currentTarget.value, validateForm: {date: validate(e)}}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t\t\t\t status={state.validate?.date?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.date?.message}\r\n\t\t\t/>\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t placeholder={'Продукт, услуга, товар'}\r\n\t\t\t\t\t\t value={state.title}\r\n\t\t\t\t\t\t top={'Название'}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={20}\r\n\t\t\t\t\t\t status={state.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {title: e.currentTarget.value.replace(/^\\s*/g, ''), validateForm: {title: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}/>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={false}\r\n\t\t\t\t\t\t defaultChecked={state.income ? null : true}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {income: false}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tРасход\r\n\t\t\t</Radio>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={true}\r\n\t\t\t\t\t\t defaultChecked={state.income ? true : null}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {income: true}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tДоход\r\n\t\t\t</Radio>\r\n\t\t\t{\r\n\t\t\t\t!state.income\r\n\t\t\t\t&&\r\n\t\t\t\t<Textarea top={'Описание'}\r\n\t\t\t\t\t\t\t\t\tplaceholder={'Описание товара(продукта, услуги)'}\r\n\t\t\t\t\t\t\t\t\tvalue={state.description}\r\n\t\t\t\t\t\t\t\t\tmaxLength={70}\r\n\t\t\t\t\t\t\t\t\tstatus={state.validate?.description?.status}\r\n\t\t\t\t\t\t\t\t\tbottom={state.validate?.description?.message ? state.validate?.description?.message : `${state.description.length} из 70`}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: e.currentTarget.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalidateForm: {description: validate(e)}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t top={'Теги'}\r\n\t\t\t\t\t\t value={state.tags.join(' ')}\r\n\t\t\t\t\t\t placeholder={'Теги через пробел'}\r\n\t\t\t\t\t\t status={state.validate?.tags?.status}\r\n\t\t\t\t\t\t maxLength={100}\r\n\t\t\t\t\t\t bottom={state.validate?.tags?.message ? state.validate?.tags?.message : `${state.tags.join(' ').length} из 100 символов`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {tags: e.currentTarget.value !== '' ? e.currentTarget.value.toLowerCase().split(' ') : [], validateForm: {tags: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\tstate.tags.length !== 0\r\n\t\t\t\t&&\r\n\t\t\t\t<Div style={{display: 'flex', flexWrap: 'wrap'}}>\r\n\t\t\t\t\t{tags}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={currency(0)}\r\n\t\t\t\t\t\t top={'Цена'}\r\n\t\t\t\t\t\t max={99999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t status={state.validate?.price?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.price?.message}\r\n\t\t\t\t\t\t value={state.price}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {price: e.currentTarget.value, validateForm: {price: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Checkbox value={state.boxPrice}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: 'CHANGE_STATE', payload: {boxPrice: !state.boxPrice}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tЦена за упаковку\r\n\t\t\t</Checkbox>\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={'0'}\r\n\t\t\t\t\t\t top={'Кол-во'}\r\n\t\t\t\t\t\t max={9999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.001}\r\n\t\t\t\t\t\t status={state.validate?.quantity?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.quantity?.message}\r\n\t\t\t\t\t\t value={state.quantity}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {quantity: e.currentTarget.value, validateForm: {quantity: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Button size={'xl'}>\r\n\t\t\t\t{`Сохранить ${state.boxPrice ? currency(state.price) : currency(state.price * state.quantity)}`}\r\n\t\t\t</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React from 'react';\r\nimport {Caption, RichCell} from \"@vkontakte/vkui\";\r\nimport {format} from \"date-fns\";\r\nimport ruLocale from \"date-fns/locale/ru\";\r\nimport currency from \"./currency\";\r\nimport {SET_EDITED_ITEM, SET_MODAL} from \"../state/actions\";\r\n\r\nexport default function mapRichCell(dispatch) {\r\n\treturn (item, index) => {\r\n\t\tif (item?.titleDate) {\r\n\t\t\treturn (\r\n\t\t\t\t<Caption level=\"2\" weight=\"semibold\" caps\r\n\t\t\t\t\t\t\t\t key={index}>{format(new Date(item?.titleDate), 'dd MMMM yyyy', {locale: ruLocale})}</Caption>\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={format(new Date(item?.date), 'dd MMMM yyyy', {locale: ruLocale})}\r\n\t\t\t\tafter={item?.income ? currency(item?.sum) : currency(-1 * item?.sum)}\r\n\t\t\t\tdata-id={item?._id}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: item}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t};\r\n}","import compareAsc from \"date-fns/compareAsc\";\r\n\r\nexport default function (a, b){\r\n\tconst aDate = new Date(a.date);\r\n\tconst bDate = new Date(b.date);\r\n\treturn compareAsc(bDate, aDate);\r\n}","import isEqual from \"date-fns/isEqual\";\r\n\r\nexport default function (prev, curr) {\r\n\tif (isEqual(new Date(prev[prev.length-1]?.date), new Date(curr.date))) {\r\n\t\treturn [...prev, curr];\r\n\t} else {\r\n\t\treturn [...prev, {titleDate: curr.date}, curr];\r\n\t}\r\n}","import React, {useEffect, useState} from 'react';\r\nimport useApi from \"../handlers/useApi\";\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tHeader,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tSearch,\r\n\tTitle\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport Group from \"@vkontakte/vkui/dist/components/Group/Group\";\r\nimport {SET_EDITED_ITEM, SET_HISTORY_BACK, SET_MODAL, SET_POPOUT} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\r\n\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport reduce from \"../handlers/reduce\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\n\r\nexport default ({id, account, dispatch, onRefresh}) => {\r\n\tconst [isOpened, setIsOpened] = useState(false);\r\n\tconst [{response}, doApiFetch] = useApi(`/money-box/${account?._id}`);\r\n\tconst [items, setItems] = useState(() => {\r\n\t\tif (!account) return [];\r\n\t\treturn account?.operations;\r\n\t});\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items || []);\r\n\r\n\tconst accountItemsList = filteredItems.sort(sort).reduce(reduce, []).map(mapRichCell(dispatch));\r\n\r\n\tconst toggleContext = () => {\r\n\t\tsetIsOpened(!isOpened);\r\n\t}\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить счет?</h2>\r\n\t\t\t<p>Удаление счета приведет к удалению всех данных по доходам и расходам, привязанным к данному счету. Суммы\r\n\t\t\t\tбюджетов могут отображаться некорректно.</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!account) return;\r\n\t\tsetItems(account?.operations);\r\n\t\tsetFilteredItems(account?.operations);\r\n\t}, [account]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\t// dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\tonRefresh();\r\n\t}, [dispatch, response, onRefresh]);\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(account?.operations.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\t// dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK})\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={account && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{account ? account?.title : 'Счет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\taccount\r\n\t\t\t\t&&\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tУдалить счет {account?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</PanelHeaderContext>\r\n\t\t\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\t\t\t\t\t<Search onChange={(e) => {\r\n\t\t\t\t\t\tonSearch(e.currentTarget.value)\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Информация по счету</Header>}\r\n\t\t\t\t\t\tseparator=\"show\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(account?.sum)}</Title>\r\n\t\t\t\t\t\t</Div>\r\n\r\n\t\t\t\t\t\t{account?.operations.length === 0 && <Footer>Операций по счету еще не было</Footer>}\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t{accountItemsList}\r\n\t\t\t\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {format} from 'date-fns';\r\nimport ruLocale from 'date-fns/locale/ru';\r\nimport {Footer, Group, Header, Panel, PanelHeader, PanelHeaderButton} from \"@vkontakte/vkui\";\r\nimport ListOfItems from \"../components/ListOfItems\";\r\nimport {SET_MODAL} from \"../state/actions\";\r\nimport Icon28ListAddOutline from \"@vkontakte/icons/dist/28/list_add_outline\";\r\nimport currency from \"../handlers/currency\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\n\r\nexport default ({id, budgets, dispatch, date = new Date(), onRefresh}) => {\r\n\tconst budgetsStartSum = budgets.map(el => el.startSum).reduce((acc, cur) => acc + cur, 0);\r\n\tconst budgetsSum = budgets.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<PanelHeaderButton onClick={() => dispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})}>\r\n\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tБюджеты\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\r\n\t\t\t<Group\r\n\t\t\t\theader={<Header mode=\"secondary\">Ваши бюджеты\r\n\t\t\t\t\tна {format(new Date(date), 'dd MMMM yyyy', {locale: ruLocale})}</Header>}\r\n\t\t\t\tseparator=\"show\"\r\n\t\t\t>\r\n\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={true} itemsName={'budgets'} needHide={false}/>\r\n\t\t\t\t<Footer>Осталось {currency(budgetsSum)} из {currency(budgetsStartSum)}</Footer>\r\n\t\t\t</Group>\r\n\t\t\t<InfoSnackbar/>\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport currency from \"../../handlers/currency\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tstartSum: '',\r\n\tvalidate: {\r\n\t\ttitle: {},\r\n\t\tstartSum: {}\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({onRefresh, editedItem = null}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/budget' : `/budget/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\tif (!response) dispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatchForm, response]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tonRefresh();\r\n\t}, [onRefresh, response]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.startSum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Название бюджета'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.title?.message ? stateForm.validate?.title?.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {title: e.currentTarget.value.replace(/^\\s*/g, ''), validateForm: {title: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Бюджет в рублях'} value={stateForm.startSum}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.validate?.startSum?.status}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.startSum?.message ? stateForm.validate?.startSum?.message : 'Сколько вы готовы на это потратить?'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {startSum: e.currentTarget.value, validateForm: {startSum: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tSearch\r\n} from \"@vkontakte/vkui\";\r\nimport {SET_EDITED_ITEM, SET_HISTORY_BACK, SET_MODAL, SET_POPOUT} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport useApi from \"../handlers/useApi\";\r\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport Icon28EditOutline from '@vkontakte/icons/dist/28/edit_outline';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport reduce from \"../handlers/reduce\";\r\n\r\nexport default ({id, budget, dispatch, onRefresh}) => {\r\n\tconst [isOpened, setIsOpened] = useState(false);\r\n\tconst [{response}, doApiFetch] = useApi(`/budget/${budget?._id}`);\r\n\tconst [items, setItems] = useState(() => budget?.items);\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetItems(budget?.items);\r\n\t\tsetFilteredItems(budget?.items);\r\n\t}, [budget])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tif (response?.deletedCount) {\r\n\t\t\t// console.log(state.history);\r\n\t\t\t// dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\tonRefresh();\r\n\t\t}\r\n\t}, [response, dispatch, onRefresh]);\r\n\r\n\tconst toggleContext = () => {\r\n\t\tsetIsOpened(!isOpened);\r\n\t}\r\n\r\n\tconst alertDelete = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить бюджет?</h2>\r\n\t\t\t<p>Вы действительно хотите удалить бюджет?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tconst itemsList = filteredItems && filteredItems.sort(sort).reduce(reduce, []).map(mapRichCell(dispatch));\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(budget.items.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t\t// dispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t// dispatch({type: SET_BUDGET, payload: {id: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={budget && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{budget ? budget?.title : 'Бюджет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\tbudget &&\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28EditOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: budget}})\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})\r\n\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tИзменить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alertDelete}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tУдалить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</PanelHeaderContext>\r\n\t\t\t\t\t<Search onChange={(e) => {\r\n\t\t\t\t\t\tonSearch(e.currentTarget.value)\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t{itemsList}\r\n\t\t\t\t\t\t{itemsList?.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</Panel>\r\n\t)\r\n}","import React, { useState, useEffect } from 'react';\r\nimport {Footer, Group, Panel, PanelHeader, Search} from \"@vkontakte/vkui\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport mapStats from \"../handlers/mapStats\";\r\n\r\nexport default ({id, accounts, onRefresh}) => {\r\n\tconst [operations, setOperations] = useState(() => {\r\n\t\treturn accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t});\r\n\tconst [filteredItems, setFilteredItems] = useState(() => operations);\r\n\tconst reducer = (prev, curr) => {\r\n\t\tif (prev[prev.length-1]?.title === curr.title) {\r\n\t\t\tconst prevItem = prev[prev.length-1];\r\n\t\t\tprevItem.sum = prevItem.sum + curr.sum;\r\n\t\t\tprevItem.quantity += curr.quantity;\r\n\t\t\tconst array = [...prev.slice(0, prev.length-1), prevItem];\r\n\t\t\treturn [...array];\r\n\t\t} else {\r\n\t\t\treturn [...prev, {title: curr.title, sum: curr.sum, quantity: curr.quantity}];\r\n\t\t}\r\n\t}\r\n\r\n\tconst accountItemsList = filteredItems\r\n\t\t.reduce(reducer, [])\r\n\t\t.map(mapStats());\r\n\r\n\tuseEffect(() => {\r\n\t\tconst items = accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title));\r\n\t\tsetOperations(items);\r\n\t\tsetFilteredItems(items);\r\n\t}, [accounts])\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t\t.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>\r\n\t\t\t\tСводка\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\r\n\t\t\t<Search onChange={(e) => {\r\n\t\t\t\tonSearch(e.currentTarget.value)\r\n\t\t\t}}/>\r\n\t\t\t<Group>\r\n\t\t\t\t{accountItemsList}\r\n\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {RichCell} from \"@vkontakte/vkui\";\r\nimport currency from \"./currency\";\r\n\r\nexport default () => {\r\n\treturn (item, index) => {\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={`Кол-во: ${item?.quantity} | Ср. цена ${currency(item?.sum/item?.quantity)}`}\r\n\t\t\t\tafter={currency(item?.sum)}\r\n\t\t\t\tdata-title={item?.title}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t}\r\n}","import React from 'react';\r\nimport {Button, Panel, Placeholder, Spinner} from \"@vkontakte/vkui\";\r\nimport {SET_ACTIVE_VIEW} from \"../state/actions\";\r\nimport Icon36Done from '@vkontakte/icons/dist/36/done';\r\n\r\nexport default ({id, dispatch, loading}) => {\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={loading ? <Spinner size=\"large\"/> : <Icon36Done/>}\r\n\t\t\t\taction={\r\n\t\t\t\t\t!loading && <Button\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tid={'initial-button'}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tЗапустить\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t}\r\n\t\t\t\tstretched\r\n\t\t\t>\r\n\t\t\t\t{loading ? 'Подготавливаем приложение к запуску' : 'Приложение готово'}\r\n\t\t\t</Placeholder>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n","import React, {useCallback, useContext, useEffect, useState} from 'react';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport Home from './panels/Home';\r\nimport useApi from \"./handlers/useApi\";\r\nimport {State} from './state';\r\nimport {\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_VIEW,\r\n\tSET_BUDGETS,\r\n\tSET_COLOR_SCHEME,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT\r\n} from \"./state/actions\";\r\nimport {\r\n\tAlert,\r\n\tANDROID,\r\n\tConfigProvider,\r\n\tEpic,\r\n\tIOS,\r\n\tModalPage,\r\n\tModalPageHeader,\r\n\tModalRoot,\r\n\tPanelHeaderButton,\r\n\tplatform,\r\n\tTabbar,\r\n\tTabbarItem\r\n} from \"@vkontakte/vkui\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon28HomeOutline from '@vkontakte/icons/dist/28/home_outline';\r\nimport Icon28CoinsOutline from '@vkontakte/icons/dist/28/coins_outline';\r\nimport Icon28StatisticsOutline from '@vkontakte/icons/dist/28/statistics_outline';\r\nimport AddAccount from \"./components/modals/AddAccount\";\r\nimport AddMoney from \"./components/modals/AddMoney\";\r\nimport AccountInfo from \"./panels/AccountInfo\";\r\nimport Budgets from \"./panels/Budgets\";\r\nimport AddBudget from \"./components/modals/AddBudget\";\r\nimport BudgetInfo from \"./panels/BudgetInfo\";\r\nimport Stats from \"./panels/Stats\";\r\nimport InitialScreen from \"./panels/InitialScreen\";\r\n\r\nconst App = () => {\r\n\tconst os = platform();\r\n\tconst [{response, isLoading}, doApiFetch] = useApi('/state');\r\n\tconst [needFetch, setNeedFetch] = useState(true);\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [lastBackAction, setLastBackAction] = useState(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tbridge.subscribe(({detail: {type, data}}) => {\r\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\r\n\t\t\t\t// const schemeAttribute = document.createAttribute('scheme');\r\n\t\t\t\t// schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\r\n\t\t\t\t// console.log(data);\r\n\t\t\t\t// document.body.attributes.setNamedItem(schemeAttribute);\r\n\t\t\t\tdispatch({type: SET_COLOR_SCHEME, payload: {scheme: data.scheme}})\r\n\t\t\t}\r\n\t\t});\r\n\r\n// Init VK  Mini App\r\n\t\tbridge.send(\"VKWebAppInit\", {});\r\n\t\t// dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t}, [dispatch]);\r\n\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Выйти',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\tawait bridge.send('VKWebAppClose', {status: 'success'});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Выйти из приложения?</h2>\r\n\t\t\t<p>Вы действительно хотите выйти?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tparams: {\r\n\t\t\t\tdate: new Date(state.currentDate)\r\n\t\t\t}\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [needFetch, doApiFetch, state.currentDate]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\t\twindow.onpopstate = () => {\r\n\t\t\t\tlet timeNow = +new Date();\r\n\t\t\t\tif (state.canClose) {\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert}});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (timeNow - lastBackAction > 500) {\r\n\t\t\t\t\t\tsetLastBackAction(timeNow);\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twindow.history.pushState(null, null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, [dispatch, state.history, state.modal, lastBackAction, state.canClose, alert]\r\n\t);\r\n\r\n\tconst onRefresh = useCallback(() => {\r\n\t\tsetNeedFetch(true);\r\n\t}, []);\r\n\r\n\tconst modalBack = (() => {\r\n\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t})\r\n\r\n\tconst modal = (\r\n\t\t<ModalRoot\r\n\t\t\tactiveModal={state.modal}\r\n\t\t\tonClose={modalBack}\r\n\t\t>\r\n\t\t\t<ModalPage id={'add-account'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\tДобавить счет\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddAccount onRefresh={onRefresh}/>\r\n\t\t\t</ModalPage>\r\n\r\n\t\t\t<ModalPage id={'add-money'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\t{state.editedItem ? 'Редактировать' : 'Добавить запись'}\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddMoney accounts={state.accounts} id={state.account?._id}\r\n\t\t\t\t\t\t\t\t\teditedItem={state.editedItem} onRefresh={onRefresh}/>\r\n\t\t\t</ModalPage>\r\n\r\n\t\t\t<ModalPage id={'add-budget'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\t{state.editedItem ? 'Редактировать' : 'Добавить бюджет'}\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddBudget editedItem={state.editedItem} onRefresh={onRefresh} dispatch={dispatch}/>\r\n\t\t\t</ModalPage>\r\n\t\t</ModalRoot>\r\n\t)\r\n\r\n\tconst onStoryChange = (e) => {\r\n\t\tdispatch({\r\n\t\t\ttype: SET_ACTIVE_VIEW,\r\n\t\t\tpayload: {view: e.currentTarget.dataset.story, panel: e.currentTarget.dataset.panel}\r\n\t\t})\r\n\t}\r\n\r\n\tconst tabBar = (\r\n\t\t<Tabbar>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'home'}\r\n\t\t\t\tdata-story={'home'}\r\n\t\t\t\tdata-panel={'home'}\r\n\t\t\t\ttext={'Баланс'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28HomeOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'info' && (state.activePanel === 'budgets' || state.activePanel === 'budget')}\r\n\t\t\t\tdata-story={'info'}\r\n\t\t\t\tdata-panel={'budgets'}\r\n\t\t\t\ttext={'Бюджеты'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28CoinsOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'info' && state.activePanel === 'stats'}\r\n\t\t\t\tdata-story={'info'}\r\n\t\t\t\tdata-panel={'stats'}\r\n\t\t\t\ttext={'Сводка'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28StatisticsOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t</Tabbar>\r\n\t)\r\n\r\n\treturn (\r\n\t\t<ConfigProvider scheme={state.scheme}>\r\n\t\t\t<Epic activeStory={state.activeView} tabbar={state.activeView !== 'init' && state.activePanel !== 'init' && tabBar}>\r\n\t\t\t\t<View id={'init'} activePanel={state.activePanel}>\r\n\t\t\t\t\t<InitialScreen id={'init'} dispatch={dispatch} loading={state.popout}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'home'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<Home id='home' accounts={state.accounts} budgets={state.budgets} dispatch={dispatch} isLoading={isLoading}\r\n\t\t\t\t\t\t\t\tonRefresh={onRefresh} isFetching={isLoading}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'info'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<AccountInfo id={'account'} account={state.accounts.find(item => item._id === state.account?._id)}\r\n\t\t\t\t\t\t\t\t\t\t\t dispatch={dispatch} onRefresh={onRefresh}/>\r\n\t\t\t\t\t<BudgetInfo id={'budget'} budget={state.budgets.find(item => item._id === state.budget?._id)}\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch={dispatch} onRefresh={onRefresh}/>\r\n\t\t\t\t\t<Budgets id={'budgets'} budgets={state.budgets} dispatch={dispatch} onRefresh={onRefresh}\r\n\t\t\t\t\t\t\t\t\t date={state.currentDate}/>\r\n\t\t\t\t\t<Stats id={'stats'} accounts={state.accounts} onRefresh={onRefresh} dispatch={dispatch}/>\r\n\t\t\t\t</View>\r\n\t\t\t</Epic>\r\n\t\t</ConfigProvider>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n\r\n","import \"core-js/features/map\";\r\nimport \"core-js/features/set\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport {StateProvider} from \"./state\";\r\n\r\nReactDOM.render(\r\n  <StateProvider>\r\n    <App />\r\n  </StateProvider>, document.getElementById(\"root\"));\r\nif (new URL(window.location.href).searchParams.get('vk_user_id') === process.env.REACT_APP_ID.toString()) {\r\n  import(\"./eruda\").then(() => {}); //runtime download\r\n}\r\n\r\n// console.log(new URL(window.location.href).searchParams.get('vk_user_id'));\r\n// import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\r\n"],"sourceRoot":""}