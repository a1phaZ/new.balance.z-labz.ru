{"version":3,"sources":["handlers/currency.js","components/ListOfItems.js","state/actions.js","state/index.js","components/InfoSnackbar.js","components/MonthSwitch.js","panels/Home.js","handlers/useApi.js","handlers/validate.js","handlers/regexp.js","components/modals/AddAccount.js","components/modals/AddMoney.js","handlers/mapRichCell.js","handlers/sort.js","handlers/reduce.js","components/SearchForm.js","panels/AccountInfo.js","panels/Budgets.js","components/modals/AddBudget.js","panels/BudgetInfo.js","panels/Stats.js","handlers/mapStats.js","panels/InitialScreen.js","panels/More.js","App.js","index.js"],"names":["number","Intl","NumberFormat","style","currency","format","data","showAll","dispatch","itemsName","needHide","useState","isShow","setIsShow","length","list","sort","a","b","sum","map","account","index","key","indicator","expandable","data-id","_id","onClick","e","type","payload","id","currentTarget","dataset","view","panel","title","weight","marginBottom","push","initialState","accounts","budgets","budget","modal","successMessage","error","activeView","activePanel","popout","editedItem","currentDate","Date","history","modalsHistory","popoutHistory","contextHistory","canClose","scheme","modalOpenTime","reducer","state","action","window","pushState","lastHistoryState","backEl","newHistory","pop","accountId","find","item","budgetId","alert","context","message","date","State","createContext","StateProvider","children","value","useReducer","Provider","InfoSnackbar","useContext","snackbar","setSnackbar","useEffect","onClose","before","color","onRefresh","disabledAfter","isAfter","addMonths","disabledBefore","isBefore","clickTime","setClickTime","disabled","timeNow","subMonths","mode","asideContent","textAlign","fontWeight","cursor","locale","ru","toLocaleUpperCase","Home","isFetching","sumOfAll","el","reduce","acc","cur","left","MonthSwitch","header","separator","level","ListOfItems","url","isLoading","setLoading","response","setResponse","setError","options","setOptions","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","process","headers","queryString","parse","location","search","axios","then","catch","Error","fetchData","validity","valid","status","badInput","valueMissing","tooLong","typeMismatch","stepMismatch","rangeOverflow","rangeUnderflow","str","replace","titleValidation","sumValidation","stateForm","dispatchForm","useApi","onSubmit","preventDefault","placeholder","top","required","maxLength","bottom","onChange","regexp","validate","pattern","inputMode","max","min","step","size","income","description","price","quantity","tags","boxPrice","validateForm","apiStr","accountList","toLowerCase","split","filter","tag","marginRight","maxWidth","overflow","overflowWrap","toFixed","itemFrom","defaultValue","name","defaultChecked","join","display","flexWrap","mapRichCell","titleDate","caps","ruLocale","multiline","caption","after","aDate","bDate","compareAsc","prev","curr","isEqual","onSearch","searchRef","useRef","current","focus","position","height","width","ref","isOpened","setIsOpened","operations","items","setItems","filteredItems","setFilteredItems","accountItemsList","toggleContext","actions","autoclose","aside","transform","opened","SearchForm","indexOf","startSum","deletedCount","alertDelete","itemsList","flat","localeCompare","setOperations","prevItem","array","slice","data-title","loading","icon","stretched","userId","URL","href","searchParams","get","addToHomeScreenSupported","setAddToHomeScreenSupported","addedToHomeScreen","setAddedToHomeScreen","bridge","subscribe","detail","is_feature_supported","is_added_to_home_screen","result","send","link","group_id","App","os","platform","needFetch","setNeedFetch","lastBackAction","setLastBackAction","onpopstate","modalBack","activeModal","ANDROID","right","IOS","AddAccount","AddMoney","AddBudget","onStoryChange","story","tabBar","itemsLayout","selected","data-story","data-panel","text","activeStory","tabbar","InitialScreen","AccountInfo","Budgets","BudgetInfo","Stats","More","ReactDOM","render","document","getElementById","toString"],"mappings":"mmBAAe,WAACA,GACf,OAAO,IAAIC,KAAKC,aAAa,QAAS,CAACC,MAAO,WAAYC,SAAU,QAAQC,OAAOL,I,iBCKrE,cAAoE,IAAlEM,EAAiE,EAAjEA,KAAiE,IAA3DC,eAA2D,SAA1CC,EAA0C,EAA1CA,SAAUC,EAAgC,EAAhCA,UAAgC,IAArBC,gBAAqB,WACrDC,oBAAS,WACpC,OAAOJ,KAFyE,mBAC1EK,EAD0E,KAClEC,EADkE,KAKjF,GAAoB,IAAhBP,EAAKQ,OAAc,CACtB,GAAkB,aAAdL,EACH,OAAO,kBAAC,IAAD,sJAER,GAAkB,YAAdA,EACH,OAAO,kBAAC,IAAD,kKAIT,IAAIM,EAAOT,EACTU,MAAK,SAACC,EAAGC,GACT,OAAOA,EAAEC,IAAMF,EAAEE,OAEjBC,KAAI,SAACC,EAASC,GACd,OAAc,IAAVA,GAAgBV,EAahBU,EAAQ,IAAMV,EACV,KAED,kBAAC,IAAD,CACNW,IAAKD,EACLE,UAAWpB,EAASiB,EAAQF,KAC5BM,YAAU,EACVC,UAASL,EAAQM,IACjBC,QAAO,uCAAE,WAAOC,GAAP,SAAAZ,EAAA,yDACU,aAAdR,EADI,gCAEDD,EAAS,CAACsB,KCzCK,cDyCcC,QAAS,CAACC,GAAIH,EAAEI,cAAcC,QAAQF,MAFlE,uBAGDxB,EAAS,CAACsB,KC3CS,kBD2CcC,QAAS,CAACI,KAAM,OAAQC,MAAO,aAH/D,UAKU,YAAd3B,EALI,iCAMDD,EAAS,CAACsB,KClDI,aDkDcC,QAAS,CAACC,GAAIH,EAAEI,cAAcC,QAAQF,MANjE,wBAODxB,EAAS,CAACsB,KC/CS,kBD+CcC,QAAS,CAACI,KAAM,OAAQC,MAAO,YAP/D,4CAAF,uDAWNf,EAAQgB,OA/BF,kBAAC,IAAD,CACNd,IAAK,UACLE,YAAU,EACVG,QAAS,WACRf,GAAU,KAGX,kBAAC,IAAD,CAAMyB,OAAO,WAAWnC,MAAO,CAACoC,aAAc,KAA9C,2EA0CJ,OAfI7B,GACCE,GAAQG,EAAKyB,KAAK,kBAAC,IAAD,CACrBjB,IAAKjB,EAAKQ,OACVW,YAAU,EACVG,QAAS,WACRf,GAAU,KAGX,kBAAC,IAAD,CAAMyB,OAAO,WAAWnC,MAAO,CAACoC,aAAc,KAC9B,aAAd9B,EAA2B,sEAAiB,qFAMzCM,G,yCE1DF0B,EAAe,CACpBC,SAAU,GACVC,QAAS,GACTtB,QAAS,KACTuB,OAAQ,KACRC,MAAO,KACPC,eAAgB,KAChBC,MAAO,KACPC,WAAY,OACZC,YAAa,OACbC,OAAQ,KACRC,WAAY,KACZC,YAAa,IAAIC,KACjBC,QAAS,GACTC,cAAe,GACfC,cAAe,GACfC,gBAAgB,EAChBC,UAAU,EACVC,OAAQ,eACRC,eAAgB,IAAIP,MAGfQ,EAAU,CAACC,EAAOC,KACvB,OAAQA,EAAOjC,MACd,ID7B8B,mBC8B7B,OAAO,2BACHgC,GADJ,IAECH,OAAQI,EAAOhC,QAAQ4B,SAGzB,IDzC6B,kBC0C5BK,OAAOV,QAAQW,UAAU,KAAM,MAE/B,IAAIX,EAAUQ,EAAMR,QACpB,GAAuB,IAAnBA,EAAQxC,OAAc,CACzB,IAAIoD,EAAmBZ,EAAQA,EAAQxC,OAAS,GAChD,OAAIoD,EAAiB/B,OAAS4B,EAAOhC,QAAQI,MAAQ+B,EAAiB9B,QAAU2B,EAAOhC,QAAQK,MACvF,eACH0B,GAGG,2BACHA,GADJ,IAECd,WAAYe,EAAOhC,QAAQI,KAC3Bc,YAAac,EAAOhC,QAAQK,MAC5BkB,QAAS,IAAIA,EAAS,CAACnB,KAAM4B,EAAOhC,QAAQI,KAAMC,MAAO2B,EAAOhC,QAAQK,QACxEsB,UAAU,EACVD,gBAAgB,IAIlB,OAAO,2BACHK,GADJ,IAECd,WAAYe,EAAOhC,QAAQI,KAC3Bc,YAAac,EAAOhC,QAAQK,MAC5BkB,QAAS,IAAIA,EAAS,CAACnB,KAAM4B,EAAOhC,QAAQI,KAAMC,MAAO2B,EAAOhC,QAAQK,QACxEsB,UAAU,EACVD,gBAAgB,IAInB,IDnE8B,mBCoE7BO,OAAOV,QAAQW,UAAU,KAAM,MAC/B,IAAME,EAASL,EAAMR,QAAQQ,EAAMR,QAAQxC,OAAS,GAChD0C,EAAgBM,EAAMN,eAAiB,GACvCD,EAAgBO,EAAMP,eAAiB,GACvCE,EAAiBK,EAAML,iBAAkB,EAE7C,GAA6B,IAAzBD,EAAc1C,OAAc,CAC/B,IAAM4C,EAAWI,EAAMR,QAAQxC,QAAU,EACzC,OAAO,2BACHgD,GADJ,IAECZ,OAAQ,KACRM,cAAe,GACfE,SAAUA,EACVP,WAAY,OAId,GAAMM,EAAgB,CACrB,IAAMC,EAAWI,EAAMR,QAAQxC,QAAU,EACzC,OAAO,2BACHgD,GADJ,IAECL,gBAAgB,EAChBC,SAAUA,EACVP,WAAY,OAId,GAA6B,IAAzBI,EAAczC,OAAc,CAC/B,IAAK,IAAIuC,KAASS,EAAMF,cAAgB,IACvC,OAAO,eACHE,GAGL,IAAMJ,EAAWI,EAAMR,QAAQxC,QAAU,EACzC,OAAO,2BACHgD,GADJ,IAECjB,MAAO,KACPU,cAAe,GACfG,SAAUA,EACVP,WAAY,OAId,GAAKgB,EASE,CACN,IAAMT,EAA4B,SAAhBS,EAAOhC,MAAoC,SAAjBgC,EAAO/B,MAC7CgC,EAAaN,EAAMR,QAEzB,OADAc,EAAWC,MACJ,2BACHP,GADJ,IAECd,WAAYmB,EAAOhC,KACnBc,YAAakB,EAAO/B,MACpBkB,QAAS,IAAIc,GACbjB,WAAY,KACZO,SAAUA,IAlBX,OAAO,2BACHI,GADJ,IAECd,WAAY,OACZC,YAAa,OACbK,QAAS,GACTI,UAAU,EACVP,WAAY,OAiBf,IDlJ0B,eCkJN,IAAD,EACZmB,EAAS,UAAGR,EAAMzC,eAAT,aAAG,EAAeM,IAC3BN,EAAWiD,EAAwBP,EAAOhC,QAAQW,SAAS6B,KAAKC,GAC9DA,EAAK7C,MAAQ2C,GADQA,EAG7B,OAAO,2BACHR,GADJ,IAECpB,SAAUqB,EAAOhC,QAAQW,SACzBrB,QAASA,IAGX,ID5JyB,cC4JN,IAAD,EACXoD,EAAQ,UAAGX,EAAMlB,cAAT,aAAG,EAAcjB,IACzBiB,EAAU6B,EAAsBV,EAAOhC,QAAQY,QAAQ4B,KAAKC,GAAQA,EAAK7C,MAAQ8C,GAA5DA,EAC3B,OAAO,2BACHX,GADJ,IAECnB,QAASoB,EAAOhC,QAAQY,QACxBC,OAAQA,IAGV,ID/JyB,cC+JN,IACDZ,EAAO+B,EAAjBhC,QAAUC,GACjB,OAAO,2BACH8B,GADJ,IAECzC,QAASyC,EAAMpB,SAAS6B,KAAKC,GACrBA,EAAK7C,MAAQK,KAIvB,ID7KwB,aC6KN,IACAA,EAAO+B,EAAjBhC,QAAUC,GACjB,OAAO,2BACH8B,GADJ,IAEClB,OAASZ,EAAU8B,EAAMnB,QAAQ4B,KAAKC,GAAQA,EAAK7C,MAAQK,GAA7CA,IAGhB,ID7K6B,kBC8K5B,OAAO,2BACH8B,GADJ,IAECX,WAAYY,EAAOhC,QAAQyC,OAG7B,IDpLwB,aCqLnBT,EAAOhC,QAAQ2C,OAClBV,OAAOV,QAAQW,UAAU,KAAM,MAEhC,IAAIX,EAAUQ,EAAMR,QAChBI,EAAWI,EAAMJ,SAQrB,OAPuB,IAAnBJ,EAAQxC,QAAgBiD,EAAOhC,QAAQmB,OAC1CQ,EAA8B,IAAnBJ,EAAQxC,SAAiBiD,EAAOhC,QAAQmB,OAE5B,IAAnBI,EAAQxC,QAAiBiD,EAAOhC,QAAQmB,SAC3CQ,GAAW,GAGN,2BACHI,GADJ,IAECZ,OAAQa,EAAOhC,QAAQmB,OACvBM,cAAeO,EAAOhC,QAAQmB,OAAS,CAACa,EAAOhC,QAAQmB,QAAU,GACjEQ,SAAUA,IAGZ,ID7MuB,YC+MtB,IAAIJ,EAAUQ,EAAMR,QAChBI,EAAWI,EAAMJ,SAQrB,OAPuB,IAAnBJ,EAAQxC,QAAgBiD,EAAOhC,QAAQc,MAC1Ca,EAA8B,IAAnBJ,EAAQxC,SAAiBiD,EAAOhC,QAAQc,MAE5B,IAAnBS,EAAQxC,QAAiBiD,EAAOhC,QAAQc,QAC3Ca,GAAW,GAGN,2BACHI,GADJ,IAECjB,MAAOkB,EAAOhC,QAAQc,MACtBU,cAAeQ,EAAOhC,QAAQc,MAAQ,CAACkB,EAAOhC,QAAQc,OAAS,GAC/Da,SAAUA,EACVE,eAAgB,IAAIP,OAGtB,IDtNgC,qBCuN/B,IAAIC,EAAUQ,EAAMR,QAChBI,EAAWI,EAAMJ,SAQrB,OAPuB,IAAnBJ,EAAQxC,QAAgBiD,EAAOhC,QAAQ4C,QAC1CjB,EAA8B,IAAnBJ,EAAQxC,SAAiBiD,EAAOhC,QAAQ4C,QAE5B,IAAnBrB,EAAQxC,QAAiBiD,EAAOhC,QAAQ4C,UAC3CjB,GAAW,GAGN,2BACHI,GADJ,IAGCL,eAAgBM,EAAOhC,QAAQ4C,QAC/BjB,SAAUA,IAGZ,ID/OiC,sBCgPhC,OAAO,2BACHI,GADJ,IAEChB,eAAgBiB,EAAOhC,QAAQ6C,UAGjC,IDtPuB,YCuPtB,OAAO,2BACHd,GADJ,IAECf,MAAOgB,EAAOhC,QAAQgB,QAGxB,IDtPsB,WCuPrB,OAAO,2BACHe,GADJ,IAECV,YAAa,IAAIC,KAAKU,EAAOhC,QAAQ8C,QAGvC,QACC,OAAOf,IAIGgB,EAAQC,0BAERC,EAAiB,IAAgB,IAAfC,EAAc,EAAdA,SACxBC,EAAQC,qBAAWtB,EAASpB,GAClC,OACC,kBAACqC,EAAMM,SAAP,CAAgBF,MAAOA,GACrBD,I,oCCrOWI,EArCM,WAAO,IAAD,EACAC,qBAAWR,GADX,mBACnBhB,EADmB,KACZtD,EADY,OAEMG,mBAAS,MAFf,mBAEnB4E,EAFmB,KAETC,EAFS,KA8B1B,OA3BAC,qBAAU,WACJ3B,EAAMf,OACXyC,EAAY,kBAAC,IAAD,CACXE,QACC,WACClF,EAAS,CAACsB,KFXU,YEWOC,QAAS,CAACgB,MAAO,QAC5CyC,EAAY,OAEdG,OAAQ,kBAAC,IAAD,CAAmBxF,MAAO,CAACyF,MAAO,yBAEzC9B,EAAMf,MAAM6B,YAEZ,CAACY,EAAahF,EAAUsD,EAAMf,QAEjC0C,qBAAU,WACJ3B,EAAMhB,gBACX0C,EAAY,kBAAC,IAAD,CACXE,QACC,WACClF,EAAS,CAACsB,KFxBoB,sBEwBOC,QAAS,CAAC6C,QAAS,QACxDY,EAAY,OAEdG,OAAQ,kBAAC,IAAD,CAAqBxF,MAAO,CAACyF,MAAO,oBAE3C9B,EAAMhB,mBAEN,CAAC0C,EAAahF,EAAUsD,EAAMhB,iBAEhC,oCACEyC,I,yFC/BW,cAAkB,IAAhBM,EAAe,EAAfA,UAAe,EACLP,qBAAWR,GADN,mBACxBhB,EADwB,KACjBtD,EADiB,KAGzBsF,EAAgBC,YAAQC,YAAUlC,EAAMV,YAAa,GAAI,IAAIC,MAC7D4C,EAAiBC,YAAS,IAAI7C,KAAKS,EAAMV,aAAc,IAAIC,KAAK,KAAM,EAAG,IAJhD,EAKG1C,mBAAS,GALZ,mBAKxBwF,EALwB,KAKbC,EALa,KAyB/B,OACC,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCT,OAAQ,kBAAC,IAAD,CAAQU,SAAUJ,EAAgBrE,QAZ3B,WACjB,IAAI0E,GAAW,IAAIjD,KACfiD,EAAUH,EAAY,MACzB3F,EAAS,CAACsB,KAAM,WAAYC,QAAS,CAAC8C,KAAO0B,YAAUzC,EAAMV,YAAa,MAC1EyC,IACAO,EAAaE,KAOkDE,KAAM,aAAa,kBAAC,IAAD,OACjFC,aAAc,kBAAC,IAAD,CAAQJ,SAAUP,EAAelE,QAtBhC,WACjB,IAAI0E,GAAW,IAAIjD,KACfiD,EAAUH,EAAY,MACzB3F,EAAS,CAACsB,KAAM,WAAYC,QAAS,CAAC8C,KAAOmB,YAAUlC,EAAMV,YAAa,MAC1EyC,IACAO,EAAaE,KAkBDE,KAAM,aAAa,kBAAC,IAAD,OAC9BrG,MAAO,CAACuG,UAAW,SAAUC,WAAY,SAEzC,yBAAKxG,MAAO,CAACyG,OAAQ,SACnBvG,YAAOyD,EAAMV,YAhCC,YAgCwB,CAACyD,OAAQC,MAAKC,wBC6B3CC,EAxDF,SAAC,GAA8D,IAA7DhF,EAA4D,EAA5DA,GAAIU,EAAwD,EAAxDA,SAAUC,EAA8C,EAA9CA,QAASnC,EAAqC,EAArCA,SAAUqF,EAA2B,EAA3BA,UAAWoB,EAAgB,EAAhBA,WACpDC,EAAWxE,EAAStB,KAAI,SAAA+F,GAAE,OAAIA,EAAGhG,OAAKiG,QAAO,SAACC,EAAKC,GAAN,OAAcD,EAAMC,IAAK,GAC5E,OACC,kBAAC,IAAD,CAAOtF,GAAIA,GACV,kBAAC,IAAD,CACCuF,KACC,oCACC,kBAAC,IAAD,CACC3F,QAAS,WACRpB,EAAS,CAACsB,KJrBO,YIqBUC,QAAS,CAACc,MAAO,mBAG7C,kBAAC,IAAD,OAEoB,IAApBH,EAAS5B,QAAgB,kBAAC,IAAD,CACzBc,QAAS,WACRpB,EAAS,CAACsB,KJxBS,cIwBUC,QAAS,CAACC,GAAI,QAC3CxB,EAAS,CAACsB,KJ7BO,YI6BUC,QAAS,CAACc,MAAO,iBAG7C,kBAAC,IAAD,SAhBJ,wCAqBA,kBAAC2E,EAAD,CAAa3B,UAAWA,IACxB,kBAAC,IAAD,CAAeA,UAAWA,EAAWoB,WAAYA,GAChD,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCQ,OAAQ,kBAAC,IAAD,CAAQjB,KAAK,aAAb,2DACRkB,UAAU,QAEV,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOC,MAAM,IAAIrF,OAAO,WAAWnC,MAAO,CAACoC,aAAc,KAAMnC,EAAS8G,IACxE,kBAACU,EAAD,CAAatH,KAAMoC,EAAUlC,SAAUA,EAAUD,SAAS,EAAOE,UAAW,eAG9E,kBAAC,IAAD,CACCgH,OAAQ,kBAAC,IAAD,CAAQjB,KAAM,aAAd,wEAGR,kBAAC,IAAD,KACC,kBAACoB,EAAD,CAAatH,KAAMqC,EAASnC,SAAUA,EAAUD,SAAS,EAAOE,UAAW,gBAK/E,kBAAC,EAAD,Q,+CCvDY,YAAAoH,GAAQ,IAAD,EACWlH,oBAAS,GADpB,mBACdmH,EADc,KACHC,EADG,OAEWpH,mBAAS,MAFpB,mBAEdqH,EAFc,KAEJC,EAFI,OAGKtH,mBAAS,MAHd,mBAGdoC,EAHc,KAGPmF,EAHO,OAISvH,mBAAS,IAJlB,mBAIdwH,EAJc,KAILC,EAJK,OAKA9C,qBAAWR,GAAvBtE,EALY,oBASf6H,EAAaC,uBAAY,WAAmB,IAAlBH,EAAiB,uDAAP,GACzCC,EAAWD,GACXF,EAAY,MACZC,EAAS,MACTH,GAAW,GACXvH,EAAS,CAACsB,KLbc,aKaIC,QAAS,CAACmB,OAAS,kBAAC,IAAD,KAAe,kBAAC,IAAD,YAC5D,CAAC1C,IAfiB,EAiB2B2H,EAAzCI,cAjBc,MAiBL,MAjBK,EAiBEC,EAAyBL,EAAzBK,OAAWC,EAjBb,YAiB2BN,EAjB3B,qBAqBfO,EAAe,CACpBH,OAAQA,EACRI,QAhBwDC,gCAiBxDf,MACAgB,QAPe,CACf,eAAgB,oBAOhBL,OAAQA,EAAM,2BAAOA,GAAWM,KAAYC,MAAM/E,OAAOgF,SAASC,SAApD,eAAmEH,KAAYC,MAAM/E,OAAOgF,SAASC,SACnH3I,KAAiB,QAAXiI,EAAmBE,EAAa,MA6BvC,OA1BAhD,qBAAU,WAEJqC,GAEU,uCAAG,sBAAA7G,EAAA,6DACjB8G,GAAW,GADM,SAEJmB,KAAMR,GACjBS,KADW,+BAAAlI,EAAA,MACN,WAAO+G,GAAP,SAAA/G,EAAA,sDACLgH,EAAYD,EAAS1H,KAAKA,MAC1BE,EAAS,CAACsB,KLtCW,aKsCOC,QAAS,CAACmB,OAAQ,QAC9C1C,EAAS,CAACsB,KL5CU,YK4COC,QAAS,CAACc,MAAO,QAC5CrC,EAAS,CAACsB,KL3CoB,sBK2COC,QAAS,CAAC6C,QAASoD,EAAS1H,KAAKsE,WAJjE,2CADM,uDAOXwE,OAAM,SAACrG,GACP,IAAIlB,GAAS,OAALkB,QAAK,IAALA,OAAA,EAAAA,EAAOiF,UAAWjF,EAAMiF,SAAS1H,KAAKyC,MAAQ,IAAIsG,MAAM,+IAChEnB,EAASrG,GACTkG,GAAW,GACXvH,EAAS,CAACsB,KL9CW,aK8COC,QAAS,CAACmB,OAAQ,QAC9C1C,EAAS,CAACsB,KLpDU,YKoDOC,QAAS,CAACc,MAAO,QAC5CrC,EAAS,CAACsB,KLpDU,YKoDOC,QAAS,CAACgB,MAAOlB,QAf7B,mFAAH,oDAmBfyH,KAEE,CAACxB,EAAWY,EAAclI,IACtB,CAAC,CAACsH,YAAWE,WAAUjF,SAAQsF,I,4HC/DxB,YAACxG,GACf,IAAM0H,EAAW1H,EAAEI,cAAcsH,SACjC,OAAIA,EAASC,OAAmC,MAA1B3H,EAAEI,cAAciD,MAC9B,CAACuE,OAAQ,QAAS7E,QAAS,MAE9B2E,EAASG,UAAYH,EAASI,cAA0C,MAA1B9H,EAAEI,cAAciD,MAC1D,CAACuE,OAAQ,QAAS7E,QAAS,8OAE/B2E,EAASK,QACL,CAACH,OAAQ,QAAS7E,QAAS,kKAE/B2E,EAASM,aACL,CAACJ,OAAQ,QAAS7E,QAAS,iHAE/B2E,EAASO,aACL,CAACL,OAAQ,QAAS7E,QAAS,mKAE/B2E,EAASQ,cACiB,SAAzBlI,EAAEI,cAAcH,KAAwB,CAAC2H,OAAQ,QAAS7E,QAAS,iJAChE,CAAC6E,OAAQ,QAAS7E,QAAS,wHAE/B2E,EAASS,eACiB,SAAzBnI,EAAEI,cAAcH,KAAwB,CAAC2H,OAAQ,QAAS7E,QAAS,uLAChE,CAAC6E,OAAQ,QAAS7E,QAAS,iMAG5B,CAAC6E,OAAQ,UAAW7E,QAAS,OCnBvB,YAACqF,GACf,OAAOA,EAAIC,QAAQ,QAAS,IAAIA,QAAQ,UAAW,KAAKA,QAAQ,0tFAAoF,KCA/IzH,GAAe,CACpBJ,MAAO,GACPlB,IAAK,GACLgJ,gBAAiB,GACjBC,cAAe,IAGVvG,GAAU,SAACC,EAAOC,GACvB,OAAQA,EAAOjC,MACd,IAAK,eAAL,IACQC,EAAWgC,EAAXhC,QASP,OAAO,2BACH+B,GACA/B,GAEL,QACC,OAAO+B,IAIK,eAA2B,EAAzB+B,UAA0B,IAAfrF,EAAc,EAAdA,SAAc,EACP2E,qBAAWtB,GAASpB,IADb,mBAClC4H,EADkC,KACvBC,EADuB,OAERC,GAAO,cAFC,mBAEjCvC,EAFiC,KAEjCA,SAAWK,EAFsB,KAUzC,OANA5C,qBAAU,WACJuC,IACLxH,EAAS,CAACsB,KR1CgB,eQ0CIC,QAAS,CAACW,UAAkB,OAARsF,QAAQ,IAARA,OAAA,EAAAA,EAAUtF,UAAV,OAAqBsF,QAArB,IAAqBA,OAArB,EAAqBA,EAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,KR1Ce,cQ0CIC,QAAS,CAACY,SAAiB,OAARqF,QAAQ,IAARA,OAAA,EAAAA,EAAUrF,SAAV,OAAoBqF,QAApB,IAAoBA,OAApB,EAAoBA,EAAUrF,QAAU,SACtF,CAACqF,EAAUxH,IAGb,kBAAC,IAAD,CACCgK,SAAQ,uCAAE,WAAM3I,GAAN,SAAAZ,EAAA,6DACTY,EAAE4I,iBADO,SAEHpC,EAAW,CAChBE,OAAQ,OACRlG,MAAOgI,EAAUhI,MACjBlB,IAAKkJ,EAAUlJ,MALP,2CAAF,uDASR,kBAAC,IAAD,CAAOW,KAAM,OAAQ4I,YAAa,mJAAiCC,IAAK,mDAAYzF,MAAOmF,EAAUhI,MACjGuI,UAAU,EACVC,UAAW,KACXpB,OAAQY,EAAUF,gBAAgBV,OAClCqB,OAAQT,EAAUF,gBAAgBvF,QAAUyF,EAAUF,gBAAgBvF,QAA9D,UAA2EyF,EAAUhI,MAAMvB,OAA3F,oBACRiK,SAAU,SAAAlJ,GAAC,OAAIyI,EAAa,CAACxI,KAAM,eAAgBC,QAAS,CAACM,MAAO2I,GAAOnJ,EAAEI,cAAciD,OAAQiF,gBAAiBc,GAASpJ,SACjI,kBAAC,IAAD,CAAOC,KAAM,SAAU4I,YAAatK,EAAS,GAAIuK,IAAK,sEAAgBzF,MAAOmF,EAAUlJ,IACnF+J,QAAS,wBACTN,UAAU,EACVnB,OAAQY,EAAUD,cAAcX,OAChC0B,UAAU,UACVC,IAAK,UACLC,IAAK,EACLC,KAAM,IACNR,OAAQT,EAAUD,cAAcxF,QAAUyF,EAAUD,cAAcxF,QAAU,qSAC5EmG,SAAU,SAAAlJ,GAAC,OAAIyI,EAAa,CAACxI,KAAM,eAAgBC,QAAS,CAACZ,IAAKU,EAAEI,cAAciD,MAAMgF,QAAQ,UAAW,IAAKE,cAAea,GAASpJ,SAC5I,kBAAC,IAAD,CAAQ0J,KAAM,MAAd,4DChEG9I,GAAe,CACpBpB,QAAS,GACTgB,MAAO,GACPwC,KAAMxE,YAAO,IAAIgD,KAAQ,cACzBmI,QAAQ,EACRC,YAAa,GACbC,MAAO,GACPC,SAAU,GACVC,KAAM,GACNC,UAAU,EACVZ,SAAU,CACT5J,QAAS,GACTgB,MAAO,GACPoJ,YAAa,GACbC,MAAO,GACPC,SAAU,GACVC,KAAM,KAIF/H,GAAU,SAACC,EAAOC,GACvB,OAAQA,EAAOjC,MACd,IAAK,eAAL,MAC+CiC,EAAvChC,QAAU+J,EADlB,EACkBA,aAAiB/J,EADnC,gCAEC,OAAO,uCACH+B,GACA/B,GAFJ,IAGCkJ,SAAS,2BAAKnH,EAAMmH,UAAaa,KAEnC,QACC,OAAOhI,IAIK,eAA2E,IAAD,oEAAxEpB,EAAwE,EAAxEA,SAAwE,IAA9DV,UAA8D,MAAzD,KAAyD,MAAnDmB,kBAAmD,MAAtC,KAAsC,EAAhC3C,EAAgC,EAAhCA,SAAUoC,EAAsB,EAAtBA,OAAsB,IAAdR,aAAc,MAAR,GAAQ,IACvEzB,oBAAS,WACzB,OAAQwC,EAAD,gBAAiCA,EAAWxB,KAA9B,WADfoK,EADiF,sBAIvDxB,GAAOwB,GAJgD,oBAIhF/D,GAJgF,MAIhFA,SAAWK,GAJqE,SAK1DlD,qBAAWtB,GAASpB,IALsC,qBAKjFqB,GALiF,MAK1EwG,GAL0E,MAMlF0B,GAActJ,EAAStB,KAAI,SAAAoD,GAChC,OAAQ,4BAAQjD,IAAKiD,EAAK7C,IAAKuD,MAAOV,EAAK7C,KAAM6C,EAAKnC,MAA9C,KAAuDjC,EAASoE,EAAKrD,KAArE,QAGTsE,qBAAU,WACJtC,IACLA,EAAW0B,KAAOxE,YAAO,IAAIgD,KAAKF,EAAW0B,MAAO,cACpDyF,GAAa,CAACxI,KAAM,eAAgBC,QAAQ,eAAKoB,QAC/C,CAACA,EAAY3C,IAEhBiF,qBAAU,YACL,OAAC7C,QAAD,IAACA,OAAD,EAACA,EAAQP,QACC,SAAVD,GACJkI,GAAa,CACZxI,KAAM,eACNC,QAAS,CACR6J,MAAgB,OAAVzI,QAAU,IAAVA,OAAA,EAAAA,EAAYyI,QAAZ,OAAoBhJ,QAApB,IAAoBA,OAApB,EAAoBA,EAAQP,MAAM4J,cAAcC,MAAM,WAG5D,CAACtJ,EAAQpC,EAAU4B,EAAOe,IAE7BsC,qBAAU,WACJuC,KACLxH,EAAS,CAACsB,KTxEgB,eSwEIC,QAAS,CAACW,UAAkB,OAARsF,SAAQ,IAARA,QAAA,EAAAA,GAAUtF,UAAV,OAAqBsF,SAArB,IAAqBA,QAArB,EAAqBA,GAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,KTxEe,cSwEIC,QAAS,CAACY,SAAiB,OAARqF,SAAQ,IAARA,QAAA,EAAAA,GAAUrF,SAAV,OAAoBqF,SAApB,IAAoBA,QAApB,EAAoBA,GAAUrF,QAAU,SACtF,CAACqF,GAAUxH,IAEd,IAAMoL,GAAO9H,GAAM8H,KAAKO,QAAO,SAAAC,GAAG,QAAMA,EAAItL,UAAQM,KACnD,SAACgL,EAAK9K,GAAN,OACC,kBAAC,IAAD,CACCnB,MAAO,CACNkM,YAAa,MACb9J,aAAc,MACd+J,SAAU,OACVC,SAAU,SACVC,aAAc,UAEfjL,IAAKD,GAEJ8K,MAIJ,OACC,kBAAC,IAAD,CACC5B,SAAU,SAAA3I,GACTA,EAAE4I,iBACFpC,GAAW,CACVE,OAASpF,EAAsB,QAAT,OACtB0B,KAAMf,GAAMe,KACZxC,MAAOyB,GAAMzB,MACboJ,YAAa3H,GAAM2H,YACnBC,MAAO5H,GAAM+H,UAAY/H,GAAM4H,MAAQ5H,GAAM6H,UAAUc,QAAQ,GAAK3I,GAAM4H,MAC1EC,SAAU7H,GAAM6H,SAChBH,OAAQ1H,GAAM0H,OACdI,KAAM9H,GAAM8H,KAAKO,QAAO,SAAAC,GAAG,QAAMA,EAAItL,UACrC4L,SAAU5I,GAAMzC,UAAN,OAAiB8B,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAYuJ,WAAY1K,MAIrD,kBAAC,IAAD,CAAQ2I,IAAK,2BACTD,YAAa,4EACbK,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CAACV,QAASQ,EAAEI,cAAciD,MAAO4G,aAAc,CAACzK,QAAS4J,GAASpJ,QAG7E8K,aAAc7I,GAAMzC,UAAN,OAAiB8B,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAYuJ,WAAY1K,EAAI4I,UAAU,EACrEnB,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgB5J,eAAlB,aAAE,EAAyBoI,OACjCqB,OAAM,UAAEhH,GAAMmH,gBAAR,iBAAE,EAAgB5J,eAAlB,aAAE,EAAyBuD,SAEnCoH,IAEF,kBAAC,IAAD,CAAOlK,KAAM,OACT6I,IAAK,2BACLzF,MAAOpB,GAAMe,KACb+F,UAAU,EACVS,IAAK,aACLD,IAAK/K,YAAO,IAAIgD,KAAQ,cACxB0H,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CAAC8C,KAAMhD,EAAEI,cAAciD,MAAO4G,aAAc,CAACjH,KAAMoG,GAASpJ,QAGvE4H,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgBpG,YAAlB,aAAE,EAAsB4E,OAC9BqB,OAAM,UAAEhH,GAAMmH,gBAAR,iBAAE,EAAgBpG,YAAlB,aAAE,EAAsBD,UAElC,kBAAC,IAAD,CAAO9C,KAAM,OACT4I,YAAa,mHACbxF,MAAOpB,GAAMzB,MACbsI,IAAK,mDACLC,UAAU,EACVC,UAAW,GACXpB,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgB5I,aAAlB,aAAE,EAAuBoH,OAC/BqB,QAAQ,UAAAhH,GAAMmH,gBAAN,mBAAgB5I,aAAhB,eAAuBuC,SAAvB,UAAiCd,GAAMmH,gBAAvC,iBAAiC,EAAgB5I,aAAjD,aAAiC,EAAuBuC,QAAxD,UAAqEd,GAAMzB,MAAMvB,OAAjF,oBACRiK,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CACRM,MAAO2I,GAAOnJ,EAAEI,cAAciD,OAC9B4G,aAAc,CAACzJ,MAAO4I,GAASpJ,UAItC,kBAAC,IAAD,CAAO+K,KAAM,SACT1H,OAAO,EACP2H,gBAAgB/I,GAAM0H,QAAS,KAC/B5J,QAAS,WACR0I,GAAa,CAACxI,KAAM,eAAgBC,QAAS,CAACyJ,QAAQ,OAJ3D,wCASA,kBAAC,IAAD,CAAOoB,KAAM,SACT1H,OAAO,EACP2H,iBAAgB/I,GAAM0H,QAAgB,KACtC5J,QAAS,WACR0I,GAAa,CAACxI,KAAM,eAAgBC,QAAS,CAACyJ,QAAQ,OAJ3D,mCAUE1H,GAAM0H,QAEP,kBAAC,IAAD,CAAUb,IAAK,mDACVD,YAAa,gLACbxF,MAAOpB,GAAM2H,YACbZ,UAAW,GACXpB,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgBQ,mBAAlB,aAAE,EAA6BhC,OACrCqB,QAAQ,UAAAhH,GAAMmH,gBAAN,mBAAgBQ,mBAAhB,eAA6B7G,SAA7B,UAAuCd,GAAMmH,gBAA7C,iBAAuC,EAAgBQ,mBAAvD,aAAuC,EAA6B7G,QAApE,UAAiFd,GAAM2H,YAAY3K,OAAnG,oBACRiK,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CACR0J,YAAaT,GAAOnJ,EAAEI,cAAciD,OACpC4G,aAAc,CAACL,YAAaR,GAASpJ,UAM9C,kBAAC,IAAD,CAAOC,KAAM,OACT6I,IAAK,2BACLzF,MAAOpB,GAAM8H,KAAKkB,KAAK,KACvBpC,YAAa,+FACbjB,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgBW,YAAlB,aAAE,EAAsBnC,OAC9BoB,UAAW,IACXC,QAAQ,UAAAhH,GAAMmH,gBAAN,mBAAgBW,YAAhB,eAAsBhH,SAAtB,UAAgCd,GAAMmH,gBAAtC,iBAAgC,EAAgBW,YAAhD,aAAgC,EAAsBhH,QAAtD,UAAmEd,GAAM8H,KAAKkB,KAAK,KAAKhM,OAAxF,sEACRiK,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CACR6J,KAAgC,KAA1B/J,EAAEI,cAAciD,MAAe8F,GAAOnJ,EAAEI,cAAciD,OAAO+G,cAAcC,MAAM,KAAO,GAC9FJ,aAAc,CAACF,KAAMX,GAASpJ,YAMlC+J,GAAK9K,QACe,IAAtBgD,GAAM8H,KAAK9K,QAEX,kBAAC,IAAD,CAAKX,MAAO,CAAC4M,QAAS,OAAQC,SAAU,SACtCpB,IAGH,kBAAC,IAAD,CAAO9J,KAAM,SACT4I,YAAatK,EAAS,GACtB8K,QAAS,wBACTP,IAAK,2BACLQ,UAAU,UACVC,IAAK,SACLC,IAAK,EACLC,KAAM,KACN7B,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgBS,aAAlB,aAAE,EAAuBjC,OAC/BqB,OAAM,UAAEhH,GAAMmH,gBAAR,iBAAE,EAAgBS,aAAlB,aAAE,EAAuB9G,QAC/BM,MAAOpB,GAAM4H,MACbd,UAAU,EACVG,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CAAC2J,MAAO7J,EAAEI,cAAciD,MAAMgF,QAAQ,UAAW,IAAK4B,aAAc,CAACJ,MAAOT,GAASpJ,WAKlGiC,GAAM0H,QAEP,kBAAC,IAAD,CAAUtG,MAAOpB,GAAM+H,SAClBjK,QAAS,WACR0I,GAAa,CAACxI,KAAM,eAAgBC,QAAS,CAAC8J,UAAW/H,GAAM+H,cAFrE,0FAQD,kBAAC,IAAD,CAAO/J,KAAM,SACT4I,YAAa,IACbQ,QAAS,wBACTP,IAAK,kCACLQ,UAAU,UACVC,IAAK,QACLC,IAAK,EACLC,KAAM,KACN7B,OAAM,UAAE3F,GAAMmH,gBAAR,iBAAE,EAAgBU,gBAAlB,aAAE,EAA0BlC,OAClCqB,OAAM,UAAEhH,GAAMmH,gBAAR,iBAAE,EAAgBU,gBAAlB,aAAE,EAA0B/G,QAClCM,MAAOpB,GAAM6H,SACbf,UAAU,EACVG,SAAU,SAAClJ,GACVyI,GAAa,CACZxI,KAAM,eACNC,QAAS,CAAC4J,SAAU9J,EAAEI,cAAciD,MAAMgF,QAAQ,UAAW,IAAK4B,aAAc,CAACH,SAAUV,GAASpJ,UAI1G,kBAAC,IAAD,CAAQ0J,KAAM,MAAd,iEACezH,GAAM+H,SAAWzL,EAAS0D,GAAM4H,OAAStL,EAAS0D,GAAM4H,MAAQ5H,GAAM6H,c,wCCrQzE,SAASsB,GAAYzM,GACnC,OAAO,SAACgE,EAAMlD,GACb,cAAIkD,QAAJ,IAAIA,OAAJ,EAAIA,EAAM0I,WAER,kBAAC,IAAD,CAASvF,MAAM,IAAIrF,OAAO,WAAW6K,MAAI,EACpC5L,IAAKD,GAAQjB,YAAO,IAAIgD,KAAJ,OAASmB,QAAT,IAASA,OAAT,EAASA,EAAM0I,WAAY,eAAgB,CAACrG,OAAQuG,OAI9E,kBAAC,IAAD,CACC7L,IAAKD,EACL+L,WAAS,EACTC,QAASjN,YAAO,IAAIgD,KAAJ,OAASmB,QAAT,IAASA,OAAT,EAASA,EAAMK,MAAO,eAAgB,CAACgC,OAAQuG,MAC/DG,OAAW,OAAJ/I,QAAI,IAAJA,OAAA,EAAAA,EAAMgH,QAASpL,EAAQ,OAACoE,QAAD,IAACA,OAAD,EAACA,EAAMrD,KAAOf,GAAU,GAAD,OAAKoE,QAAL,IAAKA,OAAL,EAAKA,EAAMrD,MAChEO,UAAA,OAAS8C,QAAT,IAASA,OAAT,EAASA,EAAM7C,IACfC,QAAS,WACRpB,EAAS,CAACsB,KVdgB,kBUcOC,QAAS,CAACyC,KAAMA,KACjDhE,EAAS,CAACsB,KVrBU,YUqBOC,QAAS,CAACc,MAAO,iBAR9C,OAWE2B,QAXF,IAWEA,OAXF,EAWEA,EAAMnC,Q,cCzBI,YAAUpB,EAAGC,GAC3B,IAAMsM,EAAQ,IAAInK,KAAKpC,EAAE4D,MACnB4I,EAAQ,IAAIpK,KAAKnC,EAAE2D,MACzB,OAAO6I,aAAWD,EAAOD,I,mBCHX,YAAUG,EAAMC,GAAO,IAAD,EACpC,OAAIC,aAAQ,IAAIxK,KAAJ,UAASsK,EAAKA,EAAK7M,OAAO,UAA1B,aAAS,EAAqB+D,MAAO,IAAIxB,KAAKuK,EAAK/I,OACxD,GAAN,oBAAW8I,GAAX,CAAiBC,IAEX,GAAN,oBAAWD,GAAX,CAAiB,CAACT,UAAWU,EAAK/I,MAAO+I,KCH5B,eAAiB,IAAfE,EAAc,EAAdA,SAEVC,EAAYC,iBAAO,MAEzB,OACC,oCACA,kBAAC,IAAD,CACCxD,SAAU,SAAC3I,GACVA,EAAE4I,iBACFsD,EAAUE,QAAQC,UAGnB,kBAAC,IAAD,CACCnD,SAAU,SAAClJ,GACViM,EAASjM,EAAEI,cAAciD,WAG5B,2BAAOpD,KAAM,QAAS3B,MAAO,CAACgO,SAAU,WAAYC,OAAQ,IAAKC,MAAO,IAAK1D,IAAK,IAAKpD,KAAM,KAAM+G,IAAKP,MCkB3F,eAAkD,IAAhD/L,EAA+C,EAA/CA,GAAIX,EAA2C,EAA3CA,QAASb,EAAkC,EAAlCA,SAAUqF,EAAwB,EAAxBA,UAAWlB,EAAa,EAAbA,QAAa,EAC/BhE,oBAAS,kBAAMgE,KADgB,mBACxD4J,EADwD,KAC9CC,EAD8C,OAE9BjE,GAAO,cAAD,cAAelJ,QAAf,IAAeA,OAAf,EAAeA,EAASM,MAFA,mBAEvDqG,EAFuD,KAEvDA,SAAWK,EAF4C,OAGrC1H,oBAAS,WAClC,OAAKU,EACL,OAAOA,QAAP,IAAOA,OAAP,EAAOA,EAASoN,WADK,MAJyC,mBAGxDC,EAHwD,KAGjDC,EAHiD,OAOrBhO,oBAAS,kBAAM+N,GAAS,MAPH,mBAOxDE,EAPwD,KAOzCC,EAPyC,KASzDC,EAAmBF,EAAc5N,KAAKA,IAAMoG,OAAOA,GAAQ,IAAIhG,IAAI6L,GAAYzM,IAE/EuO,EAAgB,WACrBvO,EAAS,CAACsB,KdrCsB,qBcqCIC,QAAS,CAAC4C,SAAU4J,MAEnD7J,EACL,kBAAC,IAAD,CACCsK,QAAS,CACR,CACC3M,MAAO,uCACP4M,WAAW,EACXzI,KAAM,UAEP,CACCnE,MAAO,6CACPmE,KAAM,cACNyI,WAAW,EACXlL,OAAO,WAAD,4BAAE,sBAAA9C,EAAA,6DACP8N,IADO,SAED1G,EAAW,CAChBE,OAAQ,WAHF,2CAAF,kDAAC,KAQT7C,QAAS,WACRqJ,IACAvO,EAAS,CAACsB,KdlEY,ackEMC,QAAS,CAACmB,OAAQ,UAG/C,oGACA,wxBAKFuC,qBAAU,WACJpE,IACLsN,EAAQ,OAACtN,QAAD,IAACA,OAAD,EAACA,EAASoN,YAClBI,EAAgB,OAACxN,QAAD,IAACA,OAAD,EAACA,EAASoN,eACxB,CAACpN,IAEJoE,qBAAU,WACJuC,IACLxH,EAAS,CAACsB,KdhFoB,qBciF9BtB,EAAS,CAACsB,KdnFmB,kBcmFIC,QAAS,CAACyC,KAAM,QACjDhE,EAAS,CAACsB,Kd7FgB,ec6FIC,QAAS,CAACW,UAAkB,OAARsF,QAAQ,IAARA,OAAA,EAAAA,EAAUtF,UAAV,OAAqBsF,QAArB,IAAqBA,OAArB,EAAqBA,EAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,Kd7Fe,cc6FIC,QAAS,CAACY,SAAiB,OAARqF,QAAQ,IAARA,OAAA,EAAAA,EAAUrF,SAAV,OAAoBqF,QAApB,IAAoBA,OAApB,EAAoBA,EAAUrF,QAAU,SACtF,CAACnC,EAAUwH,IAEdvC,qBAAU,WACT+I,EAAY7J,KACV,CAACA,IAUJ,OACC,kBAAC,IAAD,CAAO3C,GAAIA,GACV,kBAAC,IAAD,CAAauF,KACZ,oCACC,kBAAC,IAAD,CAAiB3F,QAAS,WACzBpB,EAAS,CAACsB,KdvGgB,qBcwG1BtB,EAAS,CAACsB,Kd1Ge,kBc0GQC,QAAS,CAACyC,KAAM,WAElD,kBAAC,IAAD,CACC5C,QAAS,WACRpB,EAAS,CAACsB,Kd9Gc,kBc8GSC,QAAS,CAACyC,KAAM,QACjDhE,EAAS,CAACsB,KdrHQ,YcqHSC,QAAS,CAACc,MAAO,iBAG7C,kBAAC,IAAD,SAKF,kBAAC,IAAD,CACCqM,MAAO7N,GAAW,kBAAC,KAAD,CAAgBlB,MAAO,CAACgP,UAAU,UAAD,OAAYZ,EAAW,SAAW,IAAlC,QACnD3M,QAASmN,GAER1N,EAAO,OAAGA,QAAH,IAAGA,OAAH,EAAGA,EAASgB,MAAQ,kEAI7BhB,GAEA,oCACC,kBAAC,IAAD,CAAoB+N,OAAQb,EAAU7I,QAASqJ,GAC9C,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCpJ,OAAQ,kBAAC,KAAD,MACR/D,QAAS,WACRpB,EAAS,CAACsB,KdxIO,acwIWC,QAAS,CAACmB,OAAQwB,EAAOA,OAAO,OAH9D,8EAMerD,QANf,IAMeA,OANf,EAMeA,EAASgB,SAI1B,kBAACmF,EAAD,CAAa3B,UAAWA,IAExB,kBAACwJ,GAAD,CAAYvB,SApDC,SAAC7D,GAEhB4E,EADW,KAAR5E,EACcyE,EAED,OAACrN,QAAD,IAACA,OAAD,EAACA,EAASoN,WAAWtC,QAAO,qBAAE9J,MAAiB4J,cAAcqD,QAAQrF,EAAIgC,gBAAkB,SAkDzG,kBAAC,IAAD,CACCxE,OAAQ,kBAAC,IAAD,CAAQjB,KAAK,aAAb,4GACRkB,UAAU,QAEV,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOC,MAAM,IAAIrF,OAAO,WAAWnC,MAAO,CAACoC,aAAc,KAAMnC,EAAQ,OAACiB,QAAD,IAACA,OAAD,EAACA,EAASF,OAGlD,KAAxB,OAAPE,QAAO,IAAPA,OAAA,EAAAA,EAASoN,WAAW3N,SAAgB,kBAAC,IAAD,8JACrC,kBAAC,IAAD,KACEgO,EAC4B,IAA5BA,EAAiBhO,QAAgB,kBAAC,IAAD,wJAGpC,kBAAC,EAAD,SC/JU,eAA4D,IAA1DkB,EAAyD,EAAzDA,GAAIW,EAAqD,EAArDA,QAASnC,EAA4C,EAA5CA,SAA4C,IAAlCqE,YAAkC,MAA3B,IAAIxB,KAAuB,EAAfwC,EAAe,EAAfA,UAK1D,OACC,kBAAC,IAAD,CAAO7D,GAAIA,GACV,kBAAC,IAAD,CACCuF,KACC,kBAAC,IAAD,CAAmB3F,QAAS,kBAAMpB,EAAS,CAACsB,KfhBxB,YegByCC,QAAS,CAACc,MAAO,kBAC7E,kBAAC,IAAD,QAHH,8CASA,kBAAC2E,EAAD,CAAa3B,UAAWA,IACxB,kBAAC,IAAD,CACC4B,OAAQ,kBAAC,IAAD,CAAQjB,KAAK,aAAb,oFACHnG,YAAO,IAAIgD,KAAKwB,GAAO,eAAgB,CAACgC,OAAQuG,QAGrD,kBAACxF,EAAD,CAAatH,KAAMqC,EAASnC,SAAUA,EAAUD,SAAS,EAAME,UAAW,UAAWC,UAAU,IAC/F,kBAAC,IAAD,i5BAED,kBAAC,EAAD,QC3BG+B,GAAe,CACpBJ,MAAO,GACPkN,SAAU,GACVtE,SAAU,CACT5I,MAAO,GACPkN,SAAU,KAIN1L,GAAU,SAACC,EAAOC,GACvB,OAAQA,EAAOjC,MACd,IAAK,eAAL,MAC+CiC,EAAvChC,QAAU+J,EADlB,EACkBA,aAAiB/J,EADnC,gCAEC,OAAO,uCACH+B,GACA/B,GAFJ,IAGCkJ,SAAS,2BAAKnH,EAAMmH,UAAaa,KAEnC,QACC,OAAOhI,IAIK,eAAoC,IAAD,wBAAjCtD,EAAiC,EAAjCA,SAAiC,IAAvB2C,kBAAuB,MAAV,KAAU,IACfgC,qBAAWtB,GAASpB,IADL,mBAC1C4H,EAD0C,KAC/BC,EAD+B,OAEhC3J,oBAAS,WACzB,OAAQwC,EAAD,kBAAqCA,EAAWxB,KAAlC,aADfoK,EAF0C,sBAKhBxB,GAAOwB,GALS,mBAKzC/D,EALyC,KAKzCA,SAAWK,EAL8B,KAkBjD,OAXA5C,qBAAU,WACJtC,IACA6E,GAAUsC,EAAa,CAACxI,KAAM,eAAgBC,QAAQ,eAAKoB,QAC9D,CAACA,EAAYmH,EAActC,IAE9BvC,qBAAU,WACJuC,IACLxH,EAAS,CAACsB,KhB7CgB,egB6CIC,QAAS,CAACW,UAAkB,OAARsF,QAAQ,IAARA,OAAA,EAAAA,EAAUtF,UAAV,OAAqBsF,QAArB,IAAqBA,OAArB,EAAqBA,EAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,KhB7Ce,cgB6CIC,QAAS,CAACY,SAAiB,OAARqF,QAAQ,IAARA,OAAA,EAAAA,EAAUrF,SAAV,OAAoBqF,QAApB,IAAoBA,OAApB,EAAoBA,EAAUrF,QAAU,SACtF,CAACqF,EAAUxH,IAGb,kBAAC,IAAD,CACCgK,SAAQ,uCAAE,WAAM3I,GAAN,SAAAZ,EAAA,6DACTY,EAAE4I,iBADO,SAEHpC,EAAW,CAChBE,OAASpF,EAAsB,QAAT,OACtBd,MAAOgI,EAAUhI,MACjBlB,IAAKkJ,EAAUkF,WALP,2CAAF,uDASR,kBAAC,IAAD,CAAOzN,KAAM,OAAQ4I,YAAa,8FAAoBC,IAAK,mDAAYzF,MAAOmF,EAAUhI,MACpFuI,UAAU,EACVC,UAAW,KACXpB,OAAM,UAAEY,EAAUY,gBAAZ,iBAAE,EAAoB5I,aAAtB,aAAE,EAA2BoH,OACnCqB,QAAQ,UAAAT,EAAUY,gBAAV,mBAAoB5I,aAApB,eAA2BuC,SAA3B,UAAqCyF,EAAUY,gBAA/C,iBAAqC,EAAoB5I,aAAzD,aAAqC,EAA2BuC,QAAhE,UAA6EyF,EAAUhI,MAAMvB,OAA7F,oBACRiK,SAAU,SAAAlJ,GAAC,OAAIyI,EAAa,CAC3BxI,KAAM,eACNC,QAAS,CAACM,MAAO2I,GAAOnJ,EAAEI,cAAciD,OAAQ4G,aAAc,CAACzJ,MAAO4I,GAASpJ,UAEpF,kBAAC,IAAD,CAAOC,KAAM,SAAU4I,YAAatK,EAAS,GAAIuK,IAAK,mFAAmBzF,MAAOmF,EAAUkF,SACtFrE,QAAS,wBACTC,UAAU,UACVP,UAAU,EACVnB,OAAM,UAAEY,EAAUY,gBAAZ,iBAAE,EAAoBsE,gBAAtB,aAAE,EAA8B9F,OACtC4B,IAAK,EACLD,IAAK,UACLE,KAAM,IACNR,QAAQ,UAAAT,EAAUY,gBAAV,mBAAoBsE,gBAApB,eAA8B3K,SAA9B,UAAwCyF,EAAUY,gBAAlD,iBAAwC,EAAoBsE,gBAA5D,aAAwC,EAA8B3K,QAAU,uLACxFmG,SAAU,SAAAlJ,GAAC,OAAIyI,EAAa,CAC3BxI,KAAM,eACNC,QAAS,CAACwN,SAAU1N,EAAEI,cAAciD,MAAO4G,aAAc,CAACyD,SAAUtE,GAASpJ,UAElF,kBAAC,IAAD,CAAQ0J,KAAM,MAAd,4D,oFC3CY,eAAsC,IAApCvJ,EAAmC,EAAnCA,GAAIY,EAA+B,EAA/BA,OAAQpC,EAAuB,EAAvBA,SAAUmE,EAAa,EAAbA,QAAa,EACnBhE,oBAAS,kBAAMgE,KADI,mBAC5C4J,EAD4C,KAClCC,EADkC,OAElBjE,GAAO,WAAD,cAAY3H,QAAZ,IAAYA,OAAZ,EAAYA,EAAQjB,MAFR,mBAE3CqG,EAF2C,KAE3CA,SAAWK,EAFgC,OAGzB1H,oBAAS,yBAAMiC,QAAN,IAAMA,OAAN,EAAMA,EAAQ8L,SAHE,mBAG5CA,EAH4C,KAGrCC,EAHqC,OAIThO,oBAAS,kBAAM+N,KAJN,mBAI5CE,EAJ4C,KAI7BC,EAJ6B,KAMnDpJ,qBAAU,WACTkJ,EAAQ,OAAC/L,QAAD,IAACA,OAAD,EAACA,EAAQ8L,OACjBG,EAAgB,OAACjM,QAAD,IAACA,OAAD,EAACA,EAAQ8L,SACvB,CAAC9L,IAEJ6C,qBAAU,WACJuC,KACL,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAUwH,gBACbhP,EAAS,CAACsB,KjB1CmB,qBiB2C7BtB,EAAS,CAACsB,KjB7CkB,kBiB6CKC,QAAS,CAACyC,KAAM,SAElDhE,EAAS,CAACsB,KjBxDgB,eiBwDIC,QAAS,CAACW,UAAkB,OAARsF,QAAQ,IAARA,OAAA,EAAAA,EAAUtF,UAAV,OAAqBsF,QAArB,IAAqBA,OAArB,EAAqBA,EAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,KjBxDe,ciBwDIC,QAAS,CAACY,SAAiB,OAARqF,QAAQ,IAARA,OAAA,EAAAA,EAAUrF,SAAV,OAAoBqF,QAApB,IAAoBA,OAApB,EAAoBA,EAAUrF,QAAU,SACtF,CAACqF,EAAUxH,IAEdiF,qBAAU,WACT+I,EAAY7J,KACX,CAACA,IAEH,IAAMoK,EAAgB,WACrBvO,EAAS,CAACsB,KjBpDsB,qBiBoDIC,QAAS,CAAC4C,SAAU4J,MAGnDkB,EACL,kBAAC,IAAD,CACCT,QAAS,CACR,CACC3M,MAAO,uCACP4M,WAAW,EACXzI,KAAM,UAEP,CACCnE,MAAO,6CACPmE,KAAM,cACNyI,WAAW,EACXlL,OAAO,WAAD,4BAAE,sBAAA9C,EAAA,6DACP8N,IADO,SAED1G,EAAW,CAChBE,OAAQ,WAHF,2CAAF,kDAAC,KAST7C,QAAS,WACRqJ,IACAvO,EAAS,CAACsB,KjBnFY,aiBmFMC,QAAS,CAACmB,OAAQ,UAG/C,gHACA,iPAIIwM,EAAYd,GAAiBA,EAAc5N,KAAKA,IAAMoG,OAAOA,GAAQ,IAAIhG,IAAI6L,GAAYzM,IAU/F,OACC,kBAAC,IAAD,CAAOwB,GAAIA,GACV,kBAAC,IAAD,CAAauF,KACZ,oCACC,kBAAC,IAAD,CAAiB3F,QAAS,WACzBpB,EAAS,CAACsB,KjBvGgB,wBiByG3B,kBAAC,IAAD,CACCF,QAAS,WACRpB,EAAS,CAACsB,KjB7Gc,kBiB6GSC,QAAS,CAACyC,KAAM,QACjDhE,EAAS,CAACsB,KjBpHQ,YiBoHSC,QAAS,CAACc,MAAO,iBAG7C,kBAAC,IAAD,SAKF,kBAAC,IAAD,CACCqM,MAAOtM,GAAU,kBAAC,KAAD,CAAgBzC,MAAO,CAACgP,UAAU,UAAD,OAAYZ,EAAW,SAAW,IAAlC,QAClD3M,QAASmN,GAERnM,EAAM,OAAGA,QAAH,IAAGA,OAAH,EAAGA,EAAQP,MAAQ,8EAI3BO,GACA,oCACC,kBAAC,IAAD,CAAoBwM,OAAQb,EAAU7I,QAASqJ,GAC9C,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCpJ,OAAQ,kBAAC,KAAD,MACR/D,QAAS,WACRpB,EAAS,CAACsB,KjBrIY,kBiBqIWC,QAAS,CAACyC,KAAM5B,KACjDpC,EAAS,CAACsB,KjB5IM,YiB4IWC,QAAS,CAACc,MAAO,gBAC5CkM,MALF,gGAQkBnM,QARlB,IAQkBA,OARlB,EAQkBA,EAAQP,OAE1B,kBAAC,IAAD,CACCsD,OAAQ,kBAAC,KAAD,MACR/D,QAAS,WACRpB,EAAS,CAACsB,KjBhJO,aiBgJWC,QAAS,CAACmB,OAAQuM,EAAa/K,OAAO,OAHpE,0FAMiB9B,QANjB,IAMiBA,OANjB,EAMiBA,EAAQP,SAI3B,kBAACgN,GAAD,CAAYvB,SA1DC,SAAC7D,GAEhB4E,EADW,KAAR5E,EACcyE,EAEA9L,EAAO8L,MAAMvC,QAAO,qBAAE9J,MAAiB4J,cAAcqD,QAAQrF,EAAIgC,gBAAkB,SAuDlG,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCtG,OAAQ,kBAAC,KAAD,MACRa,KAAM,QAFP,uHAIuBpG,EAASwC,EAAO2M,WAEvC,kBAAC,IAAD,CACC5J,OAAQ,kBAAC,KAAD,MACRa,KAAM,QAFP,sGAKSpG,EAASwC,EAAO8L,MAAMtN,KAAI,SAAAoD,GAAI,OAAIA,EAAKgH,OAAShH,EAAKrD,IAAM,KAAGiG,QAAO,SAACC,EAAKC,GAAN,OAAcD,EAAMC,IAAK,KAEvG,kBAAC,IAAD,CACC3B,OAAQ,kBAAC,KAAD,MACRa,KAAM,QAFP,0DAIYpG,EAASwC,EAAO8L,MAAMtN,KAAI,SAAAoD,GAAI,OAAKA,EAAKgH,OAAoB,EAAXhH,EAAKrD,OAASiG,QAAO,SAACC,EAAKC,GAAN,OAAcD,EAAMC,IAAK,MAG5G,kBAAC,IAAD,KACEoI,EACsB,KAAb,OAATA,QAAS,IAATA,OAAA,EAAAA,EAAW5O,SAAgB,kBAAC,IAAD,uJAE7B,kBAAC,EAAD,SCnLU,eAAgC,IAA9BkB,EAA6B,EAA7BA,GAAIU,EAAyB,EAAzBA,SAAUmD,EAAe,EAAfA,UAAe,EACTlF,oBAAS,WAC5C,OAAO+B,EACLtB,KAAI,SAAAoD,GAAI,OAAIA,EAAKiK,cACjBkB,OACAxD,QAAO,qBAAEX,UACTxK,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEoB,MAAMuN,cAAc1O,EAAEmB,aANG,mBACtCoM,EADsC,KAC1BoB,EAD0B,OAQHlP,oBAAS,kBAAM8N,KARZ,mBAQtCG,EARsC,KAQvBC,EARuB,KAqBvCC,EAAmBF,EACvBxH,QAbc,SAACuG,EAAMC,GAAU,IAAD,EAC/B,IAAI,UAAAD,EAAKA,EAAK7M,OAAS,UAAnB,eAAuBuB,SAAUuL,EAAKvL,MAAO,CAChD,IAAMyN,EAAWnC,EAAKA,EAAK7M,OAAS,GACpCgP,EAAS3O,IAAM2O,EAAS3O,IAAMyM,EAAKzM,IACnC2O,EAASnE,UAAYiC,EAAKjC,SAC1B,IAAMoE,EAAK,uBAAOpC,EAAKqC,MAAM,EAAGrC,EAAK7M,OAAS,IAAnC,CAAuCgP,IAClD,OAAO,aAAIC,GAEX,MAAM,GAAN,oBAAWpC,GAAX,CAAiB,CAACtL,MAAOuL,EAAKvL,MAAOlB,IAAKyM,EAAKzM,IAAKwK,SAAUiC,EAAKjC,cAKnD,IAChBvK,KCxBK,SAACoD,EAAMlD,GACb,OACC,kBAAC,IAAD,CACCC,IAAKD,EACL+L,WAAS,EACTC,QAAO,kDAAa9I,QAAb,IAAaA,OAAb,EAAaA,EAAMmH,SAAnB,qDAA0CvL,GAAa,OAAJoE,QAAI,IAAJA,OAAA,EAAAA,EAAMrD,MAAN,OAAUqD,QAAV,IAAUA,OAAV,EAAUA,EAAMmH,YAC1E4B,MAAOnN,EAAQ,OAACoE,QAAD,IAACA,OAAD,EAACA,EAAMrD,KACtB8O,aAAA,OAAYzL,QAAZ,IAAYA,OAAZ,EAAYA,EAAMnC,OALnB,OAOEmC,QAPF,IAOEA,OAPF,EAOEA,EAAMnC,UDiBVoD,qBAAU,WACT,IAAMiJ,EAAQhM,EACZtB,KAAI,SAAAoD,GAAI,OAAIA,EAAKiK,cACjBkB,OACAxD,QAAO,qBAAEX,UACTxK,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEoB,MAAMuN,cAAc1O,EAAEmB,UACzCwN,EAAcnB,GACdG,EAAiBH,KACf,CAAChM,IAoBJ,OACC,kBAAC,IAAD,CAAOV,GAAIA,GACV,kBAAC,IAAD,6CAGA,kBAACwF,EAAD,CAAa3B,UAAWA,IACxB,kBAACwJ,GAAD,CAAYvB,SAxBG,SAAC7D,GAEhB4E,EADW,KAAR5E,EACcvH,EACftB,KAAI,SAAAoD,GAAI,OAAIA,EAAKiK,cACjBkB,OACAxD,QAAO,qBAAEX,UACTxK,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEoB,MAAMuN,cAAc1O,EAAEmB,UAGxBK,EACftB,KAAI,SAAAoD,GAAI,OAAIA,EAAKiK,cACjBkB,OACAxD,QAAO,qBAAEX,UACTxK,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEoB,MAAMuN,cAAc1O,EAAEmB,UACvC8J,QAAO,qBAAE9J,MAAiB4J,cAAcqD,QAAQrF,EAAIgC,gBAAkB,SAWxE,kBAAC,IAAD,KACE6C,EAC4B,IAA5BA,EAAiBhO,QAAgB,kBAAC,IAAD,yJ,qBE/DvB,eAA8B,IAA5BkB,EAA2B,EAA3BA,GAAIxB,EAAuB,EAAvBA,SAAU0P,EAAa,EAAbA,QAC9B,OACC,kBAAC,IAAD,CAAOlO,GAAIA,GACV,kBAAC,IAAD,CACCmO,KAAMD,EAAU,kBAAC,IAAD,CAAS3E,KAAK,UAAY,kBAAC,KAAD,MAC1CxH,QACEmM,GAAW,kBAAC,IAAD,CACXtO,QAAS,WACRpB,EAAS,CAACsB,KpBPc,kBoBOSC,QAAS,CAACI,KAAM,OAAQC,MAAO,WAEjEJ,GAAI,kBAJO,0DASboO,WAAS,GAERF,EAAU,sMAAwC,uG,wECdxC,OAAW,IAATlO,EAAQ,EAARA,GACVqO,EAAS,IAAIC,IAAItM,OAAOgF,SAASuH,MAAMC,aAAaC,IAAI,cADtC,EAEwC9P,oBAAS,GAFjD,mBAEjB+P,EAFiB,KAESC,EAFT,OAG0BhQ,oBAAS,GAHnC,mBAGjBiQ,EAHiB,KAGEC,EAHF,KAoBxB,OAfApL,oBAAU,KACTqL,KAAOC,UAAW,IAA4B,IAAD,IAA1BC,OAASlP,EAAiB,EAAjBA,KAAMxB,EAAW,EAAXA,KACpB,sCAATwB,IACH6O,EAA4BrQ,EAAK2Q,sBACjCJ,EAAqBvQ,EAAK4Q,0BAEd,kCAATpP,GACCxB,EAAK6Q,QACRN,EAAqBvQ,EAAK6Q,UAI7BL,KAAOM,KAAK,gCACV,IAGF,kBAAC,IAAD,CAAOpP,GAAIA,GACV,kBAAC,IAAD,2BACA,kBAAC,IAAD,CACCyF,OACC,kBAAC,IAAD,CACCjB,KAAK,aADN,mFAOD,kBAAC,IAAD,CACC/E,YAAU,EACVkE,OACC,kBAAC,KAAD,MAED/D,QAAS,KACRkP,KAAOM,KAAK,gBAAiB,CAACC,KAAK,oCAAD,OAAsChB,OAN1E,gEAWA,kBAAC,IAAD,CACC5O,YAAU,EACVkE,OAAQ,kBAAC,KAAD,MACR/D,QAAS,KACRkP,KAAOM,KAAK,oBAAqB,CAACE,SAAU,cAJ9C,0IAUCZ,IAA6BE,GAAqB,kBAAC,IAAD,CAClDnP,YAAU,EACVkE,OAAQ,kBAAC,KAAD,MACR/D,QAAS,KACRkP,KAAOM,KAAK,6BAJqC,6IAUnD,ICoLWG,GA5MH,KAAO,IAAD,EACXC,EAAKC,cADM,EAE2BlH,GAAO,UAFlC,0BAETvC,EAFS,EAETA,SAAUF,EAFD,EAECA,UAAYO,EAFb,OAGiB1H,oBAAS,GAH1B,mBAGV+Q,EAHU,KAGCC,EAHD,OAISrM,qBAAWR,GAJpB,mBAIVhB,EAJU,KAIHtD,EAJG,OAK2BG,mBAAS,GALpC,mBAKViR,EALU,KAKMC,EALN,KAOjBpM,oBAAU,KACTqL,KAAOC,UAAW,IAA4B,IAAD,IAA1BC,OAASlP,EAAiB,EAAjBA,KAAMxB,EAAW,EAAXA,KACpB,yBAATwB,GACHtB,EAAS,CAACsB,KtB7CkB,mBsB6CMC,QAAS,CAAC4B,OAAQrD,EAAKqD,YAK3DmN,KAAOM,KAAK,eAAgB,KAC1B,CAAC5Q,IAEJ,IAAMkE,EACL,kBAAC,IAAD,CACCsK,QAAS,CACR,CACC3M,MAAO,uCACP4M,WAAW,EACXzI,KAAM,UAEP,CACCnE,MAAO,iCACPmE,KAAM,cACNyI,WAAW,EACXlL,OAAO,WAAD,4BAAE,sBAAA9C,EAAA,sEACD6P,KAAOM,KAAK,gBAAiB,CAAC3H,OAAQ,YADrC,2CAAF,kDAAC,KAKT/D,QAAS,KACRlF,EAAS,CAACsB,KtB3EY,asB2EMC,QAAS,CAACmB,OAAQ,UAG/C,yIACA,gMAIFuC,oBAAU,KACJiM,IACLrJ,EAAW,CACVG,OAAQ,CACP3D,KAAM,IAAIxB,KAAKS,EAAMV,gBAGvBuO,GAAa,KACX,CAACD,EAAWrJ,EAAYvE,EAAMV,cAEjCqC,oBAAU,KACJuC,IACLxH,EAAS,CAACsB,KtBvGgB,esBuGIC,QAAS,CAACW,UAAkB,OAARsF,QAAQ,IAARA,OAAA,EAAAA,EAAUtF,UAAV,OAAqBsF,QAArB,IAAqBA,OAArB,EAAqBA,EAAUtF,SAAW,MAC5FlC,EAAS,CAACsB,KtBvGe,csBuGIC,QAAS,CAACY,SAAiB,OAARqF,QAAQ,IAARA,OAAA,EAAAA,EAAUrF,SAAV,OAAoBqF,QAApB,IAAoBA,OAApB,EAAoBA,EAAUrF,QAAU,QACtF,CAACqF,EAAUxH,IAEdiF,oBAAU,KACRzB,OAAO8N,WAAa,KACnB,IAAIxL,GAAW,IAAIjD,KACfS,EAAMJ,SACTlD,EAAS,CAACsB,KtBvGW,asBuGOC,QAAS,CAACmB,OAAQwB,EAAOA,OAAO,KAExD4B,EAAUsL,EAAiB,KAC9BC,EAAkBvL,GAClB9F,EAAS,CAACsB,KtBxGgB,sBsB0G1BkC,OAAOV,QAAQW,UAAU,KAAM,QAIhC,CAACzD,EAAUsD,EAAMR,QAASQ,EAAMjB,MAAO+O,EAAgB9N,EAAMJ,SAAUgB,IAG3E,IAAMmB,EAAYyC,sBAAY,KAC7BqJ,GAAa,IACX,IAEGI,EAAa,KAClBvR,EAAS,CAACsB,KtBxHmB,kBsBwHIC,QAAS,CAACyC,KAAM,QACjDhE,EAAS,CAACsB,KtB/Ha,YsB+HIC,QAAS,CAACc,MAAO,SAGvCA,EACL,kBAAC,IAAD,CACCmP,YAAalO,EAAMjB,MACnB6C,QAASqM,GAET,kBAAC,IAAD,CAAW/P,GAAI,cAAeyF,OAC7B,kBAAC,IAAD,CACCF,KAAMiK,IAAOS,KAAW,kBAAC,IAAD,CAAmBrQ,QAASmQ,GAAW,kBAAC,KAAD,OAC/DG,MAAO,kBAAC,IAAD,CAAmBtQ,QAASmQ,GAAYP,IAAOW,IAAM,6CAAY,OAFzE,8EAOA,kBAACC,GAAD,CAAY5R,SAAUA,KAGvB,kBAAC,IAAD,CAAWwB,GAAI,YAAayF,OAC3B,kBAAC,IAAD,CACCF,KAAMiK,IAAOS,KAAW,kBAAC,IAAD,CAAmBrQ,QAASmQ,GAAW,kBAAC,KAAD,OAC/DG,MAAO,kBAAC,IAAD,CAAmBtQ,QAASmQ,GAAYP,IAAOW,IAAM,6CAAY,OAEvErO,EAAMX,WAAa,iFAAkB,0FAGvC,kBAACkP,GAAD,CAAU3P,SAAUoB,EAAMpB,SAAUV,GAAE,UAAE8B,EAAMzC,eAAR,aAAE,EAAeM,IAClDwB,WAAYW,EAAMX,WAAY3C,SAAUA,EAAUoC,OAAQkB,EAAMlB,OAAQR,MAAO0B,EAAMb,eAG3F,kBAAC,IAAD,CAAWjB,GAAI,aAAcyF,OAC5B,kBAAC,IAAD,CACCF,KAAMiK,IAAOS,KAAW,kBAAC,IAAD,CAAmBrQ,QAASmQ,GAAW,kBAAC,KAAD,OAC/DG,MAAO,kBAAC,IAAD,CAAmBtQ,QAASmQ,GAAYP,IAAOW,IAAM,6CAAY,OAEvErO,EAAMX,WAAa,iFAAkB,0FAGvC,kBAACmP,GAAD,CAAWnP,WAAYW,EAAMX,WAAY3C,SAAUA,MAKhD+R,EAAiB1Q,IACtBrB,EAAS,CACRsB,KtB1K4B,kBsB2K5BC,QAAS,CAACI,KAAMN,EAAEI,cAAcC,QAAQsQ,MAAOpQ,MAAOP,EAAEI,cAAcC,QAAQE,UAI1EqQ,EACL,kBAAC,IAAD,CAAQC,YAAa,cACpB,kBAAC,IAAD,CACC9Q,QAAS2Q,EACTI,SAA+B,SAArB7O,EAAMd,WAChB4P,aAAY,OACZC,aAAY,OACZC,KAAM,wCAEN,kBAAC,KAAD,OAED,kBAAC,IAAD,CACClR,QAAS2Q,EACTI,SAA+B,SAArB7O,EAAMd,aAAgD,YAAtBc,EAAMb,aAAmD,WAAtBa,EAAMb,aACnF2P,aAAY,OACZC,aAAY,UACZC,KAAM,8CAEN,kBAAC,KAAD,OAED,kBAAC,IAAD,CACClR,QAAS2Q,EACTI,SAA+B,UAArB7O,EAAMd,YAAgD,UAAtBc,EAAMb,YAChD2P,aAAY,QACZC,aAAY,QACZC,KAAM,wCAEN,kBAAC,KAAD,OAED,kBAAC,IAAD,CACClR,QAAS2Q,EACTI,SAA+B,SAArB7O,EAAMd,YAA+C,UAAtBc,EAAMb,YAC/C2P,aAAY,OACZC,aAAY,QACZC,KAAM,sBAEN,kBAAC,KAAD,QAKH,OACC,kBAAC,IAAD,CAAgBnP,OAAQG,EAAMH,QAC7B,kBAAC,IAAD,CAAMoP,YAAajP,EAAMd,WAAYgQ,OAA6B,SAArBlP,EAAMd,YAA+C,SAAtBc,EAAMb,aAA0BwP,GAC3G,kBAAC,IAAD,CAAMzQ,GAAI,OAAQiB,YAAaa,EAAMb,aACpC,kBAACgQ,GAAD,CAAejR,GAAI,OAAQxB,SAAUA,EAAU0P,QAASpM,EAAMZ,UAE/D,kBAAC,IAAD,CAAMlB,GAAI,OAAQiB,YAAaa,EAAMb,YAAaC,OAAQY,EAAMZ,OAAQL,MAAOA,GAC9E,kBAAC,EAAD,CAAMb,GAAG,OAAOU,SAAUoB,EAAMpB,SAAUC,QAASmB,EAAMnB,QAASnC,SAAUA,EAAUsH,UAAWA,EAC9FjC,UAAWA,EAAWoB,WAAYa,KAEtC,kBAAC,IAAD,CAAM9F,GAAI,OAAQiB,YAAaa,EAAMb,YAAaC,OAAQY,EAAMZ,OAAQL,MAAOA,GAC9E,kBAACqQ,GAAD,CAAalR,GAAI,UAAWX,QAASyC,EAAMpB,SAAS6B,KAAKC,IAAI,aAAIA,EAAK7C,OAAL,UAAamC,EAAMzC,eAAnB,aAAa,EAAeM,OACtFnB,SAAUA,EAAUqF,UAAWA,EAAWlB,QAASb,EAAML,iBAChE,kBAAC0P,GAAD,CAASnR,GAAI,UAAWW,QAASmB,EAAMnB,QAASnC,SAAUA,EAAUqF,UAAWA,EAC1EhB,KAAMf,EAAMV,cACjB,kBAACgQ,GAAD,CAAYpR,GAAI,SAAUY,OAAQkB,EAAMnB,QAAQ4B,KAAKC,IAAI,aAAIA,EAAK7C,OAAL,UAAamC,EAAMlB,cAAnB,aAAa,EAAcjB,OAClFnB,SAAUA,EAAUmE,QAASb,EAAML,kBAE1C,kBAAC,IAAD,CAAMzB,GAAI,QAASiB,YAAaa,EAAMb,YAAaC,OAAQY,EAAMZ,OAAQL,MAAOA,GAC/E,kBAACwQ,GAAD,CAAOrR,GAAI,QAASU,SAAUoB,EAAMpB,SAAUmD,UAAWA,EAAWrF,SAAUA,KAE/E,kBAAC,IAAD,CAAMwB,GAAI,OAAQiB,YAAaa,EAAMb,YAAaC,OAAQY,EAAMZ,OAAQL,MAAOA,GAC9E,kBAACyQ,GAAD,CAAMtR,GAAI,cC5OfuR,IAASC,OACP,kBAACxO,EAAD,KACE,kBAAC,GAAD,OACgByO,SAASC,eAAe,SACxC,IAAIpD,IAAItM,OAAOgF,SAASuH,MAAMC,aAAaC,IAAI,gBAAkB7H,UAAyB+K,YAC5F,oDAAkBxK,KAAK,U","file":"static/js/main.55cf4981.chunk.js","sourcesContent":["export default (number) => {\r\n\treturn new Intl.NumberFormat('ru-RU', {style: 'currency', currency: 'RUB'}).format(number);\r\n}","import React, {useState} from 'react';\r\nimport Cell from \"@vkontakte/vkui/dist/components/Cell/Cell\";\r\nimport {Footer, Text} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport {SET_ACCOUNT, SET_ACTIVE_VIEW, SET_BUDGET} from \"../state/actions\";\r\n\r\nexport default ({data, showAll = false, dispatch, itemsName, needHide = true}) => {\r\n\tconst [isShow, setIsShow] = useState(() => {\r\n\t\treturn showAll;\r\n\t});\r\n\r\n\tif (data.length === 0) {\r\n\t\tif (itemsName === 'accounts') {\r\n\t\t\treturn <Footer>Нет счетов для отображения</Footer>\r\n\t\t}\r\n\t\tif (itemsName === 'budgets') {\r\n\t\t\treturn <Footer>Нет бюджетов для отображения</Footer>\r\n\t\t}\r\n\t}\r\n\r\n\tlet list = data\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn b.sum - a.sum;\r\n\t\t})\r\n\t\t.map((account, index) => {\r\n\t\t\tif (index === 3 && !isShow) {\r\n\t\t\t\treturn <Cell\r\n\t\t\t\t\tkey={'showAll'}\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetIsShow(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t\t\tПоказать все\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t</Cell>\r\n\t\t\t}\r\n\t\t\tif (index > 3 && !isShow) {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t\treturn <Cell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tindicator={currency(account.sum)}\r\n\t\t\t\texpandable\r\n\t\t\t\tdata-id={account._id}\r\n\t\t\t\tonClick={async (e) => {\r\n\t\t\t\t\tif (itemsName === 'accounts') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACCOUNT, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'account'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (itemsName === 'budgets') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_BUDGET, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'budget'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{account.title}\r\n\t\t\t</Cell>\r\n\t\t});\r\n\tif (needHide) {\r\n\t\tif (isShow) list.push(<Cell\r\n\t\t\tkey={data.length}\r\n\t\t\texpandable\r\n\t\t\tonClick={() => {\r\n\t\t\t\tsetIsShow(false);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t{itemsName === 'accounts' ? 'Скрыть счета' : 'Скрыть бюджеты'}\r\n\t\t\t</Text>\r\n\t\t</Cell>);\r\n\t}\r\n\r\n\r\n\treturn list;\r\n}","export const SET_ACCOUNTS = 'SET_ACCOUNTS';\r\nexport const SET_BUDGETS = 'SET_BUDGETS';\r\nexport const SET_BUDGET = 'SET_BUDGET';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_SUCCESS_MESSAGE = 'SET_SUCCESS_MESSAGE';\r\nexport const SET_ACTIVE_VIEW = 'SET_ACTIVE_VIEW';\r\nexport const SET_ACCOUNT = 'SET_ACCOUNT';\r\nexport const SET_POPOUT = 'SET_POPOUT';\r\nexport const SET_EDITED_ITEM = 'SET_EDITED_ITEM';\r\nexport const SET_DATE = 'SET_DATE';\r\nexport const SET_HISTORY_BACK = 'SET_HISTORY_BACK';\r\nexport const SET_COLOR_SCHEME = 'SET_COLOR_SCHEME';\r\nexport const SET_TOGGLE_CONTEXT = 'SET_TOGGLE_CONTEXT';","import React, {createContext, useReducer} from 'react';\r\nimport {\r\n\tSET_ACCOUNT,\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_VIEW,\r\n\tSET_BUDGET,\r\n\tSET_BUDGETS,\r\n\tSET_DATE,\r\n\tSET_EDITED_ITEM,\r\n\tSET_ERROR,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_SUCCESS_MESSAGE,\r\n\tSET_COLOR_SCHEME, SET_TOGGLE_CONTEXT\r\n} from './actions';\r\n\r\nconst initialState = {\r\n\taccounts: [],\r\n\tbudgets: [],\r\n\taccount: null,\r\n\tbudget: null,\r\n\tmodal: null,\r\n\tsuccessMessage: null,\r\n\terror: null,\r\n\tactiveView: 'init',\r\n\tactivePanel: 'init',\r\n\tpopout: null,\r\n\teditedItem: null,\r\n\tcurrentDate: new Date(),\r\n\thistory: [],\r\n\tmodalsHistory: [],\r\n\tpopoutHistory: [],\r\n\tcontextHistory: false,\r\n\tcanClose: true,\r\n\tscheme: 'client_light',\r\n\tmodalOpenTime: +new Date(),\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_COLOR_SCHEME: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tscheme: action.payload.scheme\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACTIVE_VIEW: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\r\n\t\t\tlet history = state.history;\r\n\t\t\tif (history.length !== 0) {\r\n\t\t\t\tlet lastHistoryState = history[history.length - 1];\r\n\t\t\t\tif (lastHistoryState.view === action.payload.view && lastHistoryState.panel === action.payload.panel) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state,\r\n\t\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\t\tcanClose: false,\r\n\t\t\t\t\t\tcontextHistory: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\tcanClose: true,\r\n\t\t\t\t\tcontextHistory: false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_HISTORY_BACK: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\t\t\tconst backEl = state.history[state.history.length - 2];\r\n\t\t\tlet popoutHistory = state.popoutHistory || [];\r\n\t\t\tlet modalsHistory = state.modalsHistory || [];\r\n\t\t\tlet contextHistory = state.contextHistory || false;\r\n\r\n\t\t\tif (popoutHistory.length !== 0) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tpopout: null,\r\n\t\t\t\t\tpopoutHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!!contextHistory) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tcontextHistory: false,\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (modalsHistory.length !== 0) {\r\n\t\t\t\tif (+new Date() - state.modalOpenTime < 700) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tmodal: null,\r\n\t\t\t\t\tmodalsHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!backEl) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: 'home',\r\n\t\t\t\t\tactivePanel: 'home',\r\n\t\t\t\t\thistory: [],\r\n\t\t\t\t\tcanClose: true,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst canClose = (backEl.view === 'home' && backEl.panel === 'home');\r\n\t\t\t\tconst newHistory = state.history;\r\n\t\t\t\tnewHistory.pop();\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: backEl.view,\r\n\t\t\t\t\tactivePanel: backEl.panel,\r\n\t\t\t\t\thistory: [...newHistory],\r\n\t\t\t\t\teditedItem: null,\r\n\t\t\t\t\tcanClose: canClose\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tcase SET_ACCOUNTS: {\r\n\t\t\tconst accountId = state.account?._id;\r\n\t\t\tconst account = !accountId ? accountId : action.payload.accounts.find(item => {\r\n\t\t\t\treturn item._id === accountId;\r\n\t\t\t})\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccounts: action.payload.accounts,\r\n\t\t\t\taccount: account\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGETS: {\r\n\t\t\tconst budgetId = state.budget?._id;\r\n\t\t\tconst budget = !budgetId ? budgetId : action.payload.budgets.find(item => item._id === budgetId)\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudgets: action.payload.budgets,\r\n\t\t\t\tbudget: budget\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACCOUNT: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccount: state.accounts.find(item => {\r\n\t\t\t\t\treturn item._id === id;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGET: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudget: !id ? id : state.budgets.find(item => item._id === id)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_EDITED_ITEM: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\teditedItem: action.payload.item\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_POPOUT: {\r\n\t\t\tif (action.payload.alert) {\r\n\t\t\t\twindow.history.pushState(null, null);\r\n\t\t\t}\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.popout) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.popout;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.popout) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout,\r\n\t\t\t\tpopoutHistory: action.payload.popout ? [action.payload.popout] : [],\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_MODAL: {\r\n\t\t\t// window.history.pushState(null, null);\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.modal) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.modal;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.modal) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tmodal: action.payload.modal,\r\n\t\t\t\tmodalsHistory: action.payload.modal ? [action.payload.modal] : [],\r\n\t\t\t\tcanClose: canClose,\r\n\t\t\t\tmodalOpenTime: +new Date()\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_TOGGLE_CONTEXT: {\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.context) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.context;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.context) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t// modal: action.payload.modal,\r\n\t\t\t\tcontextHistory: action.payload.context,\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_SUCCESS_MESSAGE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsuccessMessage: action.payload.message\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ERROR: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_DATE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tcurrentDate: new Date(action.payload.date)\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\nimport Icon24CheckCircleOn from '@vkontakte/icons/dist/24/check_circle_on';\r\n\r\nconst InfoSnackbar = () => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.successMessage) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24CheckCircleOn style={{color: 'var(--accent)'}}/>}\r\n\t\t>\r\n\t\t\t{state.successMessage}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.successMessage]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;","import React, {useContext, useState} from 'react';\r\nimport {addMonths, format, subMonths, isAfter, isBefore} from 'date-fns';\r\nimport {ru} from 'date-fns/locale';\r\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\r\nimport Icon24BrowserForward from '@vkontakte/icons/dist/24/browser_forward';\r\nimport {State} from \"../state\";\r\nimport {Button, Cell, Group} from \"@vkontakte/vkui\";\r\n\r\nexport default ({onRefresh}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst dateFormat = 'LLLL yyyy';\r\n\tconst disabledAfter = isAfter(addMonths(state.currentDate, 1), new Date());\r\n\tconst disabledBefore = isBefore(new Date(state.currentDate), new Date(2015, 0, 1));\r\n\tconst [clickTime, setClickTime] = useState(0);\r\n\t\r\n\tconst nextMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (addMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\tconst prevMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (subMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Group>\r\n\t\t\t<Cell\r\n\t\t\t\tbefore={<Button disabled={disabledBefore} onClick={prevMonth} mode={'secondary'}><Icon24BrowserBack/></Button>}\r\n\t\t\t\tasideContent={<Button disabled={disabledAfter} onClick={nextMonth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmode={'secondary'}><Icon24BrowserForward/></Button>}\r\n\t\t\t\tstyle={{textAlign: 'center', fontWeight: 'bold'}}\r\n\t\t\t>\r\n\t\t\t\t<div style={{cursor: 'auto'}}>\r\n\t\t\t\t\t{format(state.currentDate, dateFormat, {locale: ru}).toLocaleUpperCase()}\r\n\t\t\t\t</div>\r\n\t\t\t</Cell>\r\n\t\t</Group>\r\n\t)\r\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport {Header, List, PanelHeaderButton, PullToRefresh, Title} from \"@vkontakte/vkui\";\nimport currency from \"../handlers/currency\";\nimport ListOfItems from \"../components/ListOfItems\";\nimport {SET_ACCOUNT, SET_MODAL} from \"../state/actions\";\nimport Icon28MarketAddBadgeOutline from '@vkontakte/icons/dist/28/market_add_badge_outline';\nimport Icon28ListAddOutline from '@vkontakte/icons/dist/28/list_add_outline';\nimport InfoSnackbar from \"../components/InfoSnackbar\";\nimport MonthSwitch from \"../components/MonthSwitch\";\n\nconst Home = ({id, accounts, budgets, dispatch, onRefresh, isFetching}) => {\n\tconst sumOfAll = accounts.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader\n\t\t\t\tleft={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28ListAddOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>\n\t\t\t\t\t\t{accounts.length !== 0 && <PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_ACCOUNT, payload: {id: null}});\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>}\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t>Баланс</PanelHeader>\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\n\t\t\t<PullToRefresh onRefresh={onRefresh} isFetching={isFetching}>\n\t\t\t\t<List>\n\t\t\t\t\t<Group\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Ваши счета</Header>}\n\t\t\t\t\t\tseparator=\"show\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(sumOfAll)}</Title>\n\t\t\t\t\t\t\t<ListOfItems data={accounts} dispatch={dispatch} showAll={false} itemsName={'accounts'}/>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Group>\n\t\t\t\t\t<Group\n\t\t\t\t\t\theader={<Header mode={'secondary'}>Ваши бюджеты</Header>}\n\t\t\t\t\t\t// separator={'show'}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={false} itemsName={'budgets'}/>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Group>\n\t\t\t\t</List>\n\t\t\t</PullToRefresh>\n\t\t\t<InfoSnackbar/>\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Home;\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {SET_ERROR, SET_MODAL, SET_POPOUT, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport {State} from \"../state\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = process.env.NODE_ENV !== 'development' ? process.env.REACT_APP_BASEURL : process.env.REACT_APP_BASEURL_DEV;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}});\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search)} : {...queryString.parse(window.location.search)},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (!isLoading) return;\r\n\r\n\t\tconst fetchData = async () => {\r\n\t\t\tsetLoading(false);\r\n\t\t\treturn await axios(axiosOptions)\r\n\t\t\t\t.then(async (response) => {\r\n\t\t\t\t\tsetResponse(response.data.data);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: response.data.message}});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tlet e = error?.response ? error.response.data.error : new Error('Проблемы с подключением к API');\r\n\t\t\t\t\tsetError(e);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: e}});\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","export default (e) => {\r\n\tconst validity = e.currentTarget.validity;\r\n\tif (validity.valid && e.currentTarget.value !== ' ') {\r\n\t\treturn {status: 'valid', message: null}\r\n\t} else {\r\n\t\tif (validity.badInput || validity.valueMissing || e.currentTarget.value === ' ') {\r\n\t\t\treturn {status: 'error', message: 'Неверный формат ввода | Отсутствует значение'}\r\n\t\t}\r\n\t\tif (validity.tooLong) {\r\n\t\t\treturn {status: 'error', message: 'Превышена максимальная длина'}\r\n\t\t}\r\n\t\tif (validity.typeMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Несоответствие типа'}\r\n\t\t}\r\n\t\tif (validity.stepMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Слишком большая дробная часть'}\r\n\t\t}\r\n\t\tif (validity.rangeOverflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести будущую дату'}\r\n\t\t\treturn {status: 'error', message: 'Слишком большое число'}\r\n\t\t}\r\n\t\tif (validity.rangeUnderflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести дату раньше 1 января 2015'}\r\n\t\t\treturn {status: 'error', message: 'Нельзя вводить отрицательные числа'}\r\n\t\t}\r\n\r\n\t\treturn {status: 'default', message: null}\r\n\t}\r\n}","// const ranges = [\r\n// \t'\\ud83c[\\udf00-\\udfff]', // U+1F300 to U+1F3FF\r\n// \t'\\ud83d[\\udc00-\\ude4f]', // U+1F400 to U+1F64F\r\n// \t'\\ud83d[\\ude80-\\udeff]'  // U+1F680 to U+1F6FF\r\n// ]\r\n//\r\n// const regexp = new RegExp(ranges.join('|'), 'g');\r\nexport default (str) => {\r\n\treturn str.replace(/^\\s*/g, '').replace(/\\s{2,}/g, ' ').replace(/<% RGI_Emoji %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu, '');\r\n}","import React, {useEffect, useReducer} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tsum: '',\r\n\ttitleValidation: {},\r\n\tsumValidation: {}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload} = action;\r\n\t\t\t// if (payload.title === ' ' && state.title === '') {\r\n\t\t\t// \tconsole.log(payload.title);\r\n\t\t\t// \treturn {\r\n\t\t\t// \t\t...state,\r\n\t\t\t// \t\ttitle: payload.title,\r\n\t\t\t// \t\ttitleValidation: payload.titleValidation\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({onRefresh, dispatch}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [{response}, doApiFetch] = useApi('/money-box');\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.sum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Карта, наличные, счет в банке'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.titleValidation.status}\r\n\t\t\t\t\t\t bottom={stateForm.titleValidation.message ? stateForm.titleValidation.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {title: regexp(e.currentTarget.value), titleValidation: validate(e)}})}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Баланс счета'} value={stateForm.sum}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.sumValidation.status}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.sumValidation.message ? stateForm.sumValidation.message : 'Денежные средства, находящиеся на счете в данный момент'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {sum: e.currentTarget.value.replace(/[^\\d.]*/, ''), sumValidation: validate(e)}})}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {format} from 'date-fns';\r\nimport {Button, Checkbox, Counter, Div, FormLayout, Input, Radio, Select, Textarea} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n\taccount: '',\r\n\ttitle: '',\r\n\tdate: format(new Date(), 'yyyy-MM-dd'),\r\n\tincome: false,\r\n\tdescription: '',\r\n\tprice: '',\r\n\tquantity: '',\r\n\ttags: [],\r\n\tboxPrice: false,\r\n\tvalidate: {\r\n\t\taccount: {},\r\n\t\ttitle: {},\r\n\t\tdescription: {},\r\n\t\tprice: {},\r\n\t\tquantity: {},\r\n\t\ttags: {},\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({accounts, id = null, editedItem = null, dispatch, budget, panel=''}) => {\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/item' : `/item/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\tconst [state, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst accountList = accounts.map(item => {\r\n\t\treturn (<option key={item._id} value={item._id}>{item.title} ({currency(item.sum)})</option>)\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\teditedItem.date = format(new Date(editedItem.date), 'yyyy-MM-dd');\r\n\t\tdispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!budget?.title) return;\r\n\t\tif (panel === 'home') return;\r\n\t\tdispatchForm({\r\n\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\tpayload: {\r\n\t\t\t\ttags: editedItem?.tags || budget?.title.toLowerCase().split(' ')\r\n\t\t\t}\r\n\t\t})\r\n\t}, [budget, dispatch, panel, editedItem]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tconst tags = state.tags.filter(tag => !!tag.length).map(\r\n\t\t(tag, index) =>\r\n\t\t\t<Counter\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tmarginRight: '5px',\r\n\t\t\t\t\tmarginBottom: '5px',\r\n\t\t\t\t\tmaxWidth: '100%',\r\n\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\toverflowWrap: 'normal'\r\n\t\t\t\t}}\r\n\t\t\t\tkey={index}\r\n\t\t\t>\r\n\t\t\t\t{tag}\r\n\t\t\t</Counter>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tdoApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\tdate: state.date,\r\n\t\t\t\t\ttitle: state.title,\r\n\t\t\t\t\tdescription: state.description,\r\n\t\t\t\t\tprice: state.boxPrice ? (state.price / state.quantity).toFixed(4) : state.price,\r\n\t\t\t\t\tquantity: state.quantity,\r\n\t\t\t\t\tincome: state.income,\r\n\t\t\t\t\ttags: state.tags.filter(tag => !!tag.length),\r\n\t\t\t\t\titemFrom: state.account || editedItem?.itemFrom || id\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Select top={'Счет'}\r\n\t\t\t\t\t\t\tplaceholder={'Выберите счет'}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tdispatchForm({\r\n\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\tpayload: {account: e.currentTarget.value, validateForm: {account: validate(e)}}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdefaultValue={state.account || editedItem?.itemFrom || id} required={true}\r\n\t\t\t\t\t\t\tstatus={state.validate?.account?.status}\r\n\t\t\t\t\t\t\tbottom={state.validate?.account?.message}\r\n\t\t\t>\r\n\t\t\t\t{accountList}\r\n\t\t\t</Select>\r\n\t\t\t<Input type={'date'}\r\n\t\t\t\t\t\t top={'Дата'}\r\n\t\t\t\t\t\t value={state.date}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t min={'2015-01-01'}\r\n\t\t\t\t\t\t max={format(new Date(), 'yyyy-MM-dd')}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {date: e.currentTarget.value, validateForm: {date: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t\t\t\t status={state.validate?.date?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.date?.message}\r\n\t\t\t/>\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t placeholder={'Продукт, услуга, товар'}\r\n\t\t\t\t\t\t value={state.title}\r\n\t\t\t\t\t\t top={'Название'}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={20}\r\n\t\t\t\t\t\t status={state.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t title: regexp(e.currentTarget.value),\r\n\t\t\t\t\t\t\t\t\t validateForm: {title: validate(e)}\r\n\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}/>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={false}\r\n\t\t\t\t\t\t defaultChecked={state.income ? null : true}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatchForm({type: 'CHANGE_STATE', payload: {income: false}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tРасход\r\n\t\t\t</Radio>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={true}\r\n\t\t\t\t\t\t defaultChecked={state.income ? true : null}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatchForm({type: 'CHANGE_STATE', payload: {income: true}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tДоход\r\n\t\t\t</Radio>\r\n\t\t\t{\r\n\t\t\t\t!state.income\r\n\t\t\t\t&&\r\n\t\t\t\t<Textarea top={'Описание'}\r\n\t\t\t\t\t\t\t\t\tplaceholder={'Описание товара(продукта, услуги)'}\r\n\t\t\t\t\t\t\t\t\tvalue={state.description}\r\n\t\t\t\t\t\t\t\t\tmaxLength={70}\r\n\t\t\t\t\t\t\t\t\tstatus={state.validate?.description?.status}\r\n\t\t\t\t\t\t\t\t\tbottom={state.validate?.description?.message ? state.validate?.description?.message : `${state.description.length} из 70`}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tdispatchForm({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: regexp(e.currentTarget.value),\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalidateForm: {description: validate(e)}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t top={'Теги'}\r\n\t\t\t\t\t\t value={state.tags.join(' ')}\r\n\t\t\t\t\t\t placeholder={'Теги через пробел'}\r\n\t\t\t\t\t\t status={state.validate?.tags?.status}\r\n\t\t\t\t\t\t maxLength={100}\r\n\t\t\t\t\t\t bottom={state.validate?.tags?.message ? state.validate?.tags?.message : `${state.tags.join(' ').length} из 100 символов`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t tags: e.currentTarget.value !== '' ? regexp(e.currentTarget.value).toLowerCase().split(' ') : [],\r\n\t\t\t\t\t\t\t\t\t validateForm: {tags: validate(e)}\r\n\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\t!!tags.length &&\r\n\t\t\t\tstate.tags.length !== 0\r\n\t\t\t\t&&\r\n\t\t\t\t<Div style={{display: 'flex', flexWrap: 'wrap'}}>\r\n\t\t\t\t\t{tags}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={currency(0)}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t top={'Цена'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={99999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.0001}\r\n\t\t\t\t\t\t status={state.validate?.price?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.price?.message}\r\n\t\t\t\t\t\t value={state.price}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {price: e.currentTarget.value.replace(/[^\\d.]*/, ''), validateForm: {price: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\t!state.income\r\n\t\t\t\t&&\r\n\t\t\t\t<Checkbox value={state.boxPrice}\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tdispatchForm({type: 'CHANGE_STATE', payload: {boxPrice: !state.boxPrice}})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tЦена за упаковку\r\n\t\t\t\t</Checkbox>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={'0'}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t top={'Кол-во'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={9999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.001}\r\n\t\t\t\t\t\t status={state.validate?.quantity?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.quantity?.message}\r\n\t\t\t\t\t\t value={state.quantity}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {quantity: e.currentTarget.value.replace(/[^\\d.]*/, ''), validateForm: {quantity: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Button size={'xl'}>\r\n\t\t\t\t{`Сохранить ${state.boxPrice ? currency(state.price) : currency(state.price * state.quantity)}`}\r\n\t\t\t</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React from 'react';\r\nimport {Caption, RichCell} from \"@vkontakte/vkui\";\r\nimport {format} from \"date-fns\";\r\nimport ruLocale from \"date-fns/locale/ru\";\r\nimport currency from \"./currency\";\r\nimport {SET_EDITED_ITEM, SET_MODAL} from \"../state/actions\";\r\n\r\nexport default function mapRichCell(dispatch) {\r\n\treturn (item, index) => {\r\n\t\tif (item?.titleDate) {\r\n\t\t\treturn (\r\n\t\t\t\t<Caption level=\"2\" weight=\"semibold\" caps\r\n\t\t\t\t\t\t\t\t key={index}>{format(new Date(item?.titleDate), 'dd MMMM yyyy', {locale: ruLocale})}</Caption>\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={format(new Date(item?.date), 'dd MMMM yyyy', {locale: ruLocale})}\r\n\t\t\t\tafter={item?.income ? currency(item?.sum) : currency(-1 * item?.sum)}\r\n\t\t\t\tdata-id={item?._id}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: item}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t};\r\n}","import compareAsc from \"date-fns/compareAsc\";\r\n\r\nexport default function (a, b){\r\n\tconst aDate = new Date(a.date);\r\n\tconst bDate = new Date(b.date);\r\n\treturn compareAsc(bDate, aDate);\r\n}","import isEqual from \"date-fns/isEqual\";\r\n\r\nexport default function (prev, curr) {\r\n\tif (isEqual(new Date(prev[prev.length-1]?.date), new Date(curr.date))) {\r\n\t\treturn [...prev, curr];\r\n\t} else {\r\n\t\treturn [...prev, {titleDate: curr.date}, curr];\r\n\t}\r\n}","import React, {useRef} from 'react';\r\nimport {FormLayout, Search} from \"@vkontakte/vkui\";\r\n\r\nexport default ({onSearch}) => {\r\n\r\n\tconst searchRef = useRef(null);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={(e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsearchRef.current.focus();\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Search\r\n\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\tonSearch(e.currentTarget.value)\r\n\t\t\t\t}}/>\r\n\t\t</FormLayout>\r\n\t\t<input type={'radio'} style={{position: 'absolute', height: '0', width: '0', top: '0', left: '0'}} ref={searchRef}/>\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport useApi from \"../handlers/useApi\";\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tHeader,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tTitle\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport Group from \"@vkontakte/vkui/dist/components/Group/Group\";\r\nimport {\r\n\tSET_ACCOUNTS, SET_BUDGETS,\r\n\tSET_EDITED_ITEM,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_TOGGLE_CONTEXT\r\n} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\r\n\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport reduce from \"../handlers/reduce\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport SearchForm from \"../components/SearchForm\";\r\n\r\nexport default ({id, account, dispatch, onRefresh, context}) => {\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [{response}, doApiFetch] = useApi(`/money-box/${account?._id}`);\r\n\tconst [items, setItems] = useState(() => {\r\n\t\tif (!account) return [];\r\n\t\treturn account?.operations;\r\n\t});\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items || []);\r\n\r\n\tconst accountItemsList = filteredItems.sort(sort).reduce(reduce, []).map(mapRichCell(dispatch));\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить счет?</h2>\r\n\t\t\t<p>Удаление счета приведет к удалению всех данных по доходам и расходам, привязанным к данному счету. Суммы\r\n\t\t\t\tбюджетов могут отображаться некорректно.</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!account) return;\r\n\t\tsetItems(account?.operations);\r\n\t\tsetFilteredItems(account?.operations);\r\n\t}, [account]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [dispatch, response]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t}, [context]);\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(account?.operations.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK})\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={account && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{account ? account?.title : 'Счет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\taccount\r\n\t\t\t\t&&\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert, alert: true}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tУдалить счет {account?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</PanelHeaderContext>\r\n\t\t\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\r\n\t\t\t\t\t<SearchForm onSearch={onSearch}/>\r\n\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Информация по счету</Header>}\r\n\t\t\t\t\t\tseparator=\"show\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(account?.sum)}</Title>\r\n\t\t\t\t\t\t</Div>\r\n\r\n\t\t\t\t\t\t{account?.operations.length === 0 && <Footer>Операций по счету еще не было</Footer>}\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t{accountItemsList}\r\n\t\t\t\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {format} from 'date-fns';\r\nimport ruLocale from 'date-fns/locale/ru';\r\nimport {Footer, Group, Header, Panel, PanelHeader, PanelHeaderButton} from \"@vkontakte/vkui\";\r\nimport ListOfItems from \"../components/ListOfItems\";\r\nimport {SET_MODAL} from \"../state/actions\";\r\nimport Icon28ListAddOutline from \"@vkontakte/icons/dist/28/list_add_outline\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\n\r\nexport default ({id, budgets, dispatch, date = new Date(), onRefresh}) => {\r\n\t// let budgetsStartSum = budgets.map(el => el.startSum).reduce((acc, cur) => acc + cur, 0);\r\n\t// let incomeBudgetSum = budgets.map(el => el.items).flat().map(item => item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0);\r\n\t// let outcomeBudgetsSum = budgets.map(el => el.items).flat().map(item => !item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<PanelHeaderButton onClick={() => dispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})}>\r\n\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tБюджеты\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\r\n\t\t\t<Group\r\n\t\t\t\theader={<Header mode=\"secondary\">Ваши бюджеты\r\n\t\t\t\t\tна {format(new Date(date), 'dd MMMM yyyy', {locale: ruLocale})}</Header>}\r\n\t\t\t\t// separator=\"show\"\r\n\t\t\t>\r\n\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={true} itemsName={'budgets'} needHide={false}/>\r\n\t\t\t\t<Footer>Цифры напротив бюджета отображают сколько Вы можете еще потратить, но помните, что могут быть смежные траты, которые относятся к нескольким бюджетам. Проверяйте внимательно.</Footer>\r\n\t\t\t</Group>\r\n\t\t\t<InfoSnackbar/>\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport currency from \"../../handlers/currency\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tstartSum: '',\r\n\tvalidate: {\r\n\t\ttitle: {},\r\n\t\tstartSum: {}\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({dispatch, editedItem = null}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/budget' : `/budget/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\tif (!response) dispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatchForm, response]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.startSum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Название бюджета'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.title?.message ? stateForm.validate?.title?.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {title: regexp(e.currentTarget.value), validateForm: {title: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Бюджет в рублях'} value={stateForm.startSum}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.validate?.startSum?.status}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.startSum?.message ? stateForm.validate?.startSum?.message : 'Сколько вы готовы на это потратить?'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {startSum: e.currentTarget.value, validateForm: {startSum: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tGroup,\r\n\tList,\r\n\tMiniInfoCell,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext\r\n} from \"@vkontakte/vkui\";\r\nimport {\r\n\tSET_ACCOUNTS, SET_BUDGETS,\r\n\tSET_EDITED_ITEM,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_TOGGLE_CONTEXT\r\n} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport useApi from \"../handlers/useApi\";\r\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport Icon28EditOutline from '@vkontakte/icons/dist/28/edit_outline';\r\nimport Icon20PinOutline from '@vkontakte/icons/dist/20/pin_outline';\r\nimport Icon20Add from '@vkontakte/icons/dist/20/add';\r\nimport Icon20BombOutline from '@vkontakte/icons/dist/20/bomb_outline';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport reduce from \"../handlers/reduce\";\r\nimport currency from \"../handlers/currency\";\r\nimport SearchForm from \"../components/SearchForm\";\r\n\r\nexport default ({id, budget, dispatch, context}) => {\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [{response}, doApiFetch] = useApi(`/budget/${budget?._id}`);\r\n\tconst [items, setItems] = useState(() => budget?.items);\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetItems(budget?.items);\r\n\t\tsetFilteredItems(budget?.items);\r\n\t}, [budget])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tif (response?.deletedCount) {\r\n\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t}\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t},[context]);\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\r\n\tconst alertDelete = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить бюджет?</h2>\r\n\t\t\t<p>Вы действительно хотите удалить бюджет?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tconst itemsList = filteredItems && filteredItems.sort(sort).reduce(reduce, []).map(mapRichCell(dispatch));\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(budget.items.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={budget && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{budget ? budget?.title : 'Бюджет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\tbudget &&\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28EditOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: budget}})\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})\r\n\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tИзменить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alertDelete, alert: true}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tУдалить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</PanelHeaderContext>\r\n\t\t\t\t\t<SearchForm onSearch={onSearch}/>\r\n\t\t\t\t\t<Group>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20PinOutline/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПервоначальная сумма {currency(budget.startSum)}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20Add/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tДобавлено в\r\n\t\t\t\t\t\t\tбюджет {currency(budget.items.map(item => item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0))}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20BombOutline/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПотрачено {currency(budget.items.map(item => !item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0))}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t{itemsList}\r\n\t\t\t\t\t\t{itemsList?.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {Footer, Group, Panel, PanelHeader} from \"@vkontakte/vkui\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport mapStats from \"../handlers/mapStats\";\r\nimport SearchForm from \"../components/SearchForm\";\r\n\r\nexport default ({id, accounts, onRefresh}) => {\r\n\tconst [operations, setOperations] = useState(() => {\r\n\t\treturn accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t});\r\n\tconst [filteredItems, setFilteredItems] = useState(() => operations);\r\n\tconst reducer = (prev, curr) => {\r\n\t\tif (prev[prev.length - 1]?.title === curr.title) {\r\n\t\t\tconst prevItem = prev[prev.length - 1];\r\n\t\t\tprevItem.sum = prevItem.sum + curr.sum;\r\n\t\t\tprevItem.quantity += curr.quantity;\r\n\t\t\tconst array = [...prev.slice(0, prev.length - 1), prevItem];\r\n\t\t\treturn [...array];\r\n\t\t} else {\r\n\t\t\treturn [...prev, {title: curr.title, sum: curr.sum, quantity: curr.quantity}];\r\n\t\t}\r\n\t}\r\n\r\n\tconst accountItemsList = filteredItems\r\n\t\t.reduce(reducer, [])\r\n\t\t.map(mapStats());\r\n\r\n\tuseEffect(() => {\r\n\t\tconst items = accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title));\r\n\t\tsetOperations(items);\r\n\t\tsetFilteredItems(items);\r\n\t}, [accounts])\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tif (str === '') {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t\t.filter(({title}) => title.toLowerCase().indexOf(str.toLowerCase()) > -1));\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>\r\n\t\t\t\tСводка\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\t\t\t<SearchForm onSearch={onSearch}/>\r\n\t\t\t<Group>\r\n\t\t\t\t{accountItemsList}\r\n\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {RichCell} from \"@vkontakte/vkui\";\r\nimport currency from \"./currency\";\r\n\r\nexport default () => {\r\n\treturn (item, index) => {\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={`Кол-во: ${item?.quantity} | Ср. цена ${currency(item?.sum/item?.quantity)}`}\r\n\t\t\t\tafter={currency(item?.sum)}\r\n\t\t\t\tdata-title={item?.title}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t}\r\n}","import React from 'react';\r\nimport {Button, Panel, Placeholder, Spinner} from \"@vkontakte/vkui\";\r\nimport {SET_ACTIVE_VIEW} from \"../state/actions\";\r\nimport Icon36Done from '@vkontakte/icons/dist/36/done';\r\n\r\nexport default ({id, dispatch, loading}) => {\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={loading ? <Spinner size=\"large\"/> : <Icon36Done/>}\r\n\t\t\t\taction={\r\n\t\t\t\t\t!loading && <Button\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tid={'initial-button'}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tЗапустить\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t}\r\n\t\t\t\tstretched\r\n\t\t\t>\r\n\t\t\t\t{loading ? 'Подготавливаем приложение к запуску' : 'Приложение готово'}\r\n\t\t\t</Placeholder>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport {Cell, Group, Header, Panel, PanelHeader} from \"@vkontakte/vkui\";\r\nimport Icon28ShareExternalOutline from '@vkontakte/icons/dist/28/share_external_outline';\r\nimport Icon28Users3Outline from '@vkontakte/icons/dist/28/users_3_outline';\r\nimport Icon28AddCircleOutline from '@vkontakte/icons/dist/28/add_circle_outline';\r\nimport Icon28ListCheckOutline from '@vkontakte/icons/dist/28/list_check_outline';\r\n\r\nexport default ({id}) => {\r\n\tconst userId = new URL(window.location.href).searchParams.get('vk_user_id');\r\n\tconst [addToHomeScreenSupported, setAddToHomeScreenSupported] = useState(false);\r\n\tconst [addedToHomeScreen, setAddedToHomeScreen] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tbridge.subscribe(({detail: {type, data}}) => {\r\n\t\t\tif (type === 'VKWebAppAddToHomeScreenInfoResult') {\r\n\t\t\t\tsetAddToHomeScreenSupported(data.is_feature_supported);\r\n\t\t\t\tsetAddedToHomeScreen(data.is_added_to_home_screen);\r\n\t\t\t}\r\n\t\t\tif (type === 'VKWebAppAddToHomeScreenResult') {\r\n\t\t\t\tif (data.result) {\r\n\t\t\t\t\tsetAddedToHomeScreen(data.result);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tbridge.send('VKWebAppAddToHomeScreenInfo');\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>Ещё</PanelHeader>\r\n\t\t\t<Group\r\n\t\t\t\theader={\r\n\t\t\t\t\t<Header\r\n\t\t\t\t\t\tmode=\"secondary\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tДополнительно\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tbefore={\r\n\t\t\t\t\t\t<Icon28ShareExternalOutline/>\r\n\t\t\t\t\t}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tbridge.send(\"VKWebAppShare\", {link: `https://vk.com/zlabz_balance#ref=${userId}`})\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tПоделиться\r\n\t\t\t\t</Cell>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tbefore={<Icon28Users3Outline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tbridge.send('VKWebAppJoinGroup', {group_id: 195358095})\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tПрисоединиться к Балансу\r\n\t\t\t\t</Cell>\r\n\r\n\t\t\t\t{addToHomeScreenSupported && !addedToHomeScreen && <Cell\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tbefore={<Icon28AddCircleOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tbridge.send('VKWebAppAddToHomeScreen');\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tДобавить на главный экран\r\n\t\t\t\t</Cell>}\r\n\t\t\t</Group>\r\n\t\t\t{false && <Group>\r\n\t\t\t\t<Cell expandable before={<Icon28ListCheckOutline/>}>Список покупок</Cell>\r\n\t\t\t</Group>}\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useCallback, useContext, useEffect, useState} from 'react';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport Home from './panels/Home';\r\nimport useApi from \"./handlers/useApi\";\r\nimport {State} from './state';\r\nimport {\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_VIEW,\r\n\tSET_BUDGETS,\r\n\tSET_COLOR_SCHEME, SET_EDITED_ITEM,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT\r\n} from \"./state/actions\";\r\nimport {\r\n\tAlert,\r\n\tANDROID,\r\n\tConfigProvider,\r\n\tEpic,\r\n\tIOS,\r\n\tModalPage,\r\n\tModalPageHeader,\r\n\tModalRoot,\r\n\tPanelHeaderButton,\r\n\tplatform,\r\n\tTabbar,\r\n\tTabbarItem\r\n} from \"@vkontakte/vkui\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon28HomeOutline from '@vkontakte/icons/dist/28/home_outline';\r\nimport Icon28CoinsOutline from '@vkontakte/icons/dist/28/coins_outline';\r\nimport Icon28StatisticsOutline from '@vkontakte/icons/dist/28/statistics_outline';\r\nimport Icon28More from '@vkontakte/icons/dist/28/more';\r\nimport AddAccount from \"./components/modals/AddAccount\";\r\nimport AddMoney from \"./components/modals/AddMoney\";\r\nimport AccountInfo from \"./panels/AccountInfo\";\r\nimport Budgets from \"./panels/Budgets\";\r\nimport AddBudget from \"./components/modals/AddBudget\";\r\nimport BudgetInfo from \"./panels/BudgetInfo\";\r\nimport Stats from \"./panels/Stats\";\r\nimport InitialScreen from \"./panels/InitialScreen\";\r\n\r\nimport './style.css';\r\nimport More from \"./panels/More\";\r\n\r\nconst App = () => {\r\n\tconst os = platform();\r\n\tconst [{response, isLoading}, doApiFetch] = useApi('/state');\r\n\tconst [needFetch, setNeedFetch] = useState(true);\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [lastBackAction, setLastBackAction] = useState(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tbridge.subscribe(({detail: {type, data}}) => {\r\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\r\n\t\t\t\tdispatch({type: SET_COLOR_SCHEME, payload: {scheme: data.scheme}})\r\n\t\t\t}\r\n\t\t});\r\n\r\n// Init VK  Mini App\r\n\t\tbridge.send(\"VKWebAppInit\", {});\r\n\t}, [dispatch]);\r\n\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Выйти',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\tawait bridge.send('VKWebAppClose', {status: 'success'});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Выйти из приложения?</h2>\r\n\t\t\t<p>Вы действительно хотите выйти?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tparams: {\r\n\t\t\t\tdate: new Date(state.currentDate)\r\n\t\t\t}\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [needFetch, doApiFetch, state.currentDate]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\t\twindow.onpopstate = () => {\r\n\t\t\t\tlet timeNow = +new Date();\r\n\t\t\t\tif (state.canClose) {\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert, alert: true}});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (timeNow - lastBackAction > 500) {\r\n\t\t\t\t\t\tsetLastBackAction(timeNow);\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twindow.history.pushState(null, null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, [dispatch, state.history, state.modal, lastBackAction, state.canClose, alert]\r\n\t);\r\n\r\n\tconst onRefresh = useCallback(() => {\r\n\t\tsetNeedFetch(true);\r\n\t}, []);\r\n\r\n\tconst modalBack = (() => {\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t})\r\n\r\n\tconst modal = (\r\n\t\t<ModalRoot\r\n\t\t\tactiveModal={state.modal}\r\n\t\t\tonClose={modalBack}\r\n\t\t>\r\n\t\t\t<ModalPage id={'add-account'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\tДобавить счет\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddAccount dispatch={dispatch}/>\r\n\t\t\t</ModalPage>\r\n\r\n\t\t\t<ModalPage id={'add-money'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\t{state.editedItem ? 'Редактировать' : 'Добавить запись'}\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddMoney accounts={state.accounts} id={state.account?._id}\r\n\t\t\t\t\t\t\t\t\teditedItem={state.editedItem} dispatch={dispatch} budget={state.budget} panel={state.activePanel}/>\r\n\t\t\t</ModalPage>\r\n\r\n\t\t\t<ModalPage id={'add-budget'} header={\r\n\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\t{state.editedItem ? 'Редактировать' : 'Добавить бюджет'}\r\n\t\t\t\t</ModalPageHeader>\r\n\t\t\t}>\r\n\t\t\t\t<AddBudget editedItem={state.editedItem} dispatch={dispatch}/>\r\n\t\t\t</ModalPage>\r\n\t\t</ModalRoot>\r\n\t)\r\n\r\n\tconst onStoryChange = (e) => {\r\n\t\tdispatch({\r\n\t\t\ttype: SET_ACTIVE_VIEW,\r\n\t\t\tpayload: {view: e.currentTarget.dataset.story, panel: e.currentTarget.dataset.panel}\r\n\t\t})\r\n\t}\r\n\r\n\tconst tabBar = (\r\n\t\t<Tabbar itemsLayout={'horizontal'}>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'home'}\r\n\t\t\t\tdata-story={'home'}\r\n\t\t\t\tdata-panel={'home'}\r\n\t\t\t\ttext={'Баланс'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28HomeOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'info' && (state.activePanel === 'budgets' || state.activePanel === 'budget')}\r\n\t\t\t\tdata-story={'info'}\r\n\t\t\t\tdata-panel={'budgets'}\r\n\t\t\t\ttext={'Бюджеты'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28CoinsOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'stats' && state.activePanel === 'stats'}\r\n\t\t\t\tdata-story={'stats'}\r\n\t\t\t\tdata-panel={'stats'}\r\n\t\t\t\ttext={'Сводка'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28StatisticsOutline/>\r\n\t\t\t</TabbarItem>\r\n\t\t\t<TabbarItem\r\n\t\t\t\tonClick={onStoryChange}\r\n\t\t\t\tselected={state.activeView === 'more' && state.activePanel === 'index'}\r\n\t\t\t\tdata-story={'more'}\r\n\t\t\t\tdata-panel={'index'}\r\n\t\t\t\ttext={'Ещё'}\r\n\t\t\t>\r\n\t\t\t\t<Icon28More/>\r\n\t\t\t</TabbarItem>\r\n\t\t</Tabbar>\r\n\t)\r\n\r\n\treturn (\r\n\t\t<ConfigProvider scheme={state.scheme}>\r\n\t\t\t<Epic activeStory={state.activeView} tabbar={state.activeView !== 'init' && state.activePanel !== 'init' && tabBar}>\r\n\t\t\t\t<View id={'init'} activePanel={state.activePanel}>\r\n\t\t\t\t\t<InitialScreen id={'init'} dispatch={dispatch} loading={state.popout}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'home'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<Home id='home' accounts={state.accounts} budgets={state.budgets} dispatch={dispatch} isLoading={isLoading}\r\n\t\t\t\t\t\t\t\tonRefresh={onRefresh} isFetching={isLoading}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'info'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<AccountInfo id={'account'} account={state.accounts.find(item => item._id === state.account?._id)}\r\n\t\t\t\t\t\t\t\t\t\t\t dispatch={dispatch} onRefresh={onRefresh} context={state.contextHistory}/>\r\n\t\t\t\t\t<Budgets id={'budgets'} budgets={state.budgets} dispatch={dispatch} onRefresh={onRefresh}\r\n\t\t\t\t\t\t\t\t\t date={state.currentDate}/>\r\n\t\t\t\t\t<BudgetInfo id={'budget'} budget={state.budgets.find(item => item._id === state.budget?._id)}\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch={dispatch} context={state.contextHistory}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'stats'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<Stats id={'stats'} accounts={state.accounts} onRefresh={onRefresh} dispatch={dispatch}/>\r\n\t\t\t\t</View>\r\n\t\t\t\t<View id={'more'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<More id={'index'} />\r\n\t\t\t\t</View>\r\n\t\t\t</Epic>\r\n\t\t</ConfigProvider>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n\r\n","import \"core-js/features/map\";\r\nimport \"core-js/features/set\";\r\nimport 'array-flat-polyfill';\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport {StateProvider} from \"./state\";\r\n\r\nReactDOM.render(\r\n  <StateProvider>\r\n    <App />\r\n  </StateProvider>, document.getElementById(\"root\"));\r\nif (new URL(window.location.href).searchParams.get('vk_user_id') === process.env.REACT_APP_ID.toString()) {\r\n  import(\"./eruda\").then(() => {}); //runtime download\r\n}\r\n\r\n// console.log(new URL(window.location.href).searchParams.get('vk_user_id'));\r\n//import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\r\n"],"sourceRoot":""}