{"version":3,"sources":["handlers/currency.js","components/ListOfItems.js","state/actions.js","panels/Home.js","state/index.js","handlers/useApi.js","handlers/validate.js","components/modals/AddAccount.js","components/modals/AddMoney.js","components/InfoSnackbar.js","handlers/mapRichCell.js","panels/AccountInfo.js","panels/Budgets.js","components/modals/AddBudget.js","panels/BudgetInfo.js","App.js","index.js"],"names":["number","Intl","NumberFormat","style","currency","format","data","showAll","dispatch","itemsName","needHide","useState","isShow","setIsShow","length","list","sort","a","b","sum","map","account","index","key","indicator","expandable","data-id","_id","onClick","e","type","payload","id","currentTarget","dataset","view","panel","title","weight","marginBottom","push","Home","accounts","budgets","onRefresh","isFetching","sumOfAll","el","reduce","acc","cur","left","modal","header","mode","separator","level","ListOfItems","initialState","budget","successMessage","error","activeView","activePanel","popout","editedItem","reducer","state","action","find","item","message","State","createContext","StateProvider","children","value","useReducer","Provider","url","isLoading","setLoading","response","setResponse","setError","options","setOptions","useContext","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","process","headers","queryString","parse","window","location","search","useEffect","axios","then","catch","Error","fetchData","validity","valid","status","badInput","tooLong","typeMismatch","rangeOverflow","titleValidation","sumValidation","setAccount","stateForm","dispatchForm","useApi","onSubmit","preventDefault","placeholder","top","required","maxLength","bottom","onChange","validate","max","step","size","date","Date","income","description","price","quantity","tags","validateForm","apiStr","accountList","tag","marginRight","itemFrom","defaultValue","name","defaultChecked","join","toLowerCase","split","display","InfoSnackbar","snackbar","setSnackbar","onClose","before","color","mapRichCell","multiline","caption","locale","ruLocale","after","isOpened","setIsOpened","accountItemsList","operations","toggleContext","alert","actions","autoclose","aside","transform","opened","budgetsStartSum","startSum","budgetsSum","needFetch","setNeedFetch","filteredItems","setFilteredItems","itemsList","str","filter","indexOf","App","os","platform","isAccountExist","findIndex","splice","modalBack","activeModal","ANDROID","right","IOS","AddAccount","AddMoney","AddBudget","onStoryChange","story","tabBar","selected","data-story","data-panel","text","alignY","alignX","activeStory","tabbar","AccountInfo","BudgetInfo","Budgets","bridge","subscribe","detail","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","send","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.1fb78492.chunk.js","sourcesContent":["export default (number) => {\r\n\treturn new Intl.NumberFormat('ru-RU', {style: 'currency', currency: 'RUB'}).format(number);\r\n}","import React, {useState} from 'react';\r\nimport Cell from \"@vkontakte/vkui/dist/components/Cell/Cell\";\r\nimport {Footer, Text} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport {SET_ACCOUNT, SET_ACTIVE_VIEW, SET_BUDGET} from \"../state/actions\";\r\n\r\nexport default ({data, showAll = false, dispatch, itemsName, needHide = true}) => {\r\n\tconst [isShow, setIsShow] = useState(() => {\r\n\t\treturn showAll;\r\n\t});\r\n\r\n\tif (data.length === 0) {\r\n\t\tif (itemsName === 'accounts') {\r\n\t\t\treturn <Footer>Нет счетов для отображения</Footer>\r\n\t\t}\r\n\t\tif (itemsName === 'budgets') {\r\n\t\t\treturn <Footer>Нет бюджетов для отображения</Footer>\r\n\t\t}\r\n\t}\r\n\r\n\tlet list = data\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn b.sum - a.sum;\r\n\t\t})\r\n\t\t.map((account, index) => {\r\n\t\t\tif (index === 3 && !isShow) {\r\n\t\t\t\treturn <Cell\r\n\t\t\t\t\tkey={index}\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetIsShow(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t\t\tПоказать все\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t</Cell>\r\n\t\t\t}\r\n\t\t\tif (index > 3 && !isShow) {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t\treturn <Cell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tindicator={currency(account.sum)}\r\n\t\t\t\texpandable\r\n\t\t\t\tdata-id={account._id}\r\n\t\t\t\tonClick={async (e) => {\r\n\t\t\t\t\tif (itemsName === 'accounts') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACCOUNT, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'account'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (itemsName === 'budgets') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_BUDGET, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'budget'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{account.title}\r\n\t\t\t</Cell>\r\n\t\t});\r\n\tif (needHide) {\r\n\t\tif (isShow) list.push(<Cell\r\n\t\t\tkey={data.length}\r\n\t\t\texpandable\r\n\t\t\tonClick={() => {\r\n\t\t\t\tsetIsShow(false);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t{itemsName === 'accounts' ? 'Скрыть счета' : 'Скрыть бюджеты'}\r\n\t\t\t</Text>\r\n\t\t</Cell>);\r\n\t}\r\n\r\n\r\n\treturn list;\r\n}","export const SET_ACCOUNTS = 'SET_ACCOUNTS';\r\nexport const SET_BUDGETS = 'SET_BUDGETS';\r\nexport const SET_BUDGET = 'SET_BUDGET';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_SUCCESS_MESSAGE = 'SET_SUCCESS_MESSAGE';\r\nexport const SET_ACTIVE_VIEW = 'SET_ACTIVE_VIEW';\r\nexport const SET_ACTIVE_PANEL= 'SET_ACTIVE_PANEL';\r\nexport const SET_ACCOUNT = 'SET_ACCOUNT';\r\nexport const SET_POPOUT = 'SET_POPOUT';\r\nexport const SET_EDITED_ITEM = 'SET_EDITED_ITEM';","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport {Header, PanelHeaderButton, PullToRefresh, Title} from \"@vkontakte/vkui\";\nimport currency from \"../handlers/currency\";\nimport ListOfItems from \"../components/ListOfItems\";\nimport {SET_ACCOUNT, SET_MODAL} from \"../state/actions\";\nimport Icon28MarketAddBadgeOutline from '@vkontakte/icons/dist/28/market_add_badge_outline';\nimport Icon28ListAddOutline from '@vkontakte/icons/dist/28/list_add_outline';\n\nconst Home = ({id, accounts, budgets, dispatch, onRefresh, isFetching}) => {\n\tconst sumOfAll = accounts.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader\n\t\t\t\tleft={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28ListAddOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>\n\t\t\t\t\t\t{accounts.length !== 0 && <PanelHeaderButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_ACCOUNT, payload: {id: null}});\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\n\t\t\t\t\t\t</PanelHeaderButton>}\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t>Balance</PanelHeader>\n\t\t\t<PullToRefresh onRefresh={onRefresh} isFetching={isFetching}>\n\t\t\t\t<Group\n\t\t\t\t\theader={<Header mode=\"secondary\">Ваши счета</Header>}\n\t\t\t\t\tseparator=\"show\"\n\t\t\t\t>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(sumOfAll)}</Title>\n\t\t\t\t\t\t<ListOfItems data={accounts} dispatch={dispatch} showAll={false} itemsName={'accounts'}/>\n\t\t\t\t\t</Div>\n\t\t\t\t</Group>\n\t\t\t\t<Group\n\t\t\t\t\theader={<Header mode={'secondary'}>Ваши бюджеты</Header>}\n\t\t\t\t\tseparator={'show'}\n\t\t\t\t>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={false} itemsName={'budgets'}/>\n\t\t\t\t\t</Div>\n\t\t\t\t</Group>\n\t\t\t</PullToRefresh>\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Home;\n","import React, {createContext, useReducer} from 'react';\r\nimport {\r\n\tSET_ACCOUNT,\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_PANEL,\r\n\tSET_ACTIVE_VIEW, SET_BUDGET, SET_BUDGETS, SET_EDITED_ITEM,\r\n\tSET_ERROR,\r\n\tSET_MODAL, SET_POPOUT,\r\n\tSET_SUCCESS_MESSAGE\r\n} from './actions';\r\n\r\nconst initialState = {\r\n\taccounts: [],\r\n\tbudgets: [],\r\n\taccount: null,\r\n\tbudget: null,\r\n\tmodal: null,\r\n\tsuccessMessage: null,\r\n\terror: null,\r\n\tactiveView: 'home',\r\n\tactivePanel: 'home',\r\n\tpopout: null,\r\n\teditedItem: null\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_ACTIVE_VIEW: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACTIVE_PANEL: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tactivePanel: action.payload.panel\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACCOUNTS: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccounts: action.payload.accounts\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGETS: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudgets: action.payload.budgets\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACCOUNT: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccount: state.accounts.find(item => {\r\n\t\t\t\t\treturn item._id === id;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGET: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudget: state.budgets.find(item => item._id === id)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_EDITED_ITEM: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\teditedItem: action.payload.item\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_POPOUT: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_MODAL: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tmodal: action.payload.modal\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_SUCCESS_MESSAGE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsuccessMessage: action.payload.message\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ERROR: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {SET_ERROR, SET_MODAL, SET_POPOUT, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport {State} from \"../state\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = process.env.NODE_ENV !== 'development' ? process.env.REACT_APP_BASEURL : process.env.REACT_APP_BASEURL_DEV;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}});\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search)} : {...queryString.parse(window.location.search)},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (!isLoading) return;\r\n\r\n\t\tconst fetchData = async () => {\r\n\t\t\tsetLoading(false);\r\n\t\t\treturn await axios(axiosOptions)\r\n\t\t\t\t.then(async (response) => {\r\n\t\t\t\t\tsetResponse(response.data.data);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: response.data.message}});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tlet e = error?.response ? error.response.data.error : new Error('Проблемы с подключением к API');\r\n\t\t\t\t\tsetError(e);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: e}});\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","export default (e) => {\r\n\tconst validity = e.currentTarget.validity;\r\n\tif (validity.valid) {\r\n\t\treturn {status: 'valid', message: null}\r\n\t} else {\r\n\t\tif (validity.badInput) {\r\n\t\t\treturn {status: 'error', message: 'Неверный формат ввода'}\r\n\t\t}\r\n\t\tif (validity.tooLong) {\r\n\t\t\treturn {status: 'error', message: 'Превышена максимальная длина'}\r\n\t\t}\r\n\t\tif (validity.typeMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Несоответствие типа'}\r\n\t\t}\r\n\t\tif (validity.rangeOverflow) {\r\n\t\t\treturn {status: 'error', message: 'Слишком большое число'}\r\n\t\t}\r\n\t\treturn {status: 'default', message: null}\r\n\t}\r\n}","import React, {useEffect, useReducer} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tsum: '',\r\n\ttitleValidation: {},\r\n\tsumValidation: {}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({setAccount}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [{response}, doApiFetch] = useApi('/money-box');\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tsetAccount(response);\r\n\t}, [response, setAccount]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.sum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Карта, наличные, счет в банке'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.titleValidation.status}\r\n\t\t\t\t\t\t bottom={stateForm.titleValidation.message ? stateForm.titleValidation.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {title: e.currentTarget.value, titleValidation: validate(e)}})}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Остаток в рублях'} value={stateForm.sum}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.sumValidation.status}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.sumValidation.message ? stateForm.sumValidation.message : 'Денежные средства, находящиеся на счете в данный момент'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {sum: e.currentTarget.value, sumValidation: validate(e)}})}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {format} from 'date-fns';\r\nimport {Button, Counter, Div, FormLayout, Input, Radio, Select, Textarea} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\n\r\nconst initialState = {\r\n\taccount: '',\r\n\ttitle: '',\r\n\tdate: format(new Date(), 'yyyy-MM-dd'),\r\n\tincome: false,\r\n\tdescription: '',\r\n\tprice: '',\r\n\tquantity: '',\r\n\ttags: [],\r\n\tvalidate: {\r\n\t\taccount: {},\r\n\t\ttitle: {},\r\n\t\tdescription: {},\r\n\t\tprice: {},\r\n\t\tquantity: {},\r\n\t\ttags: {},\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({accounts, id = null, setAccount, editedItem = null}) => {\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/item' : `/item/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\tconst [state, dispatch] = useReducer(reducer, initialState);\r\n\tconst accountList = accounts.map(item => {\r\n\t\treturn (<option key={item._id} value={item._id}>{item.title} ({currency(item.sum)})</option>)\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\teditedItem.date = format(new Date(editedItem.date), 'yyyy-MM-dd');\r\n\t\tdispatch({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tsetAccount(response);\r\n\t}, [response, setAccount]);\r\n\r\n\tconst tags = state.tags.map((tag, index) => <Counter style={{marginRight: '5px'}} key={index}>{tag}</Counter>);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tdoApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\tdate: state.date,\r\n\t\t\t\t\ttitle: state.title,\r\n\t\t\t\t\tdescription: state.description,\r\n\t\t\t\t\tprice: state.price,\r\n\t\t\t\t\tquantity: state.quantity,\r\n\t\t\t\t\tincome: state.income,\r\n\t\t\t\t\ttags: state.tags,\r\n\t\t\t\t\titemFrom: state.account || id\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Select top={'Счет'}\r\n\t\t\t\t\t\t\tplaceholder={'Выберите счет'}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\tpayload: {account: e.currentTarget.value, validateForm: {account: validate(e)}}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdefaultValue={id || state.account || editedItem?.itemFrom} required={true}\r\n\t\t\t\t\t\t\tstatus={state.validate?.account?.status}\r\n\t\t\t\t\t\t\tbottom={state.validate?.account?.message}\r\n\t\t\t>\r\n\t\t\t\t{accountList}\r\n\t\t\t</Select>\r\n\t\t\t<Input type={'date'}\r\n\t\t\t\t\t\t top={'Дата'}\r\n\t\t\t\t\t\t value={state.date}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {date: e.currentTarget.value}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t placeholder={'Продукт, услуга, товар'}\r\n\t\t\t\t\t\t value={state.title}\r\n\t\t\t\t\t\t top={'Название'}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={20}\r\n\t\t\t\t\t\t status={state.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {title: e.currentTarget.value, validateForm: {title: validate(e)}}})\r\n\t\t\t\t\t\t }}/>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={false}\r\n\t\t\t\t\t\t defaultChecked={state.income ? null : true}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {income: false}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tРасход\r\n\t\t\t</Radio>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={true}\r\n\t\t\t\t\t\t defaultChecked={state.income ? true : null}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {income: true}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tДоход\r\n\t\t\t</Radio>\r\n\t\t\t{\r\n\t\t\t\t!state.income\r\n\t\t\t\t&&\r\n\t\t\t\t<Textarea top={'Описание'}\r\n\t\t\t\t\t\t\t\t\tplaceholder={'Описание товара(продукта, услуги)'}\r\n\t\t\t\t\t\t\t\t\tdefaultValue={state.description}\r\n\t\t\t\t\t\t\t\t\tmaxLength={70}\r\n\t\t\t\t\t\t\t\t\tstatus={state.validate?.description?.status}\r\n\t\t\t\t\t\t\t\t\tbottom={state.validate?.description?.message ? state.validate?.description?.message : `${state.description.length} из 70`}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: e.currentTarget.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalidateForm: {description: validate(e)}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t top={'Тэги'}\r\n\t\t\t\t\t\t value={state.tags.join(' ')}\r\n\t\t\t\t\t\t placeholder={'Тэги через пробел'}\r\n\t\t\t\t\t\t status={state.validate?.tags?.status}\r\n\t\t\t\t\t\t maxLength={100}\r\n\t\t\t\t\t\t bottom={state.validate?.tags?.message ? state.validate?.tags?.message : `${state.tags.length} из 100`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {tags: e.currentTarget.value.toLowerCase().split(' '), validateForm: {tags: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\tstate.tags.length !== 0\r\n\t\t\t\t&&\r\n\t\t\t\t<Div style={{display: 'flex'}}>\r\n\t\t\t\t\t{tags}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={currency(0)}\r\n\t\t\t\t\t\t top={'Цена'}\r\n\t\t\t\t\t\t max={99999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t status={state.validate?.price?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.price?.message}\r\n\t\t\t\t\t\t value={state.price}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {price: e.currentTarget.value, validateForm: {price: validate(e)}}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={'0'}\r\n\t\t\t\t\t\t top={'Кол-во'}\r\n\t\t\t\t\t\t max={9999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t status={state.validate?.quantity?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.quantity?.message}\r\n\t\t\t\t\t\t value={state.quantity}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatch({type: 'CHANGE_STATE', payload: {quantity: e.currentTarget.value, validateForm: {quantity: validate(e)}}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Button size={'xl'}>\r\n\t\t\t\tСохранить\r\n\t\t\t</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\nimport Icon24CheckCircleOn from '@vkontakte/icons/dist/24/check_circle_on';\r\n\r\nconst InfoSnackbar = ({children}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.successMessage) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24CheckCircleOn style={{color: 'var(--accent)'}}/>}\r\n\t\t>\r\n\t\t\t{state.successMessage}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.successMessage]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{children}\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;","import React from 'react';\r\nimport {RichCell} from \"@vkontakte/vkui\";\r\nimport {format} from \"date-fns\";\r\nimport ruLocale from \"date-fns/locale/ru\";\r\nimport currency from \"./currency\";\r\nimport {SET_EDITED_ITEM, SET_MODAL} from \"../state/actions\";\r\n\r\nexport default function mapRichCell(dispatch) {\r\n\treturn (item, index) => {\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={format(new Date(item?.date), 'dd MMMM yyyy', {locale: ruLocale})}\r\n\t\t\t\tafter={item?.income ? currency(item?.sum) : currency(-1 * item?.sum)}\r\n\t\t\t\tdata-id={item?._id}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: item}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t};\r\n}","import React, {useEffect, useState} from 'react';\r\nimport useApi from \"../handlers/useApi\";\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tHeader,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tTitle\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport Group from \"@vkontakte/vkui/dist/components/Group/Group\";\r\nimport {SET_ACTIVE_VIEW, SET_EDITED_ITEM, SET_MODAL, SET_POPOUT} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\r\nimport Icon28Delete from '@vkontakte/icons/dist/28/delete';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\n\r\nexport default ({id, account, dispatch, onRefresh}) => {\r\n\tconst [isOpened, setIsOpened] = useState(false);\r\n\tconst [{response}, doApiFetch] = useApi(`/money-box/${account?._id}`);\r\n\tconst accountItemsList = account?.operations.map(mapRichCell(dispatch));\r\n\tconst toggleContext = () => {\r\n\t\tsetIsOpened(!isOpened);\r\n\t}\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить счет?</h2>\r\n\t\t\t<p>Удаление счета приведет к удалению всех данных по доходам и расходам, привязанным к данному счету. Суммы\r\n\t\t\t\tбюджетов могут отображаться некоректно.</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\tonRefresh();\r\n\t}, [dispatch, response, onRefresh]);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={<Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{account?.title}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tbefore={<Icon28Delete/>}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert}})\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tУдалить счет {account?.title}\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t</List>\r\n\t\t\t</PanelHeaderContext>\r\n\t\t\t<Group\r\n\t\t\t\theader={<Header mode=\"secondary\">Информация по счету</Header>}\r\n\t\t\t\tseparator=\"show\"\r\n\t\t\t>\r\n\t\t\t\t<Div>\r\n\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(account?.sum)}</Title>\r\n\t\t\t\t</Div>\r\n\t\t\t\t{account?.operations.length === 0 && <Footer>Операций по счету еще не было</Footer>}\r\n\t\t\t\t{accountItemsList}\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {format} from 'date-fns';\r\nimport ruLocale from 'date-fns/locale/ru';\r\nimport {Footer, Group, Header, Panel, PanelHeader, PanelHeaderButton} from \"@vkontakte/vkui\";\r\nimport ListOfItems from \"../components/ListOfItems\";\r\nimport {SET_MODAL} from \"../state/actions\";\r\nimport Icon28ListAddOutline from \"@vkontakte/icons/dist/28/list_add_outline\";\r\nimport currency from \"../handlers/currency\";\r\n\r\nexport default ({id, budgets, dispatch, date = new Date()}) => {\r\n\tconst budgetsStartSum = budgets.map(el => el.startSum).reduce((acc, cur) => acc + cur, 0);\r\n\tconst budgetsSum = budgets.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<PanelHeaderButton onClick={() => dispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})}>\r\n\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tБюджеты\r\n\t\t\t</PanelHeader>\r\n\t\t\t<Group\r\n\t\t\t\theader={<Header mode=\"secondary\">Ваши бюджеты\r\n\t\t\t\t\tна {format(new Date(date), 'MMM yyyy', {locale: ruLocale})}</Header>}\r\n\t\t\t\tseparator=\"show\"\r\n\t\t\t>\r\n\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={true} itemsName={'budgets'} needHide={false}/>\r\n\t\t\t\t<Footer>Осталось {currency(budgetsSum)} из {currency(budgetsStartSum)}</Footer>\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useReducer, useEffect} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport currency from \"../../handlers/currency\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tsum: '',\r\n\tvalidate: {\r\n\t\ttitle: {},\r\n\t\tsum: {}\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({onRefresh}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [{response}, doApiFetch] = useApi('/budget');\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tonRefresh();\r\n\t}, [onRefresh, response]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.sum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Название бюджета'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.title?.message ? stateForm.validate?.title?.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {title: e.currentTarget.value, validateForm: {title: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Бюджет в рублях'} value={stateForm.sum}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.validate?.sum?.status}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.sum?.message ? stateForm.validate?.sum?.message : 'Сколько вы готовы на это потратить?'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {sum: e.currentTarget.value, validateForm: {sum: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tSearch\r\n} from \"@vkontakte/vkui\";\r\nimport {SET_ACTIVE_VIEW, SET_EDITED_ITEM, SET_MODAL, SET_POPOUT} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport useApi from \"../handlers/useApi\";\r\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\r\nimport Icon28Delete from \"@vkontakte/icons/dist/28/delete\";\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\n\r\nexport default ({id, budget, dispatch}) => {\r\n\tconst [isOpened, setIsOpened] = useState(false);\r\n\tconst [{response}, doApiFetch] = useApi(`/budget/${budget._id}`);\r\n\tconst [needFetch, setNeedFetch] = useState(true);\r\n\tconst [filteredItems, setFilteredItems] = useState([]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'GET'\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [doApiFetch, needFetch])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tsetFilteredItems(response);\r\n\t}, [response]);\r\n\r\n\tconst toggleContext = () => {\r\n\t\tsetIsOpened(!isOpened);\r\n\t}\r\n\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить бюджет?</h2>\r\n\t\t\t<p>Вы действительно хотите удалить бюджет?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tconst itemsList = filteredItems.map(mapRichCell(dispatch));\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tsetFilteredItems(response.filter(({title}) => title.toLowerCase().indexOf(str) > -1));\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={<Icon16Dropdown style={{ transform: `rotate(${isOpened ? '180deg' : '0'})` }} />}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{budget?.title}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tbefore={<Icon28Delete />}\r\n\t\t\t\t\t\tonClick={() => {dispatch({type: SET_POPOUT, payload: {popout: alert}})}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tУдалить бюджет {budget?.title}\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t</List>\r\n\t\t\t</PanelHeaderContext>\r\n\t\t\t<Search onChange={(e) => {onSearch(e.currentTarget.value)}}/>\r\n\t\t\t{itemsList}\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useCallback, useContext, useEffect, useState} from 'react';\nimport View from '@vkontakte/vkui/dist/components/View/View';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Home from './panels/Home';\nimport useApi from \"./handlers/useApi\";\nimport {State} from './state';\nimport {SET_ACCOUNT, SET_ACCOUNTS, SET_ACTIVE_VIEW, SET_BUDGETS, SET_MODAL} from \"./state/actions\";\nimport {\n\tANDROID,\n\tEpic,\n\tIOS,\n\tModalPage,\n\tModalPageHeader,\n\tModalRoot,\n\tPanelHeaderButton,\n\tplatform,\n\tPopoutWrapper,\n\tTabbar,\n\tTabbarItem\n} from \"@vkontakte/vkui\";\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport Icon24Done from '@vkontakte/icons/dist/24/done';\nimport Icon28HomeOutline from '@vkontakte/icons/dist/28/home_outline';\nimport Icon28CoinsOutline from '@vkontakte/icons/dist/28/coins_outline';\nimport AddAccount from \"./components/modals/AddAccount\";\nimport AddMoney from \"./components/modals/AddMoney\";\nimport InfoSnackbar from \"./components/InfoSnackbar\";\nimport AccountInfo from \"./panels/AccountInfo\";\nimport Budgets from \"./panels/Budgets\";\nimport AddBudget from \"./components/modals/AddBudget\";\nimport BudgetInfo from \"./panels/BudgetInfo\";\n\nconst App = () => {\n\tconst os = platform();\n\tconst [{response, isLoading}, doApiFetch] = useApi('/state');\n\tconst [needFetch, setNeedFetch] = useState(true);\n\tconst [state, dispatch] = useContext(State);\n\tconst [account, setAccount] = useState(null);\n\n\tuseEffect(() => {\n\t\tif (!needFetch) return;\n\t\tdoApiFetch();\n\t\tsetNeedFetch(false);\n\t}, [needFetch, doApiFetch]);\n\n\tuseEffect(() => {\n\t\tif (!response) return;\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\n\t}, [response, dispatch]);\n\n\tuseEffect(() => {\n\t\tif (!account) return;\n\t\tconst isAccountExist = state.accounts.findIndex(item => {\n\t\t\treturn item._id === account._id\n\t\t});\n\n\t\tif (isAccountExist === -1) {\n\t\t\tconst accounts = [...state.accounts, account];\n\t\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: accounts}});\n\t\t} else {\n\t\t\tconst accounts = [...state.accounts];\n\t\t\taccounts.splice(isAccountExist, 1, account);\n\t\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: accounts}});\n\t\t\tif (state.activeView === 'info' && state.activePanel === 'account') {\n\t\t\t\tdispatch({type: SET_ACCOUNT, payload: {id: account._id}});\n\t\t\t}\n\t\t}\n\n\t\tsetAccount(null);\n\t}, [account, dispatch, state.accounts, setAccount, state.activePanel, state.activeView]);\n\n\tconst onRefresh = useCallback(() => {\n\t\tsetNeedFetch(true);\n\t}, []);\n\n\tconst modalBack = () => {\n\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\n\t}\n\n\tconst modal = (\n\t\t<ModalRoot\n\t\t\tactiveModal={state.modal}\n\t\t\tonClose={modalBack}\n\t\t>\n\t\t\t<ModalPage id={'add-account'} header={\n\t\t\t\t<ModalPageHeader\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Готово' : <Icon24Done/>}</PanelHeaderButton>}\n\t\t\t\t>\n\t\t\t\t\tДобавить счет\n\t\t\t\t</ModalPageHeader>\n\t\t\t}>\n\t\t\t\t<AddAccount setAccount={setAccount}/>\n\t\t\t</ModalPage>\n\n\t\t\t<ModalPage id={'add-money'} header={\n\t\t\t\t<ModalPageHeader\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Готово' : <Icon24Done/>}</PanelHeaderButton>}\n\t\t\t\t>\n\t\t\t\t\t{state.editedItem ? 'Редактировать' : 'Добавить запись'}\n\t\t\t\t</ModalPageHeader>\n\t\t\t}>\n\t\t\t\t<AddMoney accounts={state.accounts} id={state.account?._id} setAccount={setAccount}\n\t\t\t\t\t\t\t\t\teditedItem={state.editedItem}/>\n\t\t\t</ModalPage>\n\n\t\t\t<ModalPage id={'add-budget'} header={\n\t\t\t\t<ModalPageHeader\n\t\t\t\t\tleft={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\n\t\t\t\t\tright={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Готово' : <Icon24Done/>}</PanelHeaderButton>}\n\t\t\t\t>\n\t\t\t\t\tДобавить бюджет\n\t\t\t\t</ModalPageHeader>\n\t\t\t}>\n\t\t\t\t<AddBudget accounts={state.accounts} id={state.account?._id} setAccount={setAccount}\n\t\t\t\t\t\t\t\t\t editedItem={state.editedItem} onRefresh={onRefresh}/>\n\t\t\t</ModalPage>\n\t\t</ModalRoot>\n\t)\n\n\tconst onStoryChange = (e) => {\n\t\tdispatch({\n\t\t\ttype: SET_ACTIVE_VIEW,\n\t\t\tpayload: {view: e.currentTarget.dataset.story, panel: e.currentTarget.dataset.panel}\n\t\t})\n\t}\n\n\tconst tabBar = (\n\t\t<Tabbar>\n\t\t\t<TabbarItem\n\t\t\t\tonClick={onStoryChange}\n\t\t\t\tselected={state.activeView === 'home'}\n\t\t\t\tdata-story={'home'}\n\t\t\t\tdata-panel={'home'}\n\t\t\t\ttext={'Баланс'}\n\t\t\t>\n\t\t\t\t<Icon28HomeOutline/>\n\t\t\t</TabbarItem>\n\t\t\t<TabbarItem\n\t\t\t\tonClick={onStoryChange}\n\t\t\t\tselected={state.activeView === 'info' && state.activePanel === 'budgets'}\n\t\t\t\tdata-story={'info'}\n\t\t\t\tdata-panel={'budgets'}\n\t\t\t\ttext={'Бюджеты'}\n\t\t\t>\n\t\t\t\t<Icon28CoinsOutline/>\n\t\t\t</TabbarItem>\n\t\t</Tabbar>\n\t)\n\n\treturn (\n\t\t<InfoSnackbar>\n\t\t\t<PopoutWrapper alignY=\"center\" alignX=\"center\">\n\t\t\t\t<Epic activeStory={state.activeView} tabbar={tabBar}>\n\t\t\t\t\t<View id={'home'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\n\t\t\t\t\t\t<Home id='home' accounts={state.accounts} budgets={state.budgets} dispatch={dispatch} isLoading={isLoading}\n\t\t\t\t\t\t\t\t\tonRefresh={onRefresh} isFetching={isLoading}/>\n\t\t\t\t\t</View>\n\t\t\t\t\t<View id={'info'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\n\t\t\t\t\t\t<AccountInfo id={'account'} account={state.account} dispatch={dispatch} onRefresh={onRefresh}/>\n\t\t\t\t\t\t<BudgetInfo id={'budget'} budget={state.budget} dispatch={dispatch}/>\n\t\t\t\t\t\t<Budgets id={'budgets'} budgets={state.budgets} dispatch={dispatch}/>\n\t\t\t\t\t</View>\n\t\t\t\t</Epic>\n\t\t\t</PopoutWrapper>\n\t\t</InfoSnackbar>\n\t);\n}\n\nexport default App;\n\n","import \"core-js/features/map\";\nimport \"core-js/features/set\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\nimport {StateProvider} from \"./state\";\n\nbridge.subscribe(({detail: {type, data}}) => {\n  if (type === 'VKWebAppUpdateConfig') {\n    const schemeAttribute = document.createAttribute('scheme');\n    schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n    document.body.attributes.setNamedItem(schemeAttribute);\n  }\n});\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(\n  <StateProvider>\n    <App />\n  </StateProvider>, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}