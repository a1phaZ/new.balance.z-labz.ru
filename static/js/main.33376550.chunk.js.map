{"version":3,"sources":["handlers/currency.js","state/actions.js","components/ListOfItems.js","handlers/smoothScrollToTop.js","state/index.js","components/InfoSnackbar.js","components/MonthSwitch.js","panels/Home.js","handlers/useApi.js","handlers/validate.js","handlers/regexp.js","components/modals/AddAccount.js","components/AccountsOptionsList.js","components/modals/AddMoney.js","components/Color.js","handlers/mapRichCell.js","handlers/sort.js","components/SearchForm.js","panels/AccountInfo.js","panels/Budgets.js","components/modals/AddBudget.js","handlers/reduce.js","panels/BudgetInfo.js","panels/Stats.js","handlers/mapStats.js","panels/InitialScreen.js","panels/More.js","panels/ShopListPanel.js","panels/AppStats.js","components/modals/TransferMoney.js","App.js","handlers/useLocalStorage.js","index.js"],"names":["number","Intl","NumberFormat","style","currency","format","SET_MODAL","data","showAll","dispatch","itemsName","needHide","useState","isShow","setIsShow","length","list","sort","a","b","sum","map","account","index","key","indicator","expandable","data-id","_id","onClick","e","type","payload","id","currentTarget","dataset","view","panel","title","weight","marginBottom","push","smoothScrollToTop","c","document","documentElement","scrollTop","body","window","requestAnimationFrame","scrollTo","initialState","accounts","budgets","budget","modal","successMessage","error","activeView","activePanel","popout","editedItem","currentDate","Date","history","modalsHistory","popoutHistory","contextHistory","canClose","scheme","modalOpenTime","reducer","state","action","pushState","lastHistoryState","backEl","newHistory","pop","accountId","find","item","budgetId","alert","context","message","date","State","createContext","StateProvider","children","value","useReducer","Provider","InfoSnackbar","useContext","snackbar","setSnackbar","useEffect","onClose","before","color","onRefresh","disabledAfter","isAfter","addMonths","disabledBefore","isBefore","clickTime","setClickTime","disabled","timeNow","subMonths","mode","asideContent","textAlign","fontWeight","cursor","locale","ru","toLocaleUpperCase","Home","isFetching","shopList","isOpened","setIsOpened","isAccountTooltipClose","setIsAccountTooltipClose","sumOfAll","el","reduce","acc","cur","shopListDone","curr","done","shopListButton","toggleContext","left","text","opened","MonthSwitch","header","separator","level","ListOfItems","url","isLoading","setLoading","response","setResponse","setError","options","setOptions","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","process","headers","queryString","parse","location","search","axios","then","catch","Error","fetchData","validity","valid","status","badInput","valueMissing","tooLong","typeMismatch","stepMismatch","rangeOverflow","rangeUnderflow","str","replace","titleValidation","sumValidation","stateForm","dispatchForm","apiStr","useApi","onSubmit","preventDefault","placeholder","top","required","maxLength","bottom","onChange","regexp","validate","pattern","inputMode","max","min","step","size","income","description","price","quantity","tags","boxPrice","validateForm","shopListItemTitle","setShopListItemTitle","descriptionShow","setDescriptionShow","Number","toFixed","toLowerCase","split","filter","tag","marginRight","maxWidth","overflow","overflowWrap","itemFrom","tzOffset","getTimezoneOffset","defaultValue","AccountsOptionsList","name","defaultChecked","join","display","flexWrap","checked","mapRichCell","caption","caps","ruLocale","outcome","Color","marginLeft","multiline","after","aDate","bDate","compareAsc","onSearch","searchStr","setSearchStr","searchRef","useRef","current","focus","substring","position","height","width","ref","accountContext","setAccountContext","operations","items","setItems","filteredItems","setFilteredItems","indexAr","prev","accountItemsListArray","Object","keys","forEach","splice","accountItemsList","actions","autoclose","accountContextView","itemContextView","contextView","indexOf","incomeSum","outcomeSum","aside","transform","SearchForm","slideWidth","bullets","bannerData","setBannerData","bridge","send","vertical","startSum","isEqual","deletedCount","alertDelete","itemsList","differenceInMonths","flat","localeCompare","setOperations","prevItem","slice","data-title","loading","icon","stretched","addToHomeScreenSupported","addedToHomeScreen","lastClickTime","setLastClickTime","userId","URL","href","searchParams","get","link","group_id","newList","findIndex","localStorage","removeItem","shopListFromServer","setShopList","success","dispatchList","deleteMode","setDeleteMode","selectable","removable","i","onRemove","getUserAgentArray","array","userAgent","sessionData","ts","setTs","dateRange","opt","beginDay","startOfDay","endDay","endOfDay","beginMonth","startOfMonth","endMonth","endOfMonth","month","begin","end","getDateRange","day","newUsers","user","createdAt","preparedData","timeStamp","newItem","androidUsers","iphoneUsers","mobileWebUsers","desktopUsers","androidMessengerUsers","iphoneMessengerUsers","to","from","accountFrom","accountsFromList","accountsToList","App","os","platform","needFetch","setNeedFetch","lastBackAction","setLastBackAction","initialValue","getItem","JSON","console","log","storedValue","setStoredValue","valueToStore","Function","setItem","stringify","useLocalStorage","setAddToHomeScreenSupported","setAddedToHomeScreen","subscribe","detail","is_feature_supported","is_added_to_home_screen","result","onpopstate","modalBack","activeModal","ANDROID","right","IOS","AddAccount","AddMoney","AddBudget","TransferMoney","onStoryChange","story","tabBar","itemsLayout","selected","data-story","data-panel","activeStory","tabbar","InitialScreen","AccountInfo","Budgets","BudgetInfo","Stats","More","ShopListPanel","AppStats","ReactDOM","render","getElementById","toString"],"mappings":"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","file":"static/js/main.33376550.chunk.js","sourcesContent":["export default (number) => {\r\n\treturn new Intl.NumberFormat('ru-RU', {style: 'currency', currency: 'RUB'}).format(number);\r\n}","export const SET_ACCOUNTS = 'SET_ACCOUNTS';\r\nexport const SET_BUDGETS = 'SET_BUDGETS';\r\nexport const SET_BUDGET = 'SET_BUDGET';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_SUCCESS_MESSAGE = 'SET_SUCCESS_MESSAGE';\r\nexport const SET_ACTIVE_VIEW = 'SET_ACTIVE_VIEW';\r\nexport const SET_ACCOUNT = 'SET_ACCOUNT';\r\nexport const SET_POPOUT = 'SET_POPOUT';\r\nexport const SET_EDITED_ITEM = 'SET_EDITED_ITEM';\r\nexport const SET_DATE = 'SET_DATE';\r\nexport const SET_HISTORY_BACK = 'SET_HISTORY_BACK';\r\nexport const SET_COLOR_SCHEME = 'SET_COLOR_SCHEME';\r\nexport const SET_TOGGLE_CONTEXT = 'SET_TOGGLE_CONTEXT';","import React, {useState} from 'react';\r\nimport Cell from \"@vkontakte/vkui/dist/components/Cell/Cell\";\r\nimport {Footer, Text} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport {SET_ACCOUNT, SET_ACTIVE_VIEW, SET_BUDGET} from \"../state/actions\";\r\n\r\nexport default ({data, showAll = false, dispatch, itemsName, needHide = true}) => {\r\n\tconst [isShow, setIsShow] = useState(() => {\r\n\t\treturn showAll;\r\n\t});\r\n\r\n\tif (data.length === 0) {\r\n\t\tif (itemsName === 'accounts') {\r\n\t\t\treturn <Footer>Нет счетов для отображения</Footer>\r\n\t\t}\r\n\t\tif (itemsName === 'budgets') {\r\n\t\t\treturn <Footer>Нет бюджетов для отображения</Footer>\r\n\t\t}\r\n\t}\r\n\r\n\tlet list = data\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn b.sum - a.sum;\r\n\t\t})\r\n\t\t.map((account, index) => {\r\n\t\t\tif (index === 3 && !isShow) {\r\n\t\t\t\treturn <Cell\r\n\t\t\t\t\tkey={'showAll'}\r\n\t\t\t\t\texpandable\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetIsShow(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t\t\tПоказать все\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t</Cell>\r\n\t\t\t}\r\n\t\t\tif (index > 3 && !isShow) {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t\treturn <Cell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tindicator={currency(account.sum)}\r\n\t\t\t\texpandable\r\n\t\t\t\tdata-id={account._id}\r\n\t\t\t\tonClick={async (e) => {\r\n\t\t\t\t\tif (itemsName === 'accounts') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACCOUNT, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'account'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (itemsName === 'budgets') {\r\n\t\t\t\t\t\tawait dispatch({type: SET_BUDGET, payload: {id: e.currentTarget.dataset.id}});\r\n\t\t\t\t\t\tawait dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'info', panel: 'budget'}});\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{account.title}\r\n\t\t\t</Cell>\r\n\t\t});\r\n\tif (needHide) {\r\n\t\tif (isShow) list.push(<Cell\r\n\t\t\tkey={data.length}\r\n\t\t\texpandable\r\n\t\t\tonClick={() => {\r\n\t\t\t\tsetIsShow(false);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Text weight=\"semibold\" style={{marginBottom: 16}}>\r\n\t\t\t\t{itemsName === 'accounts' ? 'Скрыть счета' : 'Скрыть бюджеты'}\r\n\t\t\t</Text>\r\n\t\t</Cell>);\r\n\t}\r\n\r\n\r\n\treturn list;\r\n}","export const smoothScrollToTop = () => {\r\n\tconst c = document.documentElement.scrollTop || document.body.scrollTop;\r\n\r\n\tif (c > 30) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (c > 0) {\r\n\t\twindow.requestAnimationFrame(smoothScrollToTop);\r\n\t\twindow.scrollTo(0, c - c / 8);\r\n\t}\r\n};","import React, {createContext, useReducer} from 'react';\r\nimport {\r\n\tSET_ACCOUNT,\r\n\tSET_ACCOUNTS,\r\n\tSET_ACTIVE_VIEW,\r\n\tSET_BUDGET,\r\n\tSET_BUDGETS,\r\n\tSET_DATE,\r\n\tSET_EDITED_ITEM,\r\n\tSET_ERROR,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_SUCCESS_MESSAGE,\r\n\tSET_COLOR_SCHEME, SET_TOGGLE_CONTEXT\r\n} from './actions';\r\nimport {smoothScrollToTop} from \"../handlers/smoothScrollToTop\";\r\n\r\nconst initialState = {\r\n\taccounts: [],\r\n\tbudgets: [],\r\n\taccount: null,\r\n\tbudget: null,\r\n\tmodal: null,\r\n\tsuccessMessage: null,\r\n\terror: null,\r\n\tactiveView: 'init',\r\n\tactivePanel: 'init',\r\n\tpopout: null,\r\n\teditedItem: null,\r\n\tcurrentDate: new Date(),\r\n\thistory: [],\r\n\tmodalsHistory: [],\r\n\tpopoutHistory: [],\r\n\tcontextHistory: false,\r\n\tcanClose: true,\r\n\tscheme: 'client_light',\r\n\tmodalOpenTime: +new Date()\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_COLOR_SCHEME: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tscheme: action.payload.scheme\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACTIVE_VIEW: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\r\n\t\t\twindow.scrollTo(0, 30);\r\n\t\t\tsmoothScrollToTop();\r\n\r\n\t\t\tlet history = state.history;\r\n\t\t\tif (history.length !== 0) {\r\n\t\t\t\tlet lastHistoryState = history[history.length - 1];\r\n\t\t\t\tif (lastHistoryState.view === action.payload.view && lastHistoryState.panel === action.payload.panel) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state,\r\n\t\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\t\tcanClose: false,\r\n\t\t\t\t\t\tcontextHistory: false,\r\n\t\t\t\t\t\tsuccessMessage: null,\r\n\t\t\t\t\t\terror: null\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: action.payload.view,\r\n\t\t\t\t\tactivePanel: action.payload.panel,\r\n\t\t\t\t\thistory: [...history, {view: action.payload.view, panel: action.payload.panel}],\r\n\t\t\t\t\tcanClose: true,\r\n\t\t\t\t\tcontextHistory: false,\r\n\t\t\t\t\tsuccessMessage: null,\r\n\t\t\t\t\terror: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_HISTORY_BACK: {\r\n\t\t\twindow.history.pushState(null, null);\r\n\r\n\t\t\twindow.scrollTo(0, 30);\r\n\t\t\tsmoothScrollToTop();\r\n\r\n\t\t\tconst backEl = state.history[state.history.length - 2];\r\n\t\t\tlet popoutHistory = state.popoutHistory || [];\r\n\t\t\tlet modalsHistory = state.modalsHistory || [];\r\n\t\t\tlet contextHistory = state.contextHistory || false;\r\n\r\n\t\t\tif (popoutHistory.length !== 0) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tpopout: null,\r\n\t\t\t\t\tpopoutHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!!contextHistory) {\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tcontextHistory: false,\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (modalsHistory.length !== 0) {\r\n\t\t\t\tif (+new Date() - state.modalOpenTime < 700) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...state\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst canClose = state.history.length <= 1;\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tmodal: null,\r\n\t\t\t\t\tmodalsHistory: [],\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\teditedItem: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!backEl) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: 'home',\r\n\t\t\t\t\tactivePanel: 'home',\r\n\t\t\t\t\thistory: [],\r\n\t\t\t\t\tcanClose: true,\r\n\t\t\t\t\teditedItem: null,\r\n\t\t\t\t\tsuccessMessage: null,\r\n\t\t\t\t\terror: null\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst canClose = (backEl.view === 'home' && backEl.panel === 'home');\r\n\t\t\t\tconst newHistory = state.history;\r\n\t\t\t\tnewHistory.pop();\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tactiveView: backEl.view,\r\n\t\t\t\t\tactivePanel: backEl.panel,\r\n\t\t\t\t\thistory: [...newHistory],\r\n\t\t\t\t\teditedItem: null,\r\n\t\t\t\t\tcanClose: canClose,\r\n\t\t\t\t\tsuccessMessage: null,\r\n\t\t\t\t\terror: null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tcase SET_ACCOUNTS: {\r\n\t\t\tconst accountId = state.account?._id;\r\n\t\t\tconst account = !accountId ? accountId : action.payload.accounts.find(item => {\r\n\t\t\t\treturn item._id === accountId;\r\n\t\t\t})\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccounts: action.payload.accounts,\r\n\t\t\t\taccount: account\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGETS: {\r\n\t\t\tconst budgetId = state.budget?._id;\r\n\t\t\tconst budget = !budgetId ? budgetId : action.payload.budgets.find(item => item._id === budgetId)\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudgets: action.payload.budgets,\r\n\t\t\t\tbudget: budget\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ACCOUNT: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\taccount: state.accounts.find(item => {\r\n\t\t\t\t\treturn item._id === id;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_BUDGET: {\r\n\t\t\tconst {payload: {id}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tbudget: !id ? id : state.budgets.find(item => item._id === id)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_EDITED_ITEM: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\teditedItem: action.payload.item\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_POPOUT: {\r\n\t\t\tif (action.payload.alert) {\r\n\t\t\t\twindow.history.pushState(null, null);\r\n\t\t\t}\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.popout) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.popout;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.popout) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout,\r\n\t\t\t\tpopoutHistory: action.payload.popout ? [action.payload.popout] : [],\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_MODAL: {\r\n\t\t\t// window.history.pushState(null, null);\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.modal) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.modal;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.modal) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tmodal: action.payload.modal,\r\n\t\t\t\tmodalsHistory: action.payload.modal ? [action.payload.modal] : [],\r\n\t\t\t\tcanClose: canClose,\r\n\t\t\t\tmodalOpenTime: +new Date()\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_TOGGLE_CONTEXT: {\r\n\t\t\tlet history = state.history;\r\n\t\t\tlet canClose = state.canClose;\r\n\t\t\tif (history.length !== 0 || action.payload.context) {\r\n\t\t\t\tcanClose = history.length === 1 && !action.payload.context;\r\n\t\t\t} else {\r\n\t\t\t\tif (history.length === 0 && !action.payload.context) {\r\n\t\t\t\t\tcanClose = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t// modal: action.payload.modal,\r\n\t\t\t\tcontextHistory: action.payload.context,\r\n\t\t\t\tcanClose: canClose\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_SUCCESS_MESSAGE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsuccessMessage: action.payload.message\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_ERROR: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase SET_DATE: {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tcurrentDate: new Date(action.payload.date)\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\nimport Icon24CheckCircleOn from '@vkontakte/icons/dist/24/check_circle_on';\r\n\r\nconst InfoSnackbar = () => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.successMessage) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24CheckCircleOn style={{color: 'var(--accent)'}}/>}\r\n\t\t>\r\n\t\t\t{state.successMessage}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.successMessage]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;","import React, {useContext, useState} from 'react';\r\nimport {addMonths, format, subMonths, isAfter, isBefore} from 'date-fns';\r\nimport {ru} from 'date-fns/locale';\r\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\r\nimport Icon24BrowserForward from '@vkontakte/icons/dist/24/browser_forward';\r\nimport {State} from \"../state\";\r\nimport {Button, Cell, Group} from \"@vkontakte/vkui\";\r\n\r\nexport default ({onRefresh}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst dateFormat = 'LLLL yyyy';\r\n\tconst disabledAfter = isAfter(addMonths(state.currentDate, 1), new Date());\r\n\tconst disabledBefore = isBefore(new Date(state.currentDate), new Date(2015, 0, 1));\r\n\tconst [clickTime, setClickTime] = useState(0);\r\n\t\r\n\tconst nextMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (addMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\tconst prevMonth = () => {\r\n\t\tlet timeNow = +new Date();\r\n\t\tif (timeNow - clickTime > 500) {\r\n\t\t\tdispatch({type: 'SET_DATE', payload: {date: (subMonths(state.currentDate, 1))}});\r\n\t\t\tonRefresh();\r\n\t\t\tsetClickTime(timeNow);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Group>\r\n\t\t\t<Cell\r\n\t\t\t\tbefore={<Button disabled={disabledBefore} onClick={prevMonth} mode={'secondary'}><Icon24BrowserBack/></Button>}\r\n\t\t\t\tasideContent={<Button disabled={disabledAfter} onClick={nextMonth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmode={'secondary'}><Icon24BrowserForward/></Button>}\r\n\t\t\t\tstyle={{textAlign: 'center', fontWeight: 'bold'}}\r\n\t\t\t>\r\n\t\t\t\t<div style={{cursor: 'auto'}}>\r\n\t\t\t\t\t{format(state.currentDate, dateFormat, {locale: ru}).toLocaleUpperCase()}\r\n\t\t\t\t</div>\r\n\t\t\t</Cell>\r\n\t\t</Group>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\r\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\r\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\r\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\r\nimport {\r\n\tButton,\r\n\tCell,\r\n\tFooter,\r\n\tHeader,\r\n\tList,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContext,\r\n\tPullToRefresh,\r\n\tTitle,\r\n\tTooltip\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport ListOfItems from \"../components/ListOfItems\";\r\nimport {SET_ACCOUNT, SET_ACTIVE_VIEW, SET_MODAL, SET_TOGGLE_CONTEXT} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from '@vkontakte/icons/dist/28/market_add_badge_outline';\r\nimport Icon28ListAddOutline from '@vkontakte/icons/dist/28/list_add_outline';\r\nimport Icon28MoneyTransfer from '@vkontakte/icons/dist/28/money_transfer';\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\n\r\nconst Home = ({id, accounts, budgets, dispatch, onRefresh, isFetching, shopList, context}) => {\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [isAccountTooltipClose, setIsAccountTooltipClose] = useState(false);\r\n\tconst sumOfAll = accounts.map(el => el.sum).reduce((acc, cur) => acc + cur, 0);\r\n\tconst shopListDone = shopList.reduce((acc, curr) => curr.done ? acc + 1 : acc, 0);\r\n\tconst shopListButton = (\r\n\t\t<Button\r\n\t\t\tmode={'tertiary'}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'more', panel: 'shop-list'}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{shopList.length === 0 ? 'Сформировать список покупок' : 'Перейти к списку покупок'}\r\n\t\t</Button>\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t}, [context]);\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\taccounts.length !== 0 || isAccountTooltipClose ?\r\n\t\t\t\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tif (isOpened) {\r\n\t\t\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t\t\t\t</PanelHeaderButton> :\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\ttext={'Начните учет финансов с добавления счета'}\r\n\t\t\t\t\t\t\t\t\tonClose={\r\n\t\t\t\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetIsAccountTooltipClose(true);\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{accounts.length !== 0 && <PanelHeaderButton\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t\t</PanelHeaderButton>}\r\n\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tБаланс\r\n\t\t\t</PanelHeader>\r\n\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tbefore={<Icon28MarketAddBadgeOutline/>}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_ACCOUNT, payload: {id: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tДобавить\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tbefore={<Icon28MoneyTransfer/>}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'transfer-money'}});\r\n\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tПеревести\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t</List>\r\n\t\t\t</PanelHeaderContext>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\t\t\t<PullToRefresh onRefresh={onRefresh} isFetching={isFetching}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Ваши счета</Header>}\r\n\t\t\t\t\t\tseparator=\"show\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t<Title level=\"1\" weight=\"semibold\" style={{marginBottom: 16}}>{currency(sumOfAll)}</Title>\r\n\t\t\t\t\t\t\t<ListOfItems data={accounts} dispatch={dispatch} showAll={false} itemsName={'accounts'}/>\r\n\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode={'secondary'}>Ваши бюджеты</Header>}\r\n\t\t\t\t\t\tseparator={'show'}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={false} itemsName={'budgets'}/>\r\n\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode={'secondary'}>Список покупок</Header>}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{/*<ShopList list={shopList} dispatch={dispatch}/>*/}\r\n\t\t\t\t\t\t<Footer>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tshopList.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t`Ваш список покупок пуст`\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</> :\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{`В Вашем списке покупок ${shopList.length} элементов. ${shopListDone} выполнено.`}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t{shopListButton}\r\n\t\t\t\t\t\t</Footer>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t</List>\r\n\t\t\t</PullToRefresh>\r\n\t\t\t<InfoSnackbar/>\r\n\t\t</Panel>\r\n\t)\r\n};\r\n\r\nHome.propTypes = {\r\n\tid: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default Home;\r\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {SET_ERROR, SET_MODAL, SET_POPOUT, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport {State} from \"../state\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = process.env.NODE_ENV !== 'development' ? process.env.REACT_APP_BASEURL : process.env.REACT_APP_BASEURL_DEV;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}});\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search)} : {...queryString.parse(window.location.search)},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (!isLoading) return;\r\n\r\n\t\tconst fetchData = async () => {\r\n\t\t\tsetLoading(false);\r\n\t\t\treturn await axios(axiosOptions)\r\n\t\t\t\t.then(async (response) => {\r\n\t\t\t\t\tsetResponse(response.data.data);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: response.data.message}});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tlet e = error?.response ? error.response.data.error : new Error('Проблемы с подключением к API');\r\n\t\t\t\t\tsetError(e);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: e}});\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","export default (e) => {\r\n\tconst validity = e.currentTarget.validity;\r\n\tif (validity.valid && e.currentTarget.value !== ' ') {\r\n\t\treturn {status: 'valid', message: null}\r\n\t} else {\r\n\t\tif (validity.badInput || validity.valueMissing || e.currentTarget.value === ' ') {\r\n\t\t\treturn {status: 'error', message: 'Неверный формат ввода | Отсутствует значение'}\r\n\t\t}\r\n\t\tif (validity.tooLong) {\r\n\t\t\treturn {status: 'error', message: 'Превышена максимальная длина'}\r\n\t\t}\r\n\t\tif (validity.typeMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Несоответствие типа'}\r\n\t\t}\r\n\t\tif (validity.stepMismatch) {\r\n\t\t\treturn {status: 'error', message: 'Слишком большая дробная часть'}\r\n\t\t}\r\n\t\tif (validity.rangeOverflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести будущую дату'}\r\n\t\t\treturn {status: 'error', message: 'Слишком большое число'}\r\n\t\t}\r\n\t\tif (validity.rangeUnderflow) {\r\n\t\t\tif (e.currentTarget.type === 'date') return {status: 'error', message: 'Нельзя ввести дату раньше 1 января 2015'}\r\n\t\t\treturn {status: 'error', message: 'Нельзя вводить отрицательные числа'}\r\n\t\t}\r\n\r\n\t\treturn {status: 'default', message: null}\r\n\t}\r\n}","// const ranges = [\r\n// \t'\\ud83c[\\udf00-\\udfff]', // U+1F300 to U+1F3FF\r\n// \t'\\ud83d[\\udc00-\\ude4f]', // U+1F400 to U+1F64F\r\n// \t'\\ud83d[\\ude80-\\udeff]'  // U+1F680 to U+1F6FF\r\n// ]\r\n//\r\n// const regexp = new RegExp(ranges.join('|'), 'g');\r\nexport default (str) => {\r\n\treturn str.replace(/^\\s*/g, '').replace(/\\s{2,}/g, ' ').replace(/<% RGI_Emoji %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu, '');\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS, SET_EDITED_ITEM} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tsum: '',\r\n\ttitleValidation: {},\r\n\tsumValidation: {}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({dispatch, editedItem}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [apiStr] = useState(() => !editedItem ? '/money-box' : `/money-box/${editedItem._id}`);\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\tdispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t}, [response, dispatch]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.sum\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Карта, наличные, счет в банке'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.titleValidation.status}\r\n\t\t\t\t\t\t bottom={stateForm.titleValidation.message ? stateForm.titleValidation.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {title: regexp(e.currentTarget.value), titleValidation: validate(e)}})}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Баланс счета'} value={stateForm.sum}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t   disabled={!!editedItem}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.sumValidation.status}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.sumValidation.message ? stateForm.sumValidation.message : 'Денежные средства, находящиеся на счете в данный момент'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({type: 'CHANGE_STATE', payload: {sum: e.currentTarget.value.replace(/[^\\d.]*/, ''), sumValidation: validate(e)}})}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import currency from \"../handlers/currency\";\r\nimport React from \"react\";\r\n\r\nexport default ({accounts}) => {\r\n    return accounts.map(item => {\r\n        return (<option key={item._id} value={item._id}>{item.title} ({currency(item.sum)})</option>)\r\n    });\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {format} from 'date-fns';\r\nimport {\r\n\tButton,\r\n\tCheckbox,\r\n\tCounter,\r\n\tDiv,\r\n\tFormLayout,\r\n\tFormLayoutGroup,\r\n\tInput,\r\n\tRadio,\r\n\tSelect,\r\n\tTextarea\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../../handlers/currency\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS, SET_EDITED_ITEM} from \"../../state/actions\";\r\nimport Icon24AddSquareOutline from '@vkontakte/icons/dist/24/add_square_outline';\r\nimport AccountsOptionsList from \"../AccountsOptionsList\";\r\n\r\nconst initialState = {\r\n\taccount: '',\r\n\ttitle: '',\r\n\tdate: format(new Date(), 'yyyy-MM-dd'),\r\n\tincome: false,\r\n\tdescription: '',\r\n\tprice: '',\r\n\tquantity: '',\r\n\ttags: [],\r\n\tboxPrice: false,\r\n\tvalidate: {\r\n\t\taccount: {},\r\n\t\ttitle: {},\r\n\t\tdescription: {},\r\n\t\tprice: {},\r\n\t\tquantity: {},\r\n\t\ttags: {},\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({accounts, id = null, editedItem = null, dispatch, budget, panel = '', shopListItemTitle, setShopListItemTitle, date}) => {\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/item' : `/item/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\tconst [state, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [descriptionShow, setDescriptionShow] = useState(() => !!state.description);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (descriptionShow) return;\r\n\t\tsetDescriptionShow(!!state.description);\r\n\t}, [state.description, descriptionShow]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!shopListItemTitle) return;\r\n\t\tdispatchForm({type: 'CHANGE_STATE', payload: {title: shopListItemTitle}})\r\n\t}, [shopListItemTitle]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\teditedItem.date = format(new Date(editedItem.date), 'yyyy-MM-dd');\r\n\t\tif (editedItem.boxPrice) {\r\n\t\t\teditedItem.price = Number(editedItem.sum).toFixed(2);\r\n\t\t}\r\n\t\tdispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!budget?.title) return;\r\n\t\tif (panel === 'home') return;\r\n\t\tdispatchForm({\r\n\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\tpayload: {\r\n\t\t\t\ttags: editedItem?.tags || budget?.title.toLowerCase().split(' ')\r\n\t\t\t}\r\n\t\t})\r\n\t}, [budget, panel, editedItem]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t}, [response, dispatch]);\r\n\r\n\tconst tags = state.tags.filter(tag => !!tag.length).map(\r\n\t\t(tag, index) =>\r\n\t\t\t<Counter\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tmarginRight: '5px',\r\n\t\t\t\t\tmarginBottom: '5px',\r\n\t\t\t\t\tmaxWidth: '100%',\r\n\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\toverflowWrap: 'normal'\r\n\t\t\t\t}}\r\n\t\t\t\tkey={index}\r\n\t\t\t>\r\n\t\t\t\t{tag}\r\n\t\t\t</Counter>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tdoApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\tdate: state.date,\r\n\t\t\t\t\ttitle: state.title,\r\n\t\t\t\t\tdescription: state.income ? '' : state.description,\r\n\t\t\t\t\tprice: state.boxPrice ? (state.price / state.quantity).toFixed(4) : Number(state.price).toFixed(2),\r\n\t\t\t\t\tquantity: state.quantity,\r\n\t\t\t\t\tincome: state.income,\r\n\t\t\t\t\ttags: state.tags.filter(tag => !!tag.length),\r\n\t\t\t\t\titemFrom: state.account || editedItem?.itemFrom || id,\r\n\t\t\t\t\tboxPrice: state.boxPrice,\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t\tdate: new Date(date),\r\n\t\t\t\t\t\ttzOffset: new Date().getTimezoneOffset()\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tsetShopListItemTitle('');\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Select top={'Счет'}\r\n\t\t\t\t\t\t\tplaceholder={'Выберите счет'}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tdispatchForm({\r\n\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\tpayload: {account: e.currentTarget.value, validateForm: {account: validate(e)}}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdefaultValue={state.account || editedItem?.itemFrom || id} required={true}\r\n\t\t\t\t\t\t\tstatus={state.validate?.account?.status}\r\n\t\t\t\t\t\t\tbottom={state.validate?.account?.message}\r\n\t\t\t>\r\n\t\t\t\t<AccountsOptionsList accounts={accounts} />\r\n\t\t\t</Select>\r\n\t\t\t<Input type={'date'}\r\n\t\t\t\t\t\t top={'Дата'}\r\n\t\t\t\t\t\t value={state.date}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t min={'2015-01-01'}\r\n\t\t\t\t\t\t max={format(new Date(), 'yyyy-MM-dd')}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {date: e.currentTarget.value, validateForm: {date: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t\t\t\t status={state.validate?.date?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.date?.message}\r\n\t\t\t/>\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t placeholder={'Продукт, услуга, товар'}\r\n\t\t\t\t\t\t value={state.title}\r\n\t\t\t\t\t\t top={'Название'}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={20}\r\n\t\t\t\t\t\t status={state.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t title: regexp(e.currentTarget.value),\r\n\t\t\t\t\t\t\t\t\t validateForm: {title: validate(e)}\r\n\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}/>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={false}\r\n\t\t\t\t\t\t defaultChecked={state.income ? null : true}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatchForm({type: 'CHANGE_STATE', payload: {income: false}})\r\n\t\t\t\t\t\t }}\r\n\t\t\t>\r\n\t\t\t\tРасход\r\n\t\t\t</Radio>\r\n\t\t\t<Radio name={'income'}\r\n\t\t\t\t\t\t value={true}\r\n\t\t\t\t\t\t defaultChecked={state.income ? true : null}\r\n\t\t\t\t\t\t onClick={() => {\r\n\t\t\t\t\t\t\t dispatchForm({type: 'CHANGE_STATE', payload: {income: true}})\r\n\t\t\t\t\t\t\t setDescriptionShow(false);\r\n\t\t\t\t\t\t }}\r\n\t\t\t\t\t\t disabled={!!shopListItemTitle}\r\n\t\t\t>\r\n\t\t\t\tДоход\r\n\t\t\t</Radio>\r\n\t\t\t{!state.income\r\n\t\t\t&&\r\n\t\t\t\t<FormLayoutGroup top={'Описание'}>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ttype={'button'}\r\n\t\t\t\t\t\tmode=\"secondary\"\r\n\t\t\t\t\t\tbefore={<Icon24AddSquareOutline/>}\r\n\t\t\t\t\t\tsize=\"l\"\r\n\t\t\t\t\t\tdisabled={state.description || descriptionShow}\r\n\t\t\t\t\t\t// style={state.description ? {display: 'none'} : {}}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetDescriptionShow(true);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tДобавить описание\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t(descriptionShow || state.description) &&\r\n\t\t\t\t\t\t<Textarea top={'Описание'}\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={'Описание товара(продукта, услуги)'}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={state.description}\r\n\t\t\t\t\t\t\t\t\t\t\tmaxLength={70}\r\n\t\t\t\t\t\t\t\t\t\t\tstatus={state.validate?.description?.status}\r\n\t\t\t\t\t\t\t\t\t\t\tbottom={state.validate?.description?.message ? state.validate?.description?.message : `${state.description.length} из 70`}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdispatchForm({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdescription: regexp(e.currentTarget.value),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidateForm: {description: validate(e)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</FormLayoutGroup>\r\n\t\t\t\t}\r\n\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t top={'Теги'}\r\n\t\t\t\t\t\t value={state.tags.join(' ')}\r\n\t\t\t\t\t\t placeholder={'Теги через пробел'}\r\n\t\t\t\t\t\t status={state.validate?.tags?.status}\r\n\t\t\t\t\t\t maxLength={50}\r\n\t\t\t\t\t\t bottom={state.validate?.tags?.message ? state.validate?.tags?.message : `${state.tags.join(' ').length} из 50 символов`}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t tags: e.currentTarget.value !== '' ? regexp(e.currentTarget.value).toLowerCase().split(' ') : [],\r\n\t\t\t\t\t\t\t\t\t validateForm: {tags: validate(e)}\r\n\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\t!!tags.length &&\r\n\t\t\t\tstate.tags.length !== 0\r\n\t\t\t\t&&\r\n\t\t\t\t<Div style={{display: 'flex', flexWrap: 'wrap'}}>\r\n\t\t\t\t\t{tags}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={currency(0)}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t top={'Цена'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={99999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.0001}\r\n\t\t\t\t\t\t status={state.validate?.price?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.price?.message}\r\n\t\t\t\t\t\t value={state.price}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {price: e.currentTarget.value.replace(/[^\\d.]*/, ''), validateForm: {price: validate(e)}}\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\t!state.income\r\n\t\t\t\t&&\r\n\t\t\t\t<Checkbox checked={state.boxPrice}\r\n\t\t\t\t\t\t\t\t\tonChange={() => {\r\n\t\t\t\t\t\t\t\t\t\tdispatchForm({type: 'CHANGE_STATE', payload: {boxPrice: !state.boxPrice}})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tЦена за упаковку\r\n\t\t\t\t</Checkbox>\r\n\t\t\t}\r\n\t\t\t<Input type={'number'}\r\n\t\t\t\t\t\t placeholder={'0'}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t top={'Кол-во'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t max={9999999}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t step={0.001}\r\n\t\t\t\t\t\t status={state.validate?.quantity?.status}\r\n\t\t\t\t\t\t bottom={state.validate?.quantity?.message}\r\n\t\t\t\t\t\t value={state.quantity}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t dispatchForm({\r\n\t\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t quantity: e.currentTarget.value.replace(/[^\\d.]*/, ''),\r\n\t\t\t\t\t\t\t\t\t validateForm: {quantity: validate(e)}\r\n\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t }}\r\n\t\t\t/>\r\n\t\t\t<Button size={'xl'}>\r\n\t\t\t\t{`Сохранить ${state.boxPrice ? currency(state.price) : currency(state.price * state.quantity)}`}\r\n\t\t\t</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import React from 'react';\r\nimport currency from \"../handlers/currency\";\r\n\r\nexport default ({color = 'black', value}) => {\r\n\tif (!value) return null;\r\n\treturn (\r\n\t\t<span style={{color: color}}>\r\n\t\t\t{currency(value)}\r\n\t\t</span>\r\n\t)\r\n}","import React from 'react';\r\nimport {Caption, RichCell} from \"@vkontakte/vkui\";\r\nimport {format} from \"date-fns\";\r\nimport ruLocale from \"date-fns/locale/ru\";\r\nimport currency from \"./currency\";\r\nimport {SET_EDITED_ITEM, SET_MODAL} from \"../state/actions\";\r\nimport Color from \"../components/Color\";\r\n\r\nexport default function mapRichCell(dispatch) {\r\n\treturn (item, index) => {\r\n\t\tif (item?.caption) {\r\n\t\t\treturn (\r\n\t\t\t\t<Caption level=\"2\" weight=\"semibold\" caps\r\n\t\t\t\t\t\t\t\t key={index}>\r\n\t\t\t\t\t{format(new Date(item?.date), 'dd MMMM yyyy ', {locale: ruLocale})}\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t{item?.income && item?.outcome ? ' [ ' : null}\r\n\t\t\t\t\t<Color value={item?.income} color={'green'}/>\r\n\t\t\t\t\t{item?.income && item?.outcome ? ' | ' : null}\r\n\t\t\t\t\t<Color value={item?.outcome} color={'red'}/>\r\n\t\t\t\t\t{item?.income && item?.outcome ? ' ]' : null}\r\n\t\t\t\t</Caption>\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tconst tags = item?.tags.filter(tag => !!tag.length).map(\r\n\t\t\t(tag, index) =>\r\n\t\t\t\t<span key={index} style={{\r\n\t\t\t\t\tmarginLeft: '5px',\r\n\t\t\t\t\tmarginRight: '5px',\r\n\t\t\t\t\tmarginBottom: '5px',\r\n\t\t\t\t\tmaxWidth: '100%',\r\n\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\toverflowWrap: 'normal',\r\n\t\t\t\t\t// background: 'var(--counter_secondary_background)',\r\n\t\t\t\t\t// color: 'var(--counter_secondary_text)',\r\n\t\t\t\t\t// padding: '5px'\r\n\t\t\t\t}}><b>{tag}</b></span>\r\n\t\t);\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={item?.tags.length !== 0 && <div style={{display: 'flex', flexWrap: 'wrap'}}><span>Теги:</span> {tags}</div>}\r\n\t\t\t\tafter={item?.income ? currency(item?.sum) : currency(-1 * item?.sum)}\r\n\t\t\t\tdata-id={item?._id}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: item}});\r\n\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t};\r\n}","import compareAsc from \"date-fns/compareAsc\";\r\n\r\nexport default function (a, b){\r\n\tconst aDate = new Date(a.date);\r\n\tconst bDate = new Date(b.date);\r\n\treturn compareAsc(bDate, aDate);\r\n}","import React, {useRef, useState, useEffect} from 'react';\r\nimport {FormLayout, Search} from \"@vkontakte/vkui\";\r\n\r\nexport default ({onSearch}) => {\r\n\r\n\tconst [searchStr, setSearchStr] = useState('');\r\n\tconst searchRef = useRef(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tonSearch(searchStr);\r\n\t}, [searchStr, onSearch])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={(e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsearchRef.current.focus();\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Search\r\n\t\t\t\tvalue={searchStr}\r\n\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\tsetSearchStr(e.currentTarget.value.substring(0, 20))\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</FormLayout>\r\n\t\t<input type={'radio'} style={{position: 'absolute', height: '0', width: '0', top: '0', left: '0'}} ref={searchRef}/>\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport useApi from \"../handlers/useApi\";\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter, Gallery,\r\n\tHeader,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext,\r\n\tTitle\r\n} from \"@vkontakte/vkui\";\r\nimport currency from \"../handlers/currency\";\r\nimport Group from \"@vkontakte/vkui/dist/components/Group/Group\";\r\nimport {\r\n\tSET_ACCOUNTS,\r\n\tSET_BUDGETS,\r\n\tSET_EDITED_ITEM,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_TOGGLE_CONTEXT\r\n} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport Icon28EditOutline from \"@vkontakte/icons/dist/28/edit_outline\";\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport SearchForm from \"../components/SearchForm\";\r\nimport Icon28MoneyTransfer from \"@vkontakte/icons/dist/28/money_transfer\";\r\n\r\nexport default ({id, account, dispatch, onRefresh, context, date, scheme}) => {\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [{response}, doApiFetch] = useApi(`/money-box/${account?._id}`);\r\n\tconst [accountContext, setAccountContext] = useState(true);\r\n\tconst [items, setItems] = useState(() => {\r\n\t\tif (!account) return [];\r\n\t\treturn account?.operations;\r\n\t});\r\n\tconst [searchStr, setSearchStr] = useState('');\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items || []);\r\n\r\n\tconst indexAr = filteredItems.sort(sort).reduce((prev, curr) => {\r\n\t\tconst index = +new Date(curr.date);\r\n\t\tif (prev[index]) {\r\n\t\t\tprev[index] = [...prev[index], curr];\r\n\t\t} else {\r\n\t\t\tprev[index] = [curr];\r\n\t\t}\r\n\t\treturn prev;\r\n\t}, {});\r\n\r\n\tlet accountItemsListArray = [];\r\n\r\n\tObject.keys(indexAr).forEach(key => {\r\n\t\tconst items = indexAr[key];\r\n\t\tlet date = '';\r\n\t\tindexAr[key].income = 0;\r\n\t\tindexAr[key].outcome = 0;\r\n\t\titems.forEach(item => {\r\n\t\t\tdate = item.date;\r\n\t\t\taccountItemsListArray.splice(0,0, item);\r\n\t\t\tif (item.income) {\r\n\t\t\t\tindexAr[key].income += item.sum;\r\n\t\t\t} else {\r\n\t\t\t\tindexAr[key].outcome += item.sum;\r\n\t\t\t}\r\n\t\t})\r\n\t\tindexAr[key].income = indexAr[key].income.toFixed(2);\r\n\t\tindexAr[key].outcome = indexAr[key].outcome.toFixed(2);\r\n\t\taccountItemsListArray.splice(0,0,{date: date, income: indexAr[key].income, outcome: indexAr[key].outcome, caption: true})\r\n\t})\r\n\r\n\tconst accountItemsList = accountItemsListArray.sort(sort).map(mapRichCell(dispatch));\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\tconst alert = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE',\r\n\t\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t\tdate: date\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить счет?</h2>\r\n\t\t\t<p>Удаление счета приведет к удалению всех данных по доходам и расходам, привязанным к данному счету. Суммы\r\n\t\t\t\tбюджетов могут отображаться некорректно.</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tconst accountContextView = (\r\n\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t<List>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\tbefore={<Icon28EditOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: account}});\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-account'}});\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tРедактировать счет\r\n\t\t\t\t</Cell>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alert, alert: true}})\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tУдалить счет {account?.title}\r\n\t\t\t\t</Cell>\r\n\t\t\t</List>\r\n\t\t</PanelHeaderContext>\r\n\t);\r\n\tconst itemContextView = (\r\n\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t<List>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\tbefore={<Icon28MarketAddBadgeOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tДобавить\r\n\t\t\t\t</Cell>\r\n\t\t\t\t<Cell\r\n\t\t\t\t\tbefore={<Icon28MoneyTransfer/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'transfer-money'}});\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tПеревести\r\n\t\t\t\t</Cell>\r\n\t\t\t</List>\r\n\t\t</PanelHeaderContext>\r\n\t)\r\n\r\n\tconst contextView = accountContext ? accountContextView : itemContextView;\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!account) return;\r\n\t\tsetItems(account?.operations);\r\n\t\tsetFilteredItems(account?.operations);\r\n\t}, [account]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t}, [dispatch, response]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t}, [context]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (searchStr === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(account?.operations.filter(({title}) => title.toLowerCase().indexOf(searchStr.toLowerCase()) > -1));\r\n\t\t}\r\n\t}, [searchStr, account, items]);\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tsetSearchStr(str);\r\n\t}\r\n\r\n\tconst incomeSum = account?.operations?.filter(item => !!item.income).reduce((acc, cur) => acc + cur.sum, 0);\r\n\tconst outcomeSum = account?.operations?.filter(item => !item.income).reduce((acc, cur) => acc + cur.sum, 0);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK})\r\n\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetAccountContext(false);\r\n\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={account && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetAccountContext(true);\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{account ? account?.title : 'Счет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\taccount\r\n\t\t\t\t&&\r\n\t\t\t\t<>\r\n\t\t\t\t\t{contextView}\r\n\t\t\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\r\n\t\t\t\t\t<SearchForm onSearch={onSearch}/>\r\n\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\theader={<Header mode=\"secondary\">Информация по счету</Header>}\r\n\t\t\t\t\t\tseparator=\"show\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Gallery\r\n\t\t\t\t\t\t\tslideWidth={'100%'}\r\n\t\t\t\t\t\t\tbullets={scheme === 'client_light' || scheme === 'bright_light' ? 'dark' : 'light'}\r\n\t\t\t\t\t\t\tstyle={{height: 'auto'}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t\t<Title level={'3'} weight={'semibold'}>Остаток по счету</Title>\r\n\t\t\t\t\t\t\t\t<Title level=\"1\" weight=\"bold\" style={{marginBottom: 16}}>{currency(account?.sum)}</Title>\r\n\r\n\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t\t<Title level=\"3\" weight=\"semibold\" style={{marginBottom: 16}}>Доход: {currency(incomeSum || 0)}</Title>\r\n\t\t\t\t\t\t\t\t<Title level=\"3\" weight=\"semibold\" style={{marginBottom: 16}}>Расход: {currency(-1*outcomeSum || 0)}</Title>\r\n\t\t\t\t\t\t\t\t<Title level=\"3\" weight=\"semibold\" style={{marginBottom: 16}}>Баланс: {currency(incomeSum - outcomeSum)}</Title>\r\n\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t</Gallery>\r\n\r\n\r\n\t\t\t\t\t\t{account?.operations.length === 0 && <Footer>Операций по счету еще не было</Footer>}\r\n\t\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t\t{accountItemsList}\r\n\t\t\t\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect} from 'react';\r\nimport {format} from 'date-fns';\r\nimport ruLocale from 'date-fns/locale/ru';\r\nimport {FixedLayout, Footer, Group, Header, Panel, PanelHeader, PanelHeaderButton, PromoBanner} from \"@vkontakte/vkui\";\r\nimport ListOfItems from \"../components/ListOfItems\";\r\nimport {SET_MODAL} from \"../state/actions\";\r\nimport Icon28ListAddOutline from \"@vkontakte/icons/dist/28/list_add_outline\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\n\r\nexport default ({id, budgets, dispatch, date = new Date(), onRefresh, bannerData, setBannerData}) => {\r\n\t// let budgetsStartSum = budgets.map(el => el.startSum).reduce((acc, cur) => acc + cur, 0);\r\n\t// let incomeBudgetSum = budgets.map(el => el.items).flat().map(item => item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0);\r\n\t// let outcomeBudgetsSum = budgets.map(el => el.items).flat().map(item => !item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0);\r\n\r\n\tuseEffect(() => {\r\n\t\tbridge.send('VKWebAppGetAds', {});\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<PanelHeaderButton onClick={() => dispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})}>\r\n\t\t\t\t\t\t<Icon28ListAddOutline/>\r\n\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tБюджеты\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh} />\r\n\t\t\t<Group\r\n\t\t\t\theader={<Header mode=\"secondary\">Ваши бюджеты\r\n\t\t\t\t\tна {format(new Date(date), 'dd MMMM yyyy', {locale: ruLocale})}</Header>}\r\n\t\t\t\t// separator=\"show\"\r\n\t\t\t>\r\n\t\t\t\t<ListOfItems data={budgets} dispatch={dispatch} showAll={true} itemsName={'budgets'} needHide={false}/>\r\n\t\t\t\t<Footer>Цифры напротив бюджета отображают сколько Вы можете еще потратить, но помните, что могут быть смежные траты, которые относятся к нескольким бюджетам. Проверяйте внимательно.</Footer>\r\n\t\t\t</Group>\r\n\t\t\t<FixedLayout vertical={\"bottom\"}>\r\n\t\t\t\t{bannerData && <PromoBanner bannerData={bannerData} onClose={() => setBannerData(null)}/>}\r\n\t\t\t</FixedLayout>\r\n\t\t\t<InfoSnackbar/>\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {Button, FormLayout, Input} from \"@vkontakte/vkui\";\r\nimport useApi from \"../../handlers/useApi\";\r\nimport validate from \"../../handlers/validate\";\r\nimport currency from \"../../handlers/currency\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS, SET_EDITED_ITEM} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n\ttitle: '',\r\n\tstartSum: '',\r\n\tvalidate: {\r\n\t\ttitle: {},\r\n\t\tstartSum: {}\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'CHANGE_STATE':\r\n\t\t\tconst {payload: {validateForm, ...payload}} = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...payload,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({dispatch, editedItem = null, date}) => {\r\n\tconst [stateForm, dispatchForm] = useReducer(reducer, initialState);\r\n\tconst [apiStr] = useState(() => {\r\n\t\treturn !editedItem ? '/budget' : `/budget/${editedItem._id}`;\r\n\t})\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editedItem) return;\r\n\t\tif (!response) dispatchForm({type: 'CHANGE_STATE', payload: {...editedItem}});\r\n\t}, [editedItem, dispatchForm, response]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t}, [response, dispatch]);\r\n\r\n\treturn (\r\n\t\t<FormLayout\r\n\t\t\tonSubmit={async e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\tmethod: !editedItem ? 'POST' : 'PATCH',\r\n\t\t\t\t\ttitle: stateForm.title,\r\n\t\t\t\t\tsum: stateForm.startSum,\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t\tdate: new Date(date)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Input type={'text'} placeholder={'Название бюджета'} top={'Название'} value={stateForm.title}\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t maxLength={'20'}\r\n\t\t\t\t\t\t status={stateForm.validate?.title?.status}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.title?.message ? stateForm.validate?.title?.message : `${stateForm.title.length} из 20`}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {title: regexp(e.currentTarget.value), validateForm: {title: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Input type={'number'} placeholder={currency(0)} top={'Бюджет в рублях'} value={stateForm.startSum}\r\n\t\t\t\t\t\t pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n\t\t\t\t\t\t inputMode=\"decimal\"\r\n\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t status={stateForm.validate?.startSum?.status}\r\n\t\t\t\t\t\t min={0}\r\n\t\t\t\t\t\t max={999999999}\r\n\t\t\t\t\t\t step={0.01}\r\n\t\t\t\t\t\t bottom={stateForm.validate?.startSum?.message ? stateForm.validate?.startSum?.message : 'Сколько вы готовы на это потратить?'}\r\n\t\t\t\t\t\t onChange={e => dispatchForm({\r\n\t\t\t\t\t\t\t type: 'CHANGE_STATE',\r\n\t\t\t\t\t\t\t payload: {startSum: e.currentTarget.value, validateForm: {startSum: validate(e)}}\r\n\t\t\t\t\t\t })}/>\r\n\t\t\t<Button size={'xl'}>Сохранить</Button>\r\n\t\t</FormLayout>\r\n\t)\r\n}","import isEqual from \"date-fns/isEqual\";\r\n\r\nexport default function (prev, curr) {\r\n\tif (isEqual(new Date(prev[prev.length-1]?.date), new Date(curr.date))) {\r\n\t\treturn [...prev, curr];\r\n\t} else {\r\n\t\treturn [...prev, {date: curr.date, caption: true}, curr];\r\n\t}\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {\r\n\tAlert,\r\n\tCell,\r\n\tDiv,\r\n\tFooter,\r\n\tGroup,\r\n\tList,\r\n\tMiniInfoCell,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderButton,\r\n\tPanelHeaderContent,\r\n\tPanelHeaderContext\r\n} from \"@vkontakte/vkui\";\r\nimport {\r\n\tSET_ACCOUNTS, SET_BUDGETS,\r\n\tSET_EDITED_ITEM,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_POPOUT,\r\n\tSET_TOGGLE_CONTEXT\r\n} from \"../state/actions\";\r\nimport Icon28MarketAddBadgeOutline from \"@vkontakte/icons/dist/28/market_add_badge_outline\";\r\nimport useApi from \"../handlers/useApi\";\r\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport Icon28EditOutline from '@vkontakte/icons/dist/28/edit_outline';\r\nimport Icon20PinOutline from '@vkontakte/icons/dist/20/pin_outline';\r\nimport Icon20Add from '@vkontakte/icons/dist/20/add';\r\nimport Icon20BombOutline from '@vkontakte/icons/dist/20/bomb_outline';\r\nimport mapRichCell from \"../handlers/mapRichCell\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport sort from \"../handlers/sort\";\r\nimport reduce from \"../handlers/reduce\";\r\nimport currency from \"../handlers/currency\";\r\nimport SearchForm from \"../components/SearchForm\";\r\nimport {differenceInMonths} from 'date-fns';\r\n\r\nexport default ({id, budget, dispatch, context, date}) => {\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [{response}, doApiFetch] = useApi(`/budget/${budget?._id}`);\r\n\tconst [items, setItems] = useState(() => budget?.items);\r\n\tconst [filteredItems, setFilteredItems] = useState(() => items);\r\n\tconst [searchStr, setSearchStr] = useState('');\r\n\r\n\tuseEffect(() => {\r\n\t\tsetItems(budget?.items);\r\n\t\tsetFilteredItems(budget?.items);\r\n\t}, [budget])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tif (response?.deletedCount) {\r\n\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t}\r\n\t\tdispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n\t\tdispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t}, [context]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (searchStr === '') {\r\n\t\t\tsetFilteredItems(items);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(budget.items.filter(({title}) => title.toLowerCase().indexOf(searchStr.toLowerCase()) > -1));\r\n\t\t}\r\n\t}, [searchStr, budget, items]);\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\r\n\tconst alertDelete = (\r\n\t\t<Alert\r\n\t\t\tactions={[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tmode: \"cancel\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\taction: async () => {\r\n\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\tawait doApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'DELETE',\r\n\t\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t\tdate: date\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]}\r\n\t\t\tonClose={() => {\r\n\t\t\t\ttoggleContext();\r\n\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h2>Удалить бюджет?</h2>\r\n\t\t\t<p>Вы действительно хотите удалить бюджет?</p>\r\n\t\t</Alert>\r\n\t)\r\n\r\n\tconst itemsList = filteredItems && filteredItems.sort(sort).reduce(reduce, []).map(mapRichCell(dispatch));\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tsetSearchStr(str);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t{differenceInMonths(new Date(), new Date(date)) === 0 &&\r\n\t\t\t\t\t\t<PanelHeaderButton\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Icon28MarketAddBadgeOutline/>\r\n\t\t\t\t\t\t</PanelHeaderButton>\r\n\t\t\t\t\t}\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={budget && <Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\t{budget ? budget?.title : 'Бюджет удалён'}\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t{\r\n\t\t\t\tbudget &&\r\n\t\t\t\t<>\r\n\t\t\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28EditOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_EDITED_ITEM, payload: {item: budget}})\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-budget'}})\r\n\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tИзменить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline/>}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: alertDelete, alert: true}})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tУдалить бюджет {budget?.title}\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</PanelHeaderContext>\r\n\t\t\t\t\t<SearchForm onSearch={onSearch}/>\r\n\t\t\t\t\t<Group>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20PinOutline/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПервоначальная сумма {currency(budget.startSum)}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20Add/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tДобавлено в\r\n\t\t\t\t\t\t\tбюджет {currency(budget.items.map(item => item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0))}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t\t<MiniInfoCell\r\n\t\t\t\t\t\t\tbefore={<Icon20BombOutline/>}\r\n\t\t\t\t\t\t\tmode={'base'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПотрачено {currency(budget.items.map(item => !item.income ? item.sum : 0).reduce((acc, cur) => acc + cur, 0))}\r\n\t\t\t\t\t\t</MiniInfoCell>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t\t<Div>\r\n\t\t\t\t\t\t{itemsList}\r\n\t\t\t\t\t\t{itemsList?.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t<InfoSnackbar/>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {Footer, Group, Panel, PanelHeader} from \"@vkontakte/vkui\";\r\nimport MonthSwitch from \"../components/MonthSwitch\";\r\nimport mapStats from \"../handlers/mapStats\";\r\nimport SearchForm from \"../components/SearchForm\";\r\n\r\nexport default ({id, accounts, onRefresh}) => {\r\n\tconst [operations, setOperations] = useState(() => {\r\n\t\treturn accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t});\r\n\tconst [searchStr, setSearchStr] = useState('');\r\n\tconst [filteredItems, setFilteredItems] = useState(() => operations);\r\n\tconst reducer = (prev, curr) => {\r\n\t\tif (prev[prev.length - 1]?.title === curr.title) {\r\n\t\t\tconst prevItem = prev[prev.length - 1];\r\n\t\t\tprevItem.sum = prevItem.sum + curr.sum;\r\n\t\t\tprevItem.quantity += curr.quantity;\r\n\t\t\tconst array = [...prev.slice(0, prev.length - 1), prevItem];\r\n\t\t\treturn [...array];\r\n\t\t} else {\r\n\t\t\treturn [...prev, {title: curr.title, sum: curr.sum, quantity: curr.quantity}];\r\n\t\t}\r\n\t}\r\n\r\n\tconst accountItemsList = filteredItems\r\n\t\t.reduce(reducer, [])\r\n\t\t.map(mapStats());\r\n\r\n\tuseEffect(() => {\r\n\t\tconst items = accounts\r\n\t\t\t.map(item => item.operations)\r\n\t\t\t.flat()\r\n\t\t\t.filter(({income}) => !income)\r\n\t\t\t.sort((a, b) => a.title.localeCompare(b.title));\r\n\t\tsetOperations(items);\r\n\t\tsetFilteredItems(items);\r\n\t}, [accounts]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (searchStr === '') {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tsetFilteredItems(accounts\r\n\t\t\t\t.map(item => item.operations)\r\n\t\t\t\t.flat()\r\n\t\t\t\t.filter(({income}) => !income)\r\n\t\t\t\t.sort((a, b) => a.title.localeCompare(b.title))\r\n\t\t\t\t.filter(({title}) => title.toLowerCase().indexOf(searchStr.toLowerCase()) > -1));\r\n\t\t}\r\n\t}, [searchStr, accounts]);\r\n\r\n\tconst onSearch = (str) => {\r\n\t\tsetSearchStr(str);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>\r\n\t\t\t\tСводка\r\n\t\t\t</PanelHeader>\r\n\t\t\t<MonthSwitch onRefresh={onRefresh}/>\r\n\t\t\t<SearchForm onSearch={onSearch}/>\r\n\t\t\t<Group>\r\n\t\t\t\t{accountItemsList}\r\n\t\t\t\t{accountItemsList.length === 0 && <Footer>Нет данных для отображения</Footer>}\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t)\r\n}","import React from 'react';\r\nimport {RichCell} from \"@vkontakte/vkui\";\r\nimport currency from \"./currency\";\r\n\r\nexport default () => {\r\n\treturn (item, index) => {\r\n\t\treturn (\r\n\t\t\t<RichCell\r\n\t\t\t\tdisabled\r\n\t\t\t\tkey={index}\r\n\t\t\t\tmultiline\r\n\t\t\t\tcaption={`Кол-во: ${(item?.quantity).toFixed(3)} | Ср. цена: ${currency((item?.sum/item?.quantity).toFixed(2))}`}\r\n\t\t\t\tafter={currency(item?.sum)}\r\n\t\t\t\tdata-title={item?.title}\r\n\t\t\t>\r\n\t\t\t\t{item?.title}\r\n\t\t\t</RichCell>\r\n\t\t)\r\n\t}\r\n}","import React from 'react';\r\nimport {Button, FixedLayout, Panel, Placeholder, PromoBanner, Spinner} from \"@vkontakte/vkui\";\r\nimport {SET_ACTIVE_VIEW} from \"../state/actions\";\r\nimport Icon36Done from '@vkontakte/icons/dist/36/done';\r\n\r\nexport default ({id, dispatch, loading, bannerData, setBannerData}) => {\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={loading ? <Spinner size=\"large\"/> : <Icon36Done/>}\r\n\t\t\t\taction={\r\n\t\t\t\t\t!loading && <Button\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tdispatch({type: SET_ACTIVE_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tid={'initial-button'}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tЗапустить\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t}\r\n\t\t\t\tstretched\r\n\t\t\t>\r\n\t\t\t\t{loading ? 'Подготавливаем приложение к запуску' : 'Приложение готово'}\r\n\t\t\t</Placeholder>\r\n\t\t\t<FixedLayout vertical={\"bottom\"}>\r\n\t\t\t\t{bannerData && <PromoBanner bannerData={bannerData} onClose={() => setBannerData(null)}/>}\r\n\t\t\t</FixedLayout>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport {Cell, FixedLayout, Group, Header, Panel, PanelHeader, PromoBanner} from \"@vkontakte/vkui\";\r\nimport Icon28ShareExternalOutline from '@vkontakte/icons/dist/28/share_external_outline';\r\nimport Icon28Users3Outline from '@vkontakte/icons/dist/28/users_3_outline';\r\nimport Icon28AddCircleOutline from '@vkontakte/icons/dist/28/add_circle_outline';\r\nimport Icon28ListCheckOutline from '@vkontakte/icons/dist/28/list_check_outline';\r\nimport {SET_ACTIVE_VIEW} from \"../state/actions\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\n\r\nexport default ({id, dispatch, bannerData, setBannerData, addToHomeScreenSupported, addedToHomeScreen}) => {\r\n    const [lastClickTime, setLastClickTime] = useState(0);\r\n    const userId = new URL(window.location.href).searchParams.get('vk_user_id');\r\n\r\n    useEffect(() => {\r\n        bridge.send('VKWebAppGetAds', {});\r\n    }, []);\r\n\r\n    return (\r\n        <Panel id={id}>\r\n            <PanelHeader>Ещё</PanelHeader>\r\n            <Group>\r\n                <Cell\r\n                    expandable\r\n                    before={<Icon28ListCheckOutline/>}\r\n                    onClick={() => {\r\n                        dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'more', panel: 'shop-list'}})\r\n                    }}\r\n                >Список покупок</Cell>\r\n            </Group>\r\n            <Group\r\n                header={\r\n                    <Header\r\n                        mode=\"secondary\"\r\n                    >\r\n                        Дополнительно\r\n                    </Header>\r\n                }\r\n            >\r\n                <Cell\r\n                    expandable\r\n                    before={\r\n                        <Icon28ShareExternalOutline/>\r\n                    }\r\n                    onClick={() => {\r\n                        if (+new Date() - lastClickTime > 1000) {\r\n                            bridge.send(\"VKWebAppShare\", {link: `https://vk.com/zlabz_balance#ref=${userId}`})\r\n                            setLastClickTime(+new Date())\r\n                        }\r\n                    }}\r\n                >\r\n                    Поделиться\r\n                </Cell>\r\n                <Cell\r\n                    expandable\r\n                    before={<Icon28Users3Outline/>}\r\n                    onClick={() => {\r\n                        if (+new Date() - lastClickTime > 1000) {\r\n                            bridge.send('VKWebAppJoinGroup', {group_id: 195358095})\r\n                            setLastClickTime(+new Date())\r\n                        }\r\n                    }}\r\n                >\r\n                    Присоединиться к Балансу\r\n                </Cell>\r\n\r\n                {addToHomeScreenSupported && !addedToHomeScreen && <Cell\r\n                    expandable\r\n                    before={<Icon28AddCircleOutline/>}\r\n                    onClick={() => {\r\n                        bridge.send('VKWebAppAddToHomeScreen');\r\n                    }}\r\n                >\r\n                    Добавить на главный экран\r\n                </Cell>}\r\n            </Group>\r\n            {\r\n                userId === process.env.REACT_APP_ID &&\r\n                <Group\r\n                    header={\r\n                        <Header\r\n                            mode={'secondary'}\r\n                        >\r\n                            Admin Mode\r\n                        </Header>\r\n                    }\r\n                >\r\n                    <Cell\r\n                        expandable\r\n                        onClick={() => {\r\n                            dispatch({type: SET_ACTIVE_VIEW, payload: {view: 'more', panel: 'stats'}})\r\n                        }}\r\n                    >\r\n                        Статистика\r\n                    </Cell>\r\n                </Group>\r\n            }\r\n            <FixedLayout vertical={\"bottom\"}>\r\n                <InfoSnackbar/>\r\n                {bannerData && <PromoBanner bannerData={bannerData} onClose={() => setBannerData(null)}/>}\r\n            </FixedLayout>\r\n        </Panel>\r\n    )\r\n}","import React, {useEffect, useReducer, useState} from 'react';\r\nimport {\r\n\tCell,\r\n\tFooter,\r\n\tFormLayout,\r\n\tInput,\r\n\tList,\r\n\tPanel,\r\n\tPanelHeader,\r\n\tPanelHeaderBack,\r\n\tPanelHeaderContent, PanelHeaderContext\r\n} from \"@vkontakte/vkui\";\r\nimport {SET_HISTORY_BACK, SET_MODAL, SET_SUCCESS_MESSAGE, SET_TOGGLE_CONTEXT} from \"../state/actions\";\r\nimport InfoSnackbar from \"../components/InfoSnackbar\";\r\nimport regexp from \"../handlers/regexp\";\r\nimport validate from \"../handlers/validate\";\r\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\r\nimport Icon28DeleteOutline from '@vkontakte/icons/dist/28/delete_outline';\r\nimport Icon28DoneOutline from '@vkontakte/icons/dist/28/done_outline';\r\n\r\nconst initialState = {\r\n\tlist: [],\r\n\titem: {\r\n\t\tid: 1,\r\n\t\ttitle: '',\r\n\t\tdone: false\r\n\t},\r\n\tid: null,\r\n\tvalidate: {\r\n\t\ttitle: {}\r\n\t}\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'INITIAL_LIST': {\r\n\t\t\tconst index = action.payload.list[action.payload.list.length - 1] ? action.payload.list[action.payload.list.length - 1].id : 1;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlist: action.payload.list,\r\n\t\t\t\titem: {\r\n\t\t\t\t\tid: index + 1,\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tdone: false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'SET_TITLE': {\r\n\t\t\tconst {payload: {validateForm, title}} = action;\r\n\t\t\tconst item = {\r\n\t\t\t\tid: state.item.id,\r\n\t\t\t\ttitle: title,\r\n\t\t\t\tdone: false\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titem,\r\n\t\t\t\tvalidate: {...state.validate, ...validateForm}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'SET_ID': {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tid: action.payload.id\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'SET_ITEM_TO_LIST': {\r\n\t\t\tconst newList = [...state.list, state.item];\r\n\t\t\tconst index = newList[newList.length - 1] ? newList[newList.length - 1].id : 1;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlist: newList,\r\n\t\t\t\titem: {title: '', done: false, id: index + 1},\r\n\t\t\t\tvalidate: {\r\n\t\t\t\t\ttitle: {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'SET_DONE': {\r\n\t\t\tconst {list} = state;\r\n\t\t\tconst {id} = action.payload;\r\n\t\t\tconst index = list.findIndex((item) => item.id === id);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tlist[index].done = !list[index].done;\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlist\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'DELETE_ITEM': {\r\n\t\t\tconst {list} = state;\r\n\t\t\tconst {id} = action.payload;\r\n\t\t\tconst index = list.findIndex((item) => item.id === id);\r\n\t\t\tlist.splice(index, 1);\r\n\t\t\tif (list.length === 0) {\r\n\t\t\t\tlocalStorage.removeItem('shopList');\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlist\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport default ({id, dispatch, shopListFromServer, setShopListItemTitle, setShopList, context, success}) => {\r\n\r\n\tconst [state, dispatchList] = useReducer(reducer, initialState);\r\n\tconst [isOpened, setIsOpened] = useState(() => context);\r\n\tconst [deleteMode, setDeleteMode] = useState(false);\r\n\tconst shopList =\r\n\t\tshopListFromServer.length\r\n\t\t\t?\r\n\t\t\tstate.list.map((item) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tkey={item.id}\r\n\t\t\t\t\t\tselectable={!deleteMode}\r\n\t\t\t\t\t\tremovable={deleteMode}\r\n\t\t\t\t\t\tchecked={item.done}\r\n\t\t\t\t\t\tdisabled={deleteMode ? false : item.done}\r\n\t\t\t\t\t\tonChange={() => {\r\n\t\t\t\t\t\t\tsetShopListItemTitle(shopListFromServer[shopListFromServer.findIndex(i => i.id === item.id)].title);\r\n\t\t\t\t\t\t\tdispatchList({type: 'SET_ID', payload: {id: item.id}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-money'}});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonRemove={() => {\r\n\t\t\t\t\t\t\tdispatchList({type: 'DELETE_ITEM', payload: {id: item.id}});\r\n\t\t\t\t\t\t\tsetShopList(state.list);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{item.title}\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\t:\r\n\t\t\t<Footer>Список покупок пуст</Footer>\r\n\t;\r\n\r\n\tconst toggleContext = () => {\r\n\t\tdispatch({type: SET_TOGGLE_CONTEXT, payload: {context: !isOpened}});\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsOpened(context);\r\n\t}, [context]);\r\n\r\n\tuseEffect(() => {\r\n\t\tdispatchList({type: 'INITIAL_LIST', payload: {list: shopListFromServer}});\r\n\t}, [shopListFromServer]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (state.list.length === 0) return;\r\n\t\tsetShopList(state.list);\r\n\t}, [state.list, setShopList]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!success) return;\r\n\t\tdispatchList({type: 'SET_DONE', payload: {id: state.id}});\r\n\t}, [success, state.id]);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={\r\n\t\t\t\t\t<PanelHeaderBack onClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<PanelHeaderContent\r\n\t\t\t\t\taside={<Icon16Dropdown style={{transform: `rotate(${isOpened ? '180deg' : '0'})`}}/>}\r\n\t\t\t\t\tonClick={toggleContext}\r\n\t\t\t\t>\r\n\t\t\t\t\tСписок покупок\r\n\t\t\t\t</PanelHeaderContent>\r\n\t\t\t</PanelHeader>\r\n\t\t\t<PanelHeaderContext opened={isOpened} onClose={toggleContext}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!deleteMode\r\n\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\tbefore={<Icon28DeleteOutline />}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\tsetDeleteMode(true);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tРежим удаления\r\n\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdeleteMode\r\n\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\tbefore={<Icon28DoneOutline />}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\ttoggleContext();\r\n\t\t\t\t\t\t\t\t\tsetDeleteMode(false);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tРежим выполнения\r\n\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t}\r\n\t\t\t\t</List>\r\n\t\t\t</PanelHeaderContext>\r\n\t\t\t<FormLayout\r\n\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tdispatchList({type: 'SET_ITEM_TO_LIST'});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Input type={'text'}\r\n\t\t\t\t\t\t\t disabled={deleteMode}\r\n\t\t\t\t\t\t\t placeholder={'Продукт, услуга, товар'}\r\n\t\t\t\t\t\t\t value={state.item.title}\r\n\t\t\t\t\t\t\t top={'Название'}\r\n\t\t\t\t\t\t\t required={true}\r\n\t\t\t\t\t\t\t maxLength={20}\r\n\t\t\t\t\t\t\t status={state.validate?.title?.status}\r\n\t\t\t\t\t\t\t bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.item.title.length} из 20`}\r\n\t\t\t\t\t\t\t onChange={(e) => {\r\n\t\t\t\t\t\t\t\t dispatchList({\r\n\t\t\t\t\t\t\t\t\t type: 'SET_TITLE',\r\n\t\t\t\t\t\t\t\t\t payload: {\r\n\t\t\t\t\t\t\t\t\t\t title: regexp(e.currentTarget.value),\r\n\t\t\t\t\t\t\t\t\t\t validateForm: {title: validate(e)}\r\n\t\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t\t })\r\n\t\t\t\t\t\t\t }}/>\r\n\t\t\t</FormLayout>\r\n\t\t\t<List>\r\n\t\t\t\t{shopList}\r\n\t\t\t</List>\r\n\t\t\t<InfoSnackbar/>\r\n\t\t</Panel>\r\n\t)\r\n}","import React, {useState} from 'react';\r\nimport {Button, FormLayout, Group, Header, InfoRow, Input, Panel, PanelHeader, SimpleCell} from \"@vkontakte/vkui\";\r\nimport useApi from \"../handlers/useApi\";\r\nimport {format, startOfDay, endOfDay, startOfMonth, endOfMonth} from \"date-fns\";\r\n\r\n/**\r\n * Получение временного периода\r\n * @param ts: Number - timestamp для получения периода\r\n * @param opt {{ts: Boolean, month: Boolean, day: Boolean}}\r\n * @returns {{end: Number | Date, begin: Number | Date}}\r\n */\r\nconst getDateRange = (ts, opt) => {\r\n    const beginDay = !opt.ts ? startOfDay(new Date(ts)) : startOfDay(+new Date(ts));\r\n    const endDay = !opt.ts ? endOfDay(new Date(ts)) : endOfDay(+new Date(ts));\r\n    const beginMonth = !opt.ts ? startOfMonth(new Date(ts)) : startOfMonth(+new Date(ts));\r\n    const endMonth = !opt.ts ? endOfMonth(new Date(ts)) : endOfMonth(+new Date(ts));\r\n\r\n    if (opt.month) {\r\n        return {\r\n            begin: beginMonth,\r\n            end: endMonth\r\n        }\r\n    }\r\n    return {\r\n        begin: beginDay,\r\n        end: endDay\r\n    }\r\n}\r\n\r\nconst getUserAgentArray = (array, userAgent) => {\r\n    return array?.map(item => {\r\n        return item.sessionData.filter(item => {\r\n            return (item.userAgent === userAgent);\r\n        });\r\n    }).flat();\r\n}\r\n\r\nexport default ({id}) => {\r\n    const [ts, setTs] = useState(() => {\r\n        return format(new Date(), 'yyyy-MM-dd');\r\n    });\r\n    const [{response}, doApiFetch] = useApi('/user-session-data-ts');\r\n\r\n    const dateRange = getDateRange(+new Date(ts), {ts: true, day: true, month: false});\r\n    const newUsers = response && response.filter(user => +new Date(user.createdAt) > dateRange.begin && dateRange.end > +new Date(user.createdAt));\r\n    const preparedData = response?.map(item => {\r\n        const filter = item.sessionData.filter(item => {\r\n            return (item.timeStamp > dateRange.begin && item.timeStamp < dateRange.end);\r\n        });\r\n        const newItem = item;\r\n        newItem.sessionData = filter;\r\n        return newItem;\r\n    });\r\n\r\n    const androidUsers = getUserAgentArray(preparedData, 'mobile_android');\r\n    const iphoneUsers = getUserAgentArray(preparedData, 'mobile_iphone');\r\n    const mobileWebUsers = getUserAgentArray(preparedData, 'mobile_web');\r\n    const desktopUsers = getUserAgentArray(preparedData, 'desktop_web');\r\n    const androidMessengerUsers = getUserAgentArray(preparedData, 'mobile_android_messenger');\r\n    const iphoneMessengerUsers = getUserAgentArray(preparedData, 'mobile_iphone_messenger');\r\n\r\n    return (\r\n        <Panel id={id}>\r\n            <PanelHeader>\r\n                Статистика\r\n            </PanelHeader>\r\n            <FormLayout\r\n                onSubmit={(e) => {\r\n                    e.preventDefault();\r\n                    doApiFetch({\r\n                        method: 'GET',\r\n                        params: {\r\n                            ts: +new Date(ts)\r\n                        }\r\n                    })\r\n                }}\r\n            >\r\n                <Input\r\n                    type={'date'}\r\n                    value={ts}\r\n                    onChange={(e) => {\r\n                        setTs(e.currentTarget.value);\r\n                    }}\r\n                />\r\n                <Button>Получить данные</Button>\r\n            </FormLayout>\r\n            <Group>\r\n                <Header mode={'secondary'}>\r\n                    Статистика за {ts}\r\n                </Header>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Новые пользователи за период'}>\r\n                        {newUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Пользователей за период'}>\r\n                        {response?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Android за период'}>\r\n                        {androidUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Iphone за период'}>\r\n                        {iphoneUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Desktop за период'}>\r\n                        {desktopUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Mobile Web за период'}>\r\n                        {mobileWebUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Android Messenger за период'}>\r\n                        {androidMessengerUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n                <SimpleCell multiline>\r\n                    <InfoRow header={'Просмотров Iphone Messenger за период'}>\r\n                        {iphoneMessengerUsers?.length}\r\n                    </InfoRow>\r\n                </SimpleCell>\r\n\r\n            </Group>\r\n        </Panel>\r\n    )\r\n}","import React, {useEffect, useReducer} from 'react';\r\nimport useApi from \"../../handlers/useApi\";\r\nimport {Button, FormLayout, Input, Select} from \"@vkontakte/vkui\";\r\nimport validate from \"../../handlers/validate\";\r\nimport AccountsOptionsList from \"../AccountsOptionsList\";\r\nimport {format} from \"date-fns\";\r\nimport currency from \"../../handlers/currency\";\r\nimport regexp from \"../../handlers/regexp\";\r\nimport {SET_ACCOUNTS, SET_BUDGETS} from \"../../state/actions\";\r\n\r\nconst initialState = {\r\n    to: '',\r\n    from: '',\r\n    date: format(new Date(), 'yyyy-MM-dd'),\r\n    title: '',\r\n    price: ''\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'CHANGE_STATE':\r\n            const {payload: {validateForm, ...payload}} = action;\r\n            return {\r\n                ...state,\r\n                ...payload,\r\n                validate: {...state.validate, ...validateForm}\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default ({accounts, dispatch}) => {\r\n    const [{response}, doApiFetch] = useApi('/money-box/transfer');\r\n\r\n    const [state, dispatchForm] = useReducer(reducer, initialState);\r\n\r\n    useEffect(() => {\r\n        if (!response) return;\r\n        dispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n        dispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n    }, [response, dispatch]);\r\n\r\n    const accountFrom = accounts.find((item) => item._id === state.from);\r\n    const accountsFromList = accounts.filter(item => item._id !== state.to);\r\n    const accountsToList = accounts.filter(item => item._id !== state.from);\r\n\r\n    return (\r\n        <FormLayout\r\n            onSubmit={(e) => {\r\n               e.preventDefault();\r\n               doApiFetch({\r\n                   method: 'POST',\r\n                   date: state.date,\r\n                   title: state.title,\r\n                   to: state.to,\r\n                   from: state.from,\r\n                   price: state.price\r\n               })\r\n            }}\r\n        >\r\n            <Input type={'date'}\r\n                   top={'Дата'}\r\n                   value={state.date}\r\n                   required={true}\r\n                   min={'2015-01-01'}\r\n                   max={format(new Date(), 'yyyy-MM-dd')}\r\n                   onChange={(e) => {\r\n                       dispatchForm({\r\n                           type: 'CHANGE_STATE',\r\n                           payload: {date: e.currentTarget.value, validateForm: {date: validate(e)}}\r\n                       })\r\n                   }}\r\n                   status={state.validate?.date?.status}\r\n                   bottom={state.validate?.date?.message}\r\n            />\r\n\r\n            <Select top={'Счет списания'}\r\n                    placeholder={'Выберите счет'}\r\n                    onChange={(e) => {\r\n                        dispatchForm({\r\n                            type: 'CHANGE_STATE',\r\n                            payload: {from: e.currentTarget.value, validateForm: {from: validate(e)}}\r\n                        })\r\n                    }}\r\n                    defaultValue={state.from} required={true}\r\n                    status={state.validate?.from?.status}\r\n                    bottom={state.validate?.from?.message}\r\n            >\r\n                <AccountsOptionsList accounts={accountsFromList} />\r\n            </Select>\r\n            <Select top={'Счет зачисления'}\r\n                    placeholder={'Выберите счет'}\r\n                    onChange={(e) => {\r\n                        dispatchForm({\r\n                            type: 'CHANGE_STATE',\r\n                            payload: {to: e.currentTarget.value, validateForm: {to: validate(e)}}\r\n                        })\r\n                    }}\r\n                    defaultValue={state.to} required={true}\r\n                    status={state.validate?.to?.status}\r\n                    bottom={state.validate?.to?.message}\r\n            >\r\n                <AccountsOptionsList accounts={accountsToList} />\r\n            </Select>\r\n            <Input type={'text'}\r\n                   placeholder={'Название перевода'}\r\n                   value={state.title}\r\n                   top={'Название'}\r\n                   required={true}\r\n                   maxLength={20}\r\n                   status={state.validate?.title?.status}\r\n                   bottom={state.validate?.title?.message ? state.validate?.title?.message : `${state.title.length} из 20`}\r\n                   onChange={(e) => {\r\n                       dispatchForm({\r\n                           type: 'CHANGE_STATE',\r\n                           payload: {\r\n                               title: regexp(e.currentTarget.value),\r\n                               validateForm: {title: validate(e)}\r\n                           }\r\n                       })\r\n                   }}/>\r\n            <Input type={'number'}\r\n                   placeholder={currency(0)}\r\n                   pattern={'[0-9]+([,\\\\.][0-9]+)?'}\r\n                   top={'Цена'}\r\n                   inputMode=\"decimal\"\r\n                   max={accountFrom?.sum || 99999999}\r\n                   min={0}\r\n                   step={0.0001}\r\n                   status={state.validate?.price?.status}\r\n                   bottom={state.validate?.price?.message}\r\n                   value={state.price}\r\n                   required={true}\r\n                   onChange={(e) => {\r\n                       dispatchForm({\r\n                           type: 'CHANGE_STATE',\r\n                           payload: {price: e.currentTarget.value.replace(/[^\\d.]*/, ''), validateForm: {price: validate(e)}}\r\n                       })\r\n                   }}\r\n            />\r\n            <Button size={'xl'}>\r\n                {`Перевести ${currency(state.price)}`}\r\n            </Button>\r\n        </FormLayout>\r\n    )\r\n}","import React, {useCallback, useContext, useEffect, useState} from 'react';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport Home from './panels/Home';\r\nimport useApi from \"./handlers/useApi\";\r\nimport {State} from './state';\r\nimport {\r\n    SET_ACCOUNTS,\r\n    SET_ACTIVE_VIEW,\r\n    SET_BUDGETS,\r\n    SET_COLOR_SCHEME,\r\n    SET_EDITED_ITEM,\r\n    SET_HISTORY_BACK,\r\n    SET_MODAL,\r\n    SET_POPOUT, SET_SUCCESS_MESSAGE\r\n} from \"./state/actions\";\r\nimport {\r\n    Alert,\r\n    ANDROID,\r\n    ConfigProvider,\r\n    Epic,\r\n    IOS,\r\n    ModalPage,\r\n    ModalPageHeader,\r\n    ModalRoot,\r\n    PanelHeaderButton,\r\n    platform,\r\n    Tabbar,\r\n    TabbarItem\r\n} from \"@vkontakte/vkui\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon28HomeOutline from '@vkontakte/icons/dist/28/home_outline';\r\nimport Icon28CoinsOutline from '@vkontakte/icons/dist/28/coins_outline';\r\nimport Icon28StatisticsOutline from '@vkontakte/icons/dist/28/statistics_outline';\r\nimport Icon28More from '@vkontakte/icons/dist/28/more';\r\nimport AddAccount from \"./components/modals/AddAccount\";\r\nimport AddMoney from \"./components/modals/AddMoney\";\r\nimport AccountInfo from \"./panels/AccountInfo\";\r\nimport Budgets from \"./panels/Budgets\";\r\nimport AddBudget from \"./components/modals/AddBudget\";\r\nimport BudgetInfo from \"./panels/BudgetInfo\";\r\nimport Stats from \"./panels/Stats\";\r\nimport InitialScreen from \"./panels/InitialScreen\";\r\n\r\nimport './style.css';\r\nimport More from \"./panels/More\";\r\nimport ShopListPanel from \"./panels/ShopListPanel\";\r\nimport useLocalStorage from \"./handlers/useLocalStorage\";\r\nimport AppStats from \"./panels/AppStats\";\r\nimport TransferMoney from \"./components/modals/TransferMoney\";\r\n\r\nconst App = () => {\r\n    const os = platform();\r\n    const [{response, isLoading}, doApiFetch] = useApi('/state');\r\n    const [needFetch, setNeedFetch] = useState(true);\r\n    const [state, dispatch] = useContext(State);\r\n    const [lastBackAction, setLastBackAction] = useState(0);\r\n    const [bannerData, setBannerData] = useState(null);\r\n    const [shopListItemTitle, setShopListItemTitle] = useState('');\r\n    const [shopList, setShopList] = useLocalStorage('shopList', []);\r\n    const [addToHomeScreenSupported, setAddToHomeScreenSupported] = useState(false);\r\n    const [addedToHomeScreen, setAddedToHomeScreen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        bridge.subscribe(({detail: {type, data}}) => {\r\n            if (type === 'VKWebAppUpdateConfig') {\r\n                dispatch({type: SET_COLOR_SCHEME, payload: {scheme: data.scheme}})\r\n            }\r\n            if (type === 'VKWebAppGetAdsResult') {\r\n                setBannerData(data);\r\n            }\r\n            if (type === 'VKWebAppAddToHomeScreenInfoResult') {\r\n                setAddToHomeScreenSupported(data.is_feature_supported);\r\n                setAddedToHomeScreen(data.is_added_to_home_screen);\r\n            }\r\n            if (type === 'VKWebAppAddToHomeScreenResult') {\r\n                if (data.result) {\r\n                    setAddedToHomeScreen(data.result);\r\n                }\r\n            }\r\n            if (type === 'VKWebAppJoinGroupResult') {\r\n                if (data.result) {\r\n                    dispatch({type: SET_SUCCESS_MESSAGE, payload: {message: 'Спасибо, что Вы с нами ❤️'}})\r\n                }\r\n                // console.log(data);\r\n            }\r\n            if (type === 'VKWebAppJoinGroupFailed') {\r\n                // console.log(data);\r\n            }\r\n        });\r\n\r\n// Init VK  Mini App\r\n        bridge.send(\"VKWebAppInit\", {});\r\n        // Native ads on Android/IOS\r\n        // bridge.send(\"VKWebAppShowNativeAds\", {ad_format:\"preloader\"})\r\n        // \t.then(data => console.log(data.result))\r\n        // \t.catch(error => console.log(error));\r\n        bridge.send('VKWebAppGetAds', {});\r\n        bridge.send('VKWebAppAddToHomeScreenInfo');\r\n    }, [dispatch]);\r\n\r\n    const alert = (\r\n        <Alert\r\n            actions={[\r\n                {\r\n                    title: 'Отмена',\r\n                    autoclose: true,\r\n                    mode: \"cancel\"\r\n                },\r\n                {\r\n                    title: 'Выйти',\r\n                    mode: 'destructive',\r\n                    autoclose: true,\r\n                    action: async () => {\r\n                        await bridge.send('VKWebAppClose', {status: 'success'});\r\n                    }\r\n                }\r\n            ]}\r\n            onClose={() => {\r\n                dispatch({type: SET_POPOUT, payload: {popout: null}})\r\n            }}\r\n        >\r\n            <h2>Выйти из приложения?</h2>\r\n            <p>Вы действительно хотите выйти?</p>\r\n        </Alert>\r\n    )\r\n\r\n    useEffect(() => {\r\n        if (!needFetch) return;\r\n        doApiFetch({\r\n            params: {\r\n                date: new Date(state.currentDate)\r\n            }\r\n        });\r\n        setNeedFetch(false);\r\n    }, [needFetch, doApiFetch, state.currentDate]);\r\n\r\n    useEffect(() => {\r\n        if (!response) return;\r\n        dispatch({type: SET_ACCOUNTS, payload: {accounts: response?.accounts ? response?.accounts : []}});\r\n        dispatch({type: SET_BUDGETS, payload: {budgets: response?.budgets ? response?.budgets : []}});\r\n    }, [response, dispatch]);\r\n\r\n    useEffect(() => {\r\n            window.onpopstate = () => {\r\n                let timeNow = +new Date();\r\n                if (state.canClose) {\r\n                    dispatch({type: SET_POPOUT, payload: {popout: alert, alert: true}});\r\n                } else {\r\n                    if (timeNow - lastBackAction > 500) {\r\n                        setLastBackAction(timeNow);\r\n                        dispatch({type: SET_HISTORY_BACK});\r\n                    } else {\r\n                        window.history.pushState(null, null);\r\n                    }\r\n                }\r\n            }\r\n        }, [dispatch, state.history, state.modal, lastBackAction, state.canClose, alert]\r\n    );\r\n\r\n    const onRefresh = useCallback(() => {\r\n        setNeedFetch(true);\r\n    }, []);\r\n\r\n    const modalBack = (() => {\r\n        dispatch({type: SET_EDITED_ITEM, payload: {item: null}});\r\n        dispatch({type: SET_MODAL, payload: {modal: null}});\r\n        setShopListItemTitle('');\r\n    })\r\n\r\n    const modal = (\r\n        <ModalRoot\r\n            activeModal={state.modal}\r\n            onClose={modalBack}\r\n        >\r\n            <ModalPage id={'add-account'} header={\r\n                <ModalPageHeader\r\n                    left={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n                    right={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n                >\r\n                    Добавить счет\r\n                </ModalPageHeader>\r\n            }>\r\n                <AddAccount dispatch={dispatch} editedItem={state.editedItem}/>\r\n            </ModalPage>\r\n\r\n            <ModalPage id={'add-money'} header={\r\n                <ModalPageHeader\r\n                    left={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n                    right={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n                >\r\n                    {state.editedItem ? 'Редактировать' : 'Добавить запись'}\r\n                </ModalPageHeader>\r\n            }>\r\n                <AddMoney accounts={state.accounts} id={state.account?._id}\r\n                          editedItem={state.editedItem} dispatch={dispatch} budget={state.budget}\r\n                          panel={state.activePanel}\r\n                          shopListItemTitle={shopListItemTitle} setShopListItemTitle={setShopListItemTitle}\r\n                          date={state.currentDate}/>\r\n            </ModalPage>\r\n\r\n            <ModalPage id={'add-budget'} header={\r\n                <ModalPageHeader\r\n                    left={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n                    right={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n                >\r\n                    {state.editedItem ? 'Редактировать' : 'Добавить бюджет'}\r\n                </ModalPageHeader>\r\n            }>\r\n                <AddBudget editedItem={state.editedItem} dispatch={dispatch} date={state.currentDate}/>\r\n            </ModalPage>\r\n            <ModalPage id={'transfer-money'} header={\r\n                <ModalPageHeader\r\n                    left={os === ANDROID && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n                    right={<PanelHeaderButton onClick={modalBack}>{os === IOS ? 'Закрыть' : null}</PanelHeaderButton>}\r\n                >\r\n                    Перевести\r\n                </ModalPageHeader>\r\n            }>\r\n                <TransferMoney accounts={state.accounts} dispatch={dispatch}/>\r\n            </ModalPage>\r\n        </ModalRoot>\r\n    )\r\n\r\n    const onStoryChange = (e) => {\r\n        dispatch({\r\n            type: SET_ACTIVE_VIEW,\r\n            payload: {view: e.currentTarget.dataset.story, panel: e.currentTarget.dataset.panel}\r\n        })\r\n    }\r\n\r\n    const tabBar = (\r\n        <Tabbar itemsLayout={'horizontal'}>\r\n            <TabbarItem\r\n                onClick={onStoryChange}\r\n                selected={state.activeView === 'home'}\r\n                data-story={'home'}\r\n                data-panel={'home'}\r\n                text={'Баланс'}\r\n            >\r\n                <Icon28HomeOutline/>\r\n            </TabbarItem>\r\n            <TabbarItem\r\n                onClick={onStoryChange}\r\n                selected={state.activeView === 'info' && (state.activePanel === 'budgets' || state.activePanel === 'budget')}\r\n                data-story={'info'}\r\n                data-panel={'budgets'}\r\n                text={'Бюджеты'}\r\n            >\r\n                <Icon28CoinsOutline/>\r\n            </TabbarItem>\r\n            <TabbarItem\r\n                onClick={onStoryChange}\r\n                selected={state.activeView === 'stats' && state.activePanel === 'stats'}\r\n                data-story={'stats'}\r\n                data-panel={'stats'}\r\n                text={'Сводка'}\r\n            >\r\n                <Icon28StatisticsOutline/>\r\n            </TabbarItem>\r\n            <TabbarItem\r\n                onClick={onStoryChange}\r\n                selected={state.activeView === 'more'}\r\n                data-story={'more'}\r\n                data-panel={'index'}\r\n                text={'Ещё'}\r\n            >\r\n                <Icon28More/>\r\n            </TabbarItem>\r\n        </Tabbar>\r\n    )\r\n\r\n    return (\r\n        <ConfigProvider scheme={state.scheme}>\r\n            <Epic activeStory={state.activeView}\r\n                  tabbar={state.activeView !== 'init' && state.activePanel !== 'init' && tabBar}>\r\n                <View id={'init'} activePanel={state.activePanel}>\r\n                    <InitialScreen id={'init'} dispatch={dispatch} loading={state.popout} bannerData={bannerData}\r\n                                   setBannerData={setBannerData}/>\r\n                </View>\r\n                <View id={'home'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n                    <Home id='home' accounts={state.accounts} budgets={state.budgets} dispatch={dispatch}\r\n                          isLoading={isLoading} context={state.contextHistory}\r\n                          onRefresh={onRefresh} isFetching={isLoading} shopList={shopList}/>\r\n                </View>\r\n                <View id={'info'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n                    <AccountInfo id={'account'} account={state.accounts.find(item => item._id === state.account?._id)}\r\n                                 dispatch={dispatch} onRefresh={onRefresh} context={state.contextHistory}\r\n                                 date={state.currentDate} scheme={state.scheme}/>\r\n                    <Budgets id={'budgets'} budgets={state.budgets} dispatch={dispatch} onRefresh={onRefresh}\r\n                             date={state.currentDate} bannerData={bannerData}\r\n                             setBannerData={setBannerData}/>\r\n                    <BudgetInfo id={'budget'} budget={state.budgets.find(item => item._id === state.budget?._id)}\r\n                                dispatch={dispatch} context={state.contextHistory} date={state.currentDate}/>\r\n                </View>\r\n                <View id={'stats'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n                    <Stats id={'stats'} accounts={state.accounts} onRefresh={onRefresh} dispatch={dispatch}/>\r\n                </View>\r\n                <View id={'more'} activePanel={state.activePanel} popout={state.popout} modal={modal}>\r\n                    <More id={'index'} dispatch={dispatch} addToHomeScreenSupported={addToHomeScreenSupported}\r\n                          addedToHomeScreen={addedToHomeScreen} bannerData={bannerData}\r\n                          setBannerData={setBannerData}/>\r\n                    <ShopListPanel id={'shop-list'} dispatch={dispatch} shopListFromServer={shopList}\r\n                                   setShopListItemTitle={setShopListItemTitle}\r\n                                   setShopList={setShopList} context={state.contextHistory}\r\n                                   success={state.successMessage} error={state.error}/>\r\n                    <AppStats id={'stats'}/>\r\n                </View>\r\n            </Epic>\r\n        </ConfigProvider>\r\n    );\r\n}\r\n\r\nexport default App;\r\n\r\n","import { useState } from 'react';\r\n\r\nexport default (key, initialValue) => {\r\n\t// State to store our value\r\n\t// Pass initial state function to useState so logic is only executed once\r\n\tconst [storedValue, setStoredValue] = useState(() => {\r\n\t\ttry {\r\n\t\t\t// Get from local storage by key\r\n\t\t\tconst item = window.localStorage.getItem(key);\r\n\t\t\t// Parse stored json or if none return initialValue\r\n\t\t\treturn item ? JSON.parse(item) : initialValue;\r\n\t\t} catch (error) {\r\n\t\t\t// If error also return initialValue\r\n\t\t\tconsole.log(error);\r\n\t\t\treturn initialValue;\r\n\t\t}\r\n\t});\r\n\r\n\t// Return a wrapped version of useState's setter function that ...\r\n\t// ... persists the new value to localStorage.\r\n\tconst setValue = value => {\r\n\t\ttry {\r\n\t\t\t// Allow value to be a function so we have same API as useState\r\n\t\t\tconst valueToStore =\r\n\t\t\t\tvalue instanceof Function ? value(storedValue) : value;\r\n\t\t\t// Save state\r\n\t\t\tsetStoredValue(valueToStore);\r\n\t\t\t// Save to local storage\r\n\t\t\twindow.localStorage.setItem(key, JSON.stringify(valueToStore));\r\n\t\t} catch (error) {\r\n\t\t\t// A more advanced implementation would handle the error case\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t};\r\n\r\n\treturn [storedValue, setValue];\r\n}","import \"core-js/features/map\";\r\nimport \"core-js/features/set\";\r\nimport 'array-flat-polyfill';\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport {StateProvider} from \"./state\";\r\n\r\nReactDOM.render(\r\n  <StateProvider>\r\n    <App />\r\n  </StateProvider>, document.getElementById(\"root\"));\r\nif (new URL(window.location.href).searchParams.get('vk_user_id') === process.env.REACT_APP_ID.toString()) {\r\n  import(\"./eruda\").then(() => {}); //runtime download\r\n}\r\n\r\n// console.log(new URL(window.location.href).searchParams.get('vk_user_id'));\r\n//import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\r\n"],"sourceRoot":""}