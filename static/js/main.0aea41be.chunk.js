(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{202:function(e,t,a){e.exports=a(331)},331:function(e,t,a){"use strict";a.r(t);a(203),a(229),a(231),a(232),a(234),a(235),a(236),a(237),a(238),a(239),a(240),a(241),a(243),a(244),a(245),a(246),a(247),a(248),a(249),a(250),a(251),a(252),a(254),a(255),a(256),a(257),a(258),a(259),a(260),a(261),a(262),a(263),a(264),a(265),a(266),a(267),a(268),a(269),a(270),a(271);var n=a(0),l=a.n(n),c=a(142),o=a.n(c),r=a(36),u=a.n(r),i=a(55),d=a(16),s=a(70),m=a.n(s),p=(a(279),a(155)),E=a.n(p),v=a(156),y=a.n(v),f=a(61),b=a.n(f),g=a(98),O=a.n(g),T=a(3),h=function(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e)},j=a(25),S=a.n(j),_=a(31),C=a(75),A=a.n(C),w=function(e){var t=e.data,a=e.showAll,c=void 0!==a&&a,o=e.dispatch,r=e.itemsName,u=e.needHide,i=void 0===u||u,s=Object(n.useState)((function(){return c})),m=Object(d.a)(s,2),p=m[0],E=m[1];if(0===t.length){if("accounts"===r)return l.a.createElement(T.i,null,"\u041d\u0435\u0442 \u0441\u0447\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f");if("budgets"===r)return l.a.createElement(T.i,null,"\u041d\u0435\u0442 \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f")}var v=t.sort((function(e,t){return t.sum-e.sum})).map((function(e,t){return 3!==t||p?t>3&&!p?null:l.a.createElement(A.a,{key:t,indicator:h(e.sum),expandable:!0,"data-id":e._id,onClick:function(){var e=Object(_.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("accounts"!==r){e.next=5;break}return e.next=3,o({type:"SET_ACCOUNT",payload:{id:t.currentTarget.dataset.id}});case 3:return e.next=5,o({type:"SET_ACTIVE_VIEW",payload:{view:"info",panel:"account"}});case 5:if("budgets"!==r){e.next=10;break}return e.next=8,o({type:"SET_BUDGET",payload:{id:t.currentTarget.dataset.id}});case 8:return e.next=10,o({type:"SET_ACTIVE_VIEW",payload:{view:"info",panel:"budget"}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},e.title):l.a.createElement(A.a,{key:t,expandable:!0,onClick:function(){E(!0)}},l.a.createElement(T.I,{weight:"semibold",style:{marginBottom:16}},"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"))}));return i&&p&&v.push(l.a.createElement(A.a,{key:t.length,expandable:!0,onClick:function(){E(!1)}},l.a.createElement(T.I,{weight:"semibold",style:{marginBottom:16}},"accounts"===r?"\u0421\u043a\u0440\u044b\u0442\u044c \u0441\u0447\u0435\u0442\u0430":"\u0421\u043a\u0440\u044b\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442\u044b"))),v},x=a(53),D=a.n(x),I=a(71),k=a.n(I),M=a(7),V={accounts:[],budgets:[],account:null,budget:null,modal:null,successMessage:null,error:null,activeView:"home",activePanel:"home",popout:null,editedItem:null},P=function(e,t){switch(t.type){case"SET_ACTIVE_VIEW":return Object(M.a)(Object(M.a)({},e),{},{activeView:t.payload.view,activePanel:t.payload.panel});case"SET_ACTIVE_PANEL":return Object(M.a)(Object(M.a)({},e),{},{activePanel:t.payload.panel});case"SET_ACCOUNTS":return Object(M.a)(Object(M.a)({},e),{},{accounts:t.payload.accounts});case"SET_BUDGETS":var a,n=null===(a=e.budget)||void 0===a?void 0:a._id;return Object(M.a)(Object(M.a)({},e),{},{budgets:t.payload.budgets,budget:n?t.payload.budgets.find((function(e){return e._id===n})):n});case"SET_ACCOUNT":var l=t.payload.id;return Object(M.a)(Object(M.a)({},e),{},{account:e.accounts.find((function(e){return e._id===l}))});case"SET_BUDGET":var c=t.payload.id;return Object(M.a)(Object(M.a)({},e),{},{budget:c?e.budgets.find((function(e){return e._id===c})):c});case"SET_EDITED_ITEM":return Object(M.a)(Object(M.a)({},e),{},{editedItem:t.payload.item});case"SET_POPOUT":return Object(M.a)(Object(M.a)({},e),{},{popout:t.payload.popout});case"SET_MODAL":return Object(M.a)(Object(M.a)({},e),{},{modal:t.payload.modal});case"SET_SUCCESS_MESSAGE":return Object(M.a)(Object(M.a)({},e),{},{successMessage:t.payload.message});case"SET_ERROR":return Object(M.a)(Object(M.a)({},e),{},{error:t.payload.error});default:return e}},N=Object(n.createContext)(),G=function(e){var t=e.children,a=Object(n.useReducer)(P,V);return l.a.createElement(N.Provider,{value:a},t)},U=a(153),L=a.n(U),R=a(154),F=a.n(R),H=function(){var e=Object(n.useContext)(N),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),r=Object(d.a)(o,2),u=r[0],i=r[1];return Object(n.useEffect)((function(){a.error&&i(l.a.createElement(T.F,{onClose:function(){c({type:"SET_ERROR",payload:{error:null}}),i(null)},before:l.a.createElement(L.a,{style:{color:"var(--destructive)"}})},a.error.message))}),[i,c,a.error]),Object(n.useEffect)((function(){a.successMessage&&i(l.a.createElement(T.F,{onClose:function(){c({type:"SET_SUCCESS_MESSAGE",payload:{message:null}}),i(null)},before:l.a.createElement(F.a,{style:{color:"var(--accent)"}})},a.successMessage))}),[i,c,a.successMessage]),l.a.createElement(l.a.Fragment,null,u)},q=function(e){var t=e.id,a=e.accounts,n=e.budgets,c=e.dispatch,o=e.onRefresh,r=e.isFetching,u=a.map((function(e){return e.sum})).reduce((function(e,t){return e+t}),0);return l.a.createElement(E.a,{id:t},l.a.createElement(y.a,{left:l.a.createElement(l.a.Fragment,null,l.a.createElement(T.v,{onClick:function(){c({type:"SET_MODAL",payload:{modal:"add-account"}})}},l.a.createElement(k.a,null)),0!==a.length&&l.a.createElement(T.v,{onClick:function(){c({type:"SET_ACCOUNT",payload:{id:null}}),c({type:"SET_MODAL",payload:{modal:"add-money"}})}},l.a.createElement(D.a,null)))},"Balance"),l.a.createElement(T.z,{onRefresh:o,isFetching:r},l.a.createElement(T.o,null,l.a.createElement(b.a,{header:l.a.createElement(T.l,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0441\u0447\u0435\u0442\u0430"),separator:"show"},l.a.createElement(O.a,null,l.a.createElement(T.K,{level:"1",weight:"semibold",style:{marginBottom:16}},h(u)),l.a.createElement(w,{data:a,dispatch:c,showAll:!1,itemsName:"accounts"}))),l.a.createElement(b.a,{header:l.a.createElement(T.l,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0431\u044e\u0434\u0436\u0435\u0442\u044b"),separator:"show"},l.a.createElement(O.a,null,l.a.createElement(w,{data:n,dispatch:c,showAll:!1,itemsName:"budgets"}))))),l.a.createElement(H,null))},B=a(54),W=a(99),z=a.n(W),K=a(157),J=a.n(K),Q=function(e){var t=Object(n.useState)(!1),a=Object(d.a)(t,2),c=a[0],o=a[1],r=Object(n.useState)(null),u=Object(d.a)(r,2),i=u[0],s=u[1],m=Object(n.useState)(null),p=Object(d.a)(m,2),E=p[0],v=p[1],y=Object(n.useState)({}),f=Object(d.a)(y,2),b=f[0],g=f[1],O=Object(n.useContext)(N),h=Object(d.a)(O,2)[1],j=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(e),s(null),v(null),o(!0),h({type:"SET_POPOUT",payload:{popout:l.a.createElement(T.y,null,l.a.createElement(T.C,null))}})}),[h]),C=b.method,A=void 0===C?"GET":C,w=b.params,x=Object(B.a)(b,["method","params"]),D={method:A,baseURL:"https://balance.z-labz.ru/api",url:e,headers:{"Content-Type":"application/json"},params:w?Object(M.a)(Object(M.a)({},w),z.a.parse(window.location.search)):Object(M.a)({},z.a.parse(window.location.search)),data:"GET"!==A?x:null};return Object(n.useEffect)((function(){c&&function(){var e=Object(_.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!1),e.next=3,J()(D).then(function(){var e=Object(_.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(t.data.data),h({type:"SET_POPOUT",payload:{popout:null}}),h({type:"SET_MODAL",payload:{modal:null}}),h({type:"SET_SUCCESS_MESSAGE",payload:{message:t.data.message}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t=(null===e||void 0===e?void 0:e.response)?e.response.data.error:new Error("\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043a API");v(t),o(!1),h({type:"SET_POPOUT",payload:{popout:null}}),h({type:"SET_MODAL",payload:{modal:null}}),h({type:"SET_ERROR",payload:{error:t}})}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[c,D,h]),[{isLoading:c,response:i,error:E},j]},X=a(52),Y=a.n(X),Z=a(76),$=a.n(Z),ee=a(161),te=a.n(ee),ae=a(162),ne=a.n(ae),le=function(e){var t=e.currentTarget.validity;return t.valid?{status:"valid",message:null}:t.badInput?{status:"error",message:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0432\u043e\u0434\u0430"}:t.tooLong?{status:"error",message:"\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430"}:t.typeMismatch?{status:"error",message:"\u041d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0442\u0438\u043f\u0430"}:t.rangeOverflow?{status:"error",message:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u0447\u0438\u0441\u043b\u043e"}:{status:"default",message:null}},ce={title:"",sum:"",titleValidation:{},sumValidation:{}},oe=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload;return Object(M.a)(Object(M.a)({},e),a);default:return e}},re=function(e){var t=e.setAccount,a=Object(n.useReducer)(oe,ce),c=Object(d.a)(a,2),o=c[0],r=c[1],u=Q("/money-box"),i=Object(d.a)(u,2),s=i[0].response,m=i[1];return Object(n.useEffect)((function(){s&&t(s)}),[s,t]),l.a.createElement(T.j,{onSubmit:function(){var e=Object(_.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,m({method:"POST",title:o.title,sum:o.sum});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},l.a.createElement(T.n,{type:"text",placeholder:"\u041a\u0430\u0440\u0442\u0430, \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0435, \u0441\u0447\u0435\u0442 \u0432 \u0431\u0430\u043d\u043a\u0435",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:o.title,required:!0,maxLength:"20",status:o.titleValidation.status,bottom:o.titleValidation.message?o.titleValidation.message:"".concat(o.title.length," \u0438\u0437 20"),onChange:function(e){return r({type:"CHANGE_STATE",payload:{title:e.currentTarget.value,titleValidation:le(e)}})}}),l.a.createElement(T.n,{type:"number",placeholder:h(0),top:"\u041e\u0441\u0442\u0430\u0442\u043e\u043a \u0432 \u0440\u0443\u0431\u043b\u044f\u0445",value:o.sum,required:!0,status:o.sumValidation.status,max:999999999,step:.01,bottom:o.sumValidation.message?o.sumValidation.message:"\u0414\u0435\u043d\u0435\u0436\u043d\u044b\u0435 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430, \u043d\u0430\u0445\u043e\u0434\u044f\u0449\u0438\u0435\u0441\u044f \u043d\u0430 \u0441\u0447\u0435\u0442\u0435 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442",onChange:function(e){return r({type:"CHANGE_STATE",payload:{sum:e.currentTarget.value,sumValidation:le(e)}})}}),l.a.createElement(T.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},ue=a(332),ie={account:"",title:"",date:Object(ue.a)(new Date,"yyyy-MM-dd"),income:!1,description:"",price:"",quantity:"",tags:[],validate:{account:{},title:{},description:{},price:{},quantity:{},tags:{}}},de=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload,n=a.validateForm,l=Object(B.a)(a,["validateForm"]);return Object(M.a)(Object(M.a)(Object(M.a)({},e),l),{},{validate:Object(M.a)(Object(M.a)({},e.validate),n)});default:return e}},se=function(e){var t,a,c,o,r,u,i,s,m,p,E,v,y,f,b,g,O,j,S,_,C,A,w,x,D,I,k,V,P,N,G=e.accounts,U=e.id,L=void 0===U?null:U,R=e.setAccount,F=e.editedItem,H=void 0===F?null:F,q=Object(n.useState)((function(){return H?"/item/".concat(H._id):"/item"})),B=Object(d.a)(q,1)[0],W=Q(B),z=Object(d.a)(W,2),K=z[0].response,J=z[1],X=Object(n.useReducer)(de,ie),Y=Object(d.a)(X,2),Z=Y[0],$=Y[1],ee=G.map((function(e){return l.a.createElement("option",{key:e._id,value:e._id},e.title," (",h(e.sum),")")}));Object(n.useEffect)((function(){H&&(H.date=Object(ue.a)(new Date(H.date),"yyyy-MM-dd"),$({type:"CHANGE_STATE",payload:Object(M.a)({},H)}))}),[H,$]),Object(n.useEffect)((function(){K&&R(K)}),[K,R]);var te=Z.tags.map((function(e,t){return l.a.createElement(T.f,{style:{marginRight:"5px"},key:t},e)}));return l.a.createElement(T.j,{onSubmit:function(e){e.preventDefault(),J({method:H?"PATCH":"POST",date:Z.date,title:Z.title,description:Z.description,price:Z.price,quantity:Z.quantity,income:Z.income,tags:Z.tags,itemFrom:Z.account||L})}},l.a.createElement(T.E,{top:"\u0421\u0447\u0435\u0442",placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0447\u0435\u0442",onChange:function(e){$({type:"CHANGE_STATE",payload:{account:e.currentTarget.value,validateForm:{account:le(e)}}})},defaultValue:L||Z.account||(null===H||void 0===H?void 0:H.itemFrom),required:!0,status:null===(t=Z.validate)||void 0===t||null===(a=t.account)||void 0===a?void 0:a.status,bottom:null===(c=Z.validate)||void 0===c||null===(o=c.account)||void 0===o?void 0:o.message},ee),l.a.createElement(T.n,{type:"date",top:"\u0414\u0430\u0442\u0430",value:Z.date,required:!0,onChange:function(e){$({type:"CHANGE_STATE",payload:{date:e.currentTarget.value}})}}),l.a.createElement(T.n,{type:"text",placeholder:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442, \u0443\u0441\u043b\u0443\u0433\u0430, \u0442\u043e\u0432\u0430\u0440",value:Z.title,top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,maxLength:20,status:null===(r=Z.validate)||void 0===r||null===(u=r.title)||void 0===u?void 0:u.status,bottom:(null===(i=Z.validate)||void 0===i||null===(s=i.title)||void 0===s?void 0:s.message)?null===(m=Z.validate)||void 0===m||null===(p=m.title)||void 0===p?void 0:p.message:"".concat(Z.title.length," \u0438\u0437 20"),onChange:function(e){$({type:"CHANGE_STATE",payload:{title:e.currentTarget.value,validateForm:{title:le(e)}}})}}),l.a.createElement(T.A,{name:"income",value:!1,defaultChecked:!Z.income||null,onClick:function(){$({type:"CHANGE_STATE",payload:{income:!1}})}},"\u0420\u0430\u0441\u0445\u043e\u0434"),l.a.createElement(T.A,{name:"income",value:!0,defaultChecked:!!Z.income||null,onClick:function(){$({type:"CHANGE_STATE",payload:{income:!0}})}},"\u0414\u043e\u0445\u043e\u0434"),!Z.income&&l.a.createElement(T.J,{top:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430(\u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430, \u0443\u0441\u043b\u0443\u0433\u0438)",value:Z.description,maxLength:70,status:null===(E=Z.validate)||void 0===E||null===(v=E.description)||void 0===v?void 0:v.status,bottom:(null===(y=Z.validate)||void 0===y||null===(f=y.description)||void 0===f?void 0:f.message)?null===(b=Z.validate)||void 0===b||null===(g=b.description)||void 0===g?void 0:g.message:"".concat(Z.description.length," \u0438\u0437 70"),onChange:function(e){$({type:"CHANGE_STATE",payload:{description:e.currentTarget.value,validateForm:{description:le(e)}}})}}),l.a.createElement(T.n,{type:"text",top:"\u0422\u044d\u0433\u0438",value:Z.tags.join(" "),placeholder:"\u0422\u044d\u0433\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u0431\u0435\u043b",status:null===(O=Z.validate)||void 0===O||null===(j=O.tags)||void 0===j?void 0:j.status,maxLength:100,bottom:(null===(S=Z.validate)||void 0===S||null===(_=S.tags)||void 0===_?void 0:_.message)?null===(C=Z.validate)||void 0===C||null===(A=C.tags)||void 0===A?void 0:A.message:"".concat(Z.tags.length," \u0438\u0437 100"),onChange:function(e){$({type:"CHANGE_STATE",payload:{tags:e.currentTarget.value.toLowerCase().split(" "),validateForm:{tags:le(e)}}})}}),0!==Z.tags.length&&l.a.createElement(T.g,{style:{display:"flex"}},te),l.a.createElement(T.n,{type:"number",placeholder:h(0),top:"\u0426\u0435\u043d\u0430",max:99999999,step:.01,status:null===(w=Z.validate)||void 0===w||null===(x=w.price)||void 0===x?void 0:x.status,bottom:null===(D=Z.validate)||void 0===D||null===(I=D.price)||void 0===I?void 0:I.message,value:Z.price,required:!0,onChange:function(e){$({type:"CHANGE_STATE",payload:{price:e.currentTarget.value,validateForm:{price:le(e)}}})}}),l.a.createElement(T.n,{type:"number",placeholder:"0",top:"\u041a\u043e\u043b-\u0432\u043e",max:9999999,step:.01,status:null===(k=Z.validate)||void 0===k||null===(V=k.quantity)||void 0===V?void 0:V.status,bottom:null===(P=Z.validate)||void 0===P||null===(N=P.quantity)||void 0===N?void 0:N.message,value:Z.quantity,required:!0,onChange:function(e){$({type:"CHANGE_STATE",payload:{quantity:e.currentTarget.value,validateForm:{quantity:le(e)}}})}}),l.a.createElement(T.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},me=a(73),pe=a.n(me),Ee=a(74),ve=a.n(Ee),ye=a(62);function fe(e){return function(t,a){return t.titleDate?l.a.createElement(T.d,{level:"2",weight:"semibold",caps:!0,key:a},Object(ue.a)(new Date(null===t||void 0===t?void 0:t.titleDate),"dd MMMM yyyy",{locale:ye.a})):l.a.createElement(T.B,{key:a,multiline:!0,caption:Object(ue.a)(new Date(null===t||void 0===t?void 0:t.date),"dd MMMM yyyy",{locale:ye.a}),after:(null===t||void 0===t?void 0:t.income)?h(null===t||void 0===t?void 0:t.sum):h(-1*(null===t||void 0===t?void 0:t.sum)),"data-id":null===t||void 0===t?void 0:t._id,onClick:function(){e({type:"SET_EDITED_ITEM",payload:{item:t}}),e({type:"SET_MODAL",payload:{modal:"add-money"}})}},null===t||void 0===t?void 0:t.title)}}var be=a(158),ge=function(e,t){var a=new Date(e.date),n=new Date(t.date);return Object(be.a)(n,a)},Oe=a(159),Te=function(e,t){var a;return Object(Oe.a)(new Date(null===(a=e[e.length-1])||void 0===a?void 0:a.date),new Date(t.date))?[].concat(Object(i.a)(e),[t]):[].concat(Object(i.a)(e),[{titleDate:t.date},t])},he=function(e){var t=e.id,a=e.account,c=e.dispatch,o=e.onRefresh,r=Object(n.useState)(!1),u=Object(d.a)(r,2),i=u[0],s=u[1],m=Q("/money-box/".concat(null===a||void 0===a?void 0:a._id)),p=Object(d.a)(m,2),E=p[0].response,v=p[1],y=null===a||void 0===a?void 0:a.operations.sort(ge).reduce(Te,[]).map(fe(c)),f=function(){s(!i)},g=l.a.createElement(T.b,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",autoclose:!0,action:function(){var e=Object(_.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),e.next=3,v({method:"DELETE"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],onClose:function(){f(),c({type:"SET_POPOUT",payload:{popout:null}})}},l.a.createElement("h2",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0447\u0435\u0442?"),l.a.createElement("p",null,"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u0442 \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0432\u0441\u0435\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0434\u043e\u0445\u043e\u0434\u0430\u043c \u0438 \u0440\u0430\u0441\u0445\u043e\u0434\u0430\u043c, \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u043c \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0441\u0447\u0435\u0442\u0443. \u0421\u0443\u043c\u043c\u044b \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u0432 \u043c\u043e\u0433\u0443\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u043a\u043e\u0440\u0435\u043a\u0442\u043d\u043e."));return Object(n.useEffect)((function(){E&&(c({type:"SET_ACTIVE_VIEW",payload:{view:"home",panel:"home"}}),c({type:"SET_EDITED_ITEM",payload:{item:null}}),o())}),[c,E,o]),l.a.createElement(T.s,{id:t},l.a.createElement(T.t,{left:l.a.createElement(l.a.Fragment,null,l.a.createElement(T.u,{onClick:function(){c({type:"SET_ACTIVE_VIEW",payload:{view:"home",panel:"home"}}),c({type:"SET_EDITED_ITEM",payload:{item:null}})}}),l.a.createElement(T.v,{onClick:function(){c({type:"SET_EDITED_ITEM",payload:{item:null}}),c({type:"SET_MODAL",payload:{modal:"add-money"}})}},l.a.createElement(D.a,null)))},l.a.createElement(T.w,{aside:l.a.createElement(pe.a,{style:{transform:"rotate(".concat(i?"180deg":"0",")")}}),onClick:f},null===a||void 0===a?void 0:a.title)),l.a.createElement(T.x,{opened:i,onClose:f},l.a.createElement(T.o,null,l.a.createElement(T.e,{before:l.a.createElement(ve.a,null),onClick:function(){c({type:"SET_POPOUT",payload:{popout:g}})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0447\u0435\u0442 ",null===a||void 0===a?void 0:a.title))),l.a.createElement(b.a,{header:l.a.createElement(T.l,{mode:"secondary"},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u0441\u0447\u0435\u0442\u0443"),separator:"show"},l.a.createElement(T.g,null,l.a.createElement(T.K,{level:"1",weight:"semibold",style:{marginBottom:16}},h(null===a||void 0===a?void 0:a.sum))),0===(null===a||void 0===a?void 0:a.operations.length)&&l.a.createElement(T.i,null,"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u043f\u043e \u0441\u0447\u0435\u0442\u0443 \u0435\u0449\u0435 \u043d\u0435 \u0431\u044b\u043b\u043e"),l.a.createElement(T.g,null,y)),l.a.createElement(H,null))},je=function(e){var t=e.id,a=e.budgets,n=e.dispatch,c=e.date,o=void 0===c?new Date:c,r=a.map((function(e){return e.startSum})).reduce((function(e,t){return e+t}),0),u=a.map((function(e){return e.sum})).reduce((function(e,t){return e+t}),0);return l.a.createElement(T.s,{id:t},l.a.createElement(T.t,{left:l.a.createElement(T.v,{onClick:function(){return n({type:"SET_MODAL",payload:{modal:"add-budget"}})}},l.a.createElement(k.a,null))},"\u0411\u044e\u0434\u0436\u0435\u0442\u044b"),l.a.createElement(T.k,{header:l.a.createElement(T.l,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0431\u044e\u0434\u0436\u0435\u0442\u044b \u043d\u0430 ",Object(ue.a)(new Date(o),"MMM yyyy",{locale:ye.a})),separator:"show"},l.a.createElement(w,{data:a,dispatch:n,showAll:!0,itemsName:"budgets",needHide:!1}),l.a.createElement(T.i,null,"\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ",h(u)," \u0438\u0437 ",h(r))),l.a.createElement(H,null))},Se={title:"",startSum:"",validate:{title:{},startSum:{}}},_e=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload,n=a.validateForm,l=Object(B.a)(a,["validateForm"]);return Object(M.a)(Object(M.a)(Object(M.a)({},e),l),{},{validate:Object(M.a)(Object(M.a)({},e.validate),n)});default:return e}},Ce=function(e){var t,a,c,o,r,u,i,s,m,p,E,v,y=e.onRefresh,f=e.editedItem,b=void 0===f?null:f,g=Object(n.useReducer)(_e,Se),O=Object(d.a)(g,2),j=O[0],C=O[1],A=Object(n.useState)((function(){return b?"/budget/".concat(b._id):"/budget"})),w=Object(d.a)(A,1)[0],x=Q(w),D=Object(d.a)(x,2),I=D[0].response,k=D[1];return Object(n.useEffect)((function(){b&&(I||C({type:"CHANGE_STATE",payload:Object(M.a)({},b)}))}),[b,C,I]),Object(n.useEffect)((function(){I&&y()}),[y,I]),l.a.createElement(T.j,{onSubmit:function(){var e=Object(_.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,k({method:b?"PATCH":"POST",title:j.title,sum:j.startSum});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},l.a.createElement(T.n,{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u044e\u0434\u0436\u0435\u0442\u0430",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:j.title,required:!0,maxLength:"20",status:null===(t=j.validate)||void 0===t||null===(a=t.title)||void 0===a?void 0:a.status,bottom:(null===(c=j.validate)||void 0===c||null===(o=c.title)||void 0===o?void 0:o.message)?null===(r=j.validate)||void 0===r||null===(u=r.title)||void 0===u?void 0:u.message:"".concat(j.title.length," \u0438\u0437 20"),onChange:function(e){return C({type:"CHANGE_STATE",payload:{title:e.currentTarget.value,validateForm:{title:le(e)}}})}}),l.a.createElement(T.n,{type:"number",placeholder:h(0),top:"\u0411\u044e\u0434\u0436\u0435\u0442 \u0432 \u0440\u0443\u0431\u043b\u044f\u0445",value:j.startSum,required:!0,status:null===(i=j.validate)||void 0===i||null===(s=i.startSum)||void 0===s?void 0:s.status,max:999999999,step:.01,bottom:(null===(m=j.validate)||void 0===m||null===(p=m.startSum)||void 0===p?void 0:p.message)?null===(E=j.validate)||void 0===E||null===(v=E.startSum)||void 0===v?void 0:v.message:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u044b \u0433\u043e\u0442\u043e\u0432\u044b \u043d\u0430 \u044d\u0442\u043e \u043f\u043e\u0442\u0440\u0430\u0442\u0438\u0442\u044c?",onChange:function(e){return C({type:"CHANGE_STATE",payload:{startSum:e.currentTarget.value,validateForm:{startSum:le(e)}}})}}),l.a.createElement(T.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},Ae=a(160),we=a.n(Ae),xe=function(e){var t=e.id,a=e.budget,c=e.dispatch,o=e.onRefresh,r=Object(n.useState)(!1),u=Object(d.a)(r,2),i=u[0],s=u[1],m=Q("/budget/".concat(a._id)),p=Object(d.a)(m,2),E=p[0].response,v=p[1],y=Object(n.useState)((function(){return a.items})),f=Object(d.a)(y,2),b=f[0],g=f[1];Object(n.useEffect)((function(){g(a.items)}),[a]),Object(n.useEffect)((function(){E&&(null===E||void 0===E?void 0:E.deletedCount)&&(c({type:"SET_ACTIVE_VIEW",payload:{view:"home",panel:"home"}}),c({type:"SET_EDITED_ITEM",payload:{item:null}}),o())}),[E,c,o]);var O=function(){s(!i)},h=l.a.createElement(T.b,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",autoclose:!0,action:function(){var e=Object(_.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(),e.next=3,v({method:"DELETE"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],onClose:function(){O(),c({type:"SET_POPOUT",payload:{popout:null}})}},l.a.createElement("h2",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442?"),l.a.createElement("p",null,"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442?")),j=b.sort(ge).reduce(Te,[]).map(fe(c));return l.a.createElement(T.s,{id:t},l.a.createElement(T.t,{left:l.a.createElement(l.a.Fragment,null,l.a.createElement(T.u,{onClick:function(){c({type:"SET_ACTIVE_VIEW",payload:{view:"home",panel:"home"}}),c({type:"SET_EDITED_ITEM",payload:{item:null}}),c({type:"SET_BUDGET",payload:{id:null}})}}),l.a.createElement(T.v,{onClick:function(){c({type:"SET_EDITED_ITEM",payload:{item:null}}),c({type:"SET_MODAL",payload:{modal:"add-money"}})}},l.a.createElement(D.a,null)))},l.a.createElement(T.w,{aside:l.a.createElement(pe.a,{style:{transform:"rotate(".concat(i?"180deg":"0",")")}}),onClick:O},null===a||void 0===a?void 0:a.title)),l.a.createElement(T.x,{opened:i,onClose:O},l.a.createElement(T.o,null,l.a.createElement(T.e,{before:l.a.createElement(we.a,null),onClick:function(){c({type:"SET_MODAL",payload:{modal:"add-budget"}}),O()}},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442 ",null===a||void 0===a?void 0:a.title),l.a.createElement(T.e,{before:l.a.createElement(ve.a,null),onClick:function(){c({type:"SET_POPOUT",payload:{popout:h}})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442 ",null===a||void 0===a?void 0:a.title))),l.a.createElement(T.D,{onChange:function(e){var t;t=e.currentTarget.value,g(E.filter((function(e){return e.title.toLowerCase().indexOf(t)>-1})))}}),l.a.createElement(T.g,null,j),l.a.createElement(H,null))},De=function(){var e,t=Object(T.L)(),a=Q("/state"),c=Object(d.a)(a,2),o=c[0],r=o.response,u=o.isLoading,s=c[1],p=Object(n.useState)(!0),E=Object(d.a)(p,2),v=E[0],y=E[1],f=Object(n.useContext)(N),b=Object(d.a)(f,2),g=b[0],O=b[1],h=Object(n.useState)(null),j=Object(d.a)(h,2),S=j[0],_=j[1];Object(n.useEffect)((function(){v&&(s(),y(!1))}),[v,s]),Object(n.useEffect)((function(){r&&(O({type:"SET_ACCOUNTS",payload:{accounts:(null===r||void 0===r?void 0:r.accounts)?null===r||void 0===r?void 0:r.accounts:[]}}),O({type:"SET_BUDGETS",payload:{budgets:(null===r||void 0===r?void 0:r.budgets)?null===r||void 0===r?void 0:r.budgets:[]}}))}),[r,O]),Object(n.useEffect)((function(){if(S){var e=g.accounts.findIndex((function(e){return e._id===S._id}));if(-1===e){var t=[].concat(Object(i.a)(g.accounts),[S]);O({type:"SET_ACCOUNTS",payload:{accounts:t}})}else{var a=Object(i.a)(g.accounts);a.splice(e,1,S),O({type:"SET_ACCOUNTS",payload:{accounts:a}}),"info"===g.activeView&&"account"===g.activePanel&&O({type:"SET_ACCOUNT",payload:{id:S._id}})}_(null)}}),[S,O,g.accounts,_,g.activePanel,g.activeView]);var C=Object(n.useCallback)((function(){console.log("refresh"),y(!0)}),[]),A=function(){O({type:"SET_MODAL",payload:{modal:null}})},w=l.a.createElement(T.r,{activeModal:g.modal,onClose:A},l.a.createElement(T.p,{id:"add-account",header:l.a.createElement(T.q,{left:t===T.a&&l.a.createElement(T.v,{onClick:A},l.a.createElement(Y.a,null)),right:l.a.createElement(T.v,{onClick:A},t===T.m?"\u0413\u043e\u0442\u043e\u0432\u043e":l.a.createElement($.a,null))},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0447\u0435\u0442")},l.a.createElement(re,{setAccount:_})),l.a.createElement(T.p,{id:"add-money",header:l.a.createElement(T.q,{left:t===T.a&&l.a.createElement(T.v,{onClick:A},l.a.createElement(Y.a,null)),right:l.a.createElement(T.v,{onClick:A},t===T.m?"\u0413\u043e\u0442\u043e\u0432\u043e":l.a.createElement($.a,null))},g.editedItem?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c")},l.a.createElement(se,{accounts:g.accounts,id:null===(e=g.account)||void 0===e?void 0:e._id,setAccount:_,editedItem:g.editedItem})),l.a.createElement(T.p,{id:"add-budget",header:l.a.createElement(T.q,{left:t===T.a&&l.a.createElement(T.v,{onClick:A},l.a.createElement(Y.a,null)),right:l.a.createElement(T.v,{onClick:A},t===T.m?"\u0413\u043e\u0442\u043e\u0432\u043e":l.a.createElement($.a,null))},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442")},l.a.createElement(Ce,{editedItem:g.budget,onRefresh:C,dispatch:O}))),x=function(e){O({type:"SET_ACTIVE_VIEW",payload:{view:e.currentTarget.dataset.story,panel:e.currentTarget.dataset.panel}})},D=l.a.createElement(T.G,null,l.a.createElement(T.H,{onClick:x,selected:"home"===g.activeView,"data-story":"home","data-panel":"home",text:"\u0411\u0430\u043b\u0430\u043d\u0441"},l.a.createElement(te.a,null)),l.a.createElement(T.H,{onClick:x,selected:"info"===g.activeView&&"budgets"===g.activePanel,"data-story":"info","data-panel":"budgets",text:"\u0411\u044e\u0434\u0436\u0435\u0442\u044b"},l.a.createElement(ne.a,null)));return l.a.createElement(T.h,{activeStory:g.activeView,tabbar:D},l.a.createElement(m.a,{id:"home",activePanel:g.activePanel,popout:g.popout,modal:w},l.a.createElement(q,{id:"home",accounts:g.accounts,budgets:g.budgets,dispatch:O,isLoading:u,onRefresh:C,isFetching:u})),l.a.createElement(m.a,{id:"info",activePanel:g.activePanel,popout:g.popout,modal:w},l.a.createElement(he,{id:"account",account:g.account,dispatch:O,onRefresh:C}),l.a.createElement(xe,{id:"budget",budget:g.budgets.find((function(e){var t;return e._id===(null===(t=g.budget)||void 0===t?void 0:t._id)})),dispatch:O,onRefresh:C}),l.a.createElement(je,{id:"budgets",budgets:g.budgets,dispatch:O})))};u.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var l=document.createAttribute("scheme");l.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(l)}})),u.a.send("VKWebAppInit"),o.a.render(l.a.createElement(G,null,l.a.createElement(De,null)),document.getElementById("root"))}},[[202,1,2]]]);
//# sourceMappingURL=main.0aea41be.chunk.js.map