(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{203:function(e,t,a){e.exports=a(332)},332:function(e,t,a){"use strict";a.r(t);a(204),a(230),a(232),a(233),a(235),a(236),a(237),a(238),a(239),a(240),a(241),a(242),a(244),a(245),a(246),a(247),a(248),a(249),a(250),a(251),a(252),a(253),a(255),a(256),a(257),a(258),a(259),a(260),a(261),a(262),a(263),a(264),a(265),a(266),a(267),a(268),a(269),a(270),a(271),a(272);var n=a(0),u=a.n(n),l=a(141),o=a.n(l),r=a(25),c=a.n(r),i=a(29),d=a(8),s=a(62),m=a.n(s),E=(a(281),a(157)),p=a.n(E),D=a(158),v=a.n(D),f=a(63),y=a.n(f),b=a(98),O=a.n(b),h=a(3),g=function(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e)},C=a(75),T=a.n(C),j=function(e){var t=e.data,a=e.showAll,l=void 0!==a&&a,o=e.dispatch,r=e.itemsName,s=e.needHide,m=void 0===s||s,E=Object(n.useState)((function(){return l})),p=Object(d.a)(E,2),D=p[0],v=p[1];if(0===t.length){if("accounts"===r)return u.a.createElement(h.k,null,"\u041d\u0435\u0442 \u0441\u0447\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f");if("budgets"===r)return u.a.createElement(h.k,null,"\u041d\u0435\u0442 \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f")}var f=t.sort((function(e,t){return t.sum-e.sum})).map((function(e,t){return 3!==t||D?t>3&&!D?null:u.a.createElement(T.a,{key:t,indicator:g(e.sum),expandable:!0,"data-id":e._id,onClick:function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("accounts"!==r){e.next=5;break}return e.next=3,o({type:"SET_ACCOUNT",payload:{id:t.currentTarget.dataset.id}});case 3:return e.next=5,o({type:"SET_ACTIVE_VIEW",payload:{view:"info",panel:"account"}});case 5:if("budgets"!==r){e.next=10;break}return e.next=8,o({type:"SET_BUDGET",payload:{id:t.currentTarget.dataset.id}});case 8:return e.next=10,o({type:"SET_ACTIVE_VIEW",payload:{view:"info",panel:"budget"}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},e.title):u.a.createElement(T.a,{key:t,expandable:!0,onClick:function(){v(!0)}},u.a.createElement(h.M,{weight:"semibold",style:{marginBottom:16}},"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"))}));return m&&D&&f.push(u.a.createElement(T.a,{key:t.length,expandable:!0,onClick:function(){v(!1)}},u.a.createElement(h.M,{weight:"semibold",style:{marginBottom:16}},"accounts"===r?"\u0421\u043a\u0440\u044b\u0442\u044c \u0441\u0447\u0435\u0442\u0430":"\u0421\u043a\u0440\u044b\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442\u044b"))),f},S=a(55),A=a.n(S),F=a(72),_=a.n(F),w=a(37),x=a(7),B={accounts:[],budgets:[],account:null,budget:null,modal:null,successMessage:null,error:null,activeView:"init",activePanel:"init",popout:null,editedItem:null,currentDate:new Date,history:[],modalsHistory:[],popoutHistory:[],canClose:!0,scheme:"client_light"},k=function(e,t){switch(t.type){case"SET_COLOR_SCHEME":return Object(x.a)(Object(x.a)({},e),{},{scheme:t.payload.scheme});case"SET_ACTIVE_VIEW":window.history.pushState(null,null);var a=e.history;if(0!==a.length){var n=a[a.length-1];return n.view===t.payload.view&&n.panel===t.payload.panel?Object(x.a)({},e):Object(x.a)(Object(x.a)({},e),{},{activeView:t.payload.view,activePanel:t.payload.panel,history:[].concat(Object(w.a)(a),[{view:t.payload.view,panel:t.payload.panel}]),canClose:!1})}return Object(x.a)(Object(x.a)({},e),{},{activeView:t.payload.view,activePanel:t.payload.panel,history:[].concat(Object(w.a)(a),[{view:t.payload.view,panel:t.payload.panel}]),canClose:!0});case"SET_HISTORY_BACK":window.history.pushState(null,null);var u=e.history[e.history.length-2],l=e.popoutHistory||[],o=e.modalsHistory||[];if(0!==l.length){var r=e.history.length<=1;return Object(x.a)(Object(x.a)({},e),{},{popout:null,popoutHistory:[],canClose:r,editedItem:null})}if(0!==o.length){var c=e.history.length<=1;return Object(x.a)(Object(x.a)({},e),{},{modal:null,modalsHistory:[],canClose:c,editedItem:null})}if(u){var i="home"===u.view&&"home"===u.panel,d=e.history;return d.pop(),Object(x.a)(Object(x.a)({},e),{},{activeView:u.view,activePanel:u.panel,history:Object(w.a)(d),editedItem:null,canClose:i})}return Object(x.a)(Object(x.a)({},e),{},{activeView:"home",activePanel:"home",history:[],canClose:!0,editedItem:null});case"SET_ACCOUNTS":var s,m=null===(s=e.account)||void 0===s?void 0:s._id,E=m?t.payload.accounts.find((function(e){return e._id===m})):m;return Object(x.a)(Object(x.a)({},e),{},{accounts:t.payload.accounts,account:E});case"SET_BUDGETS":var p,D=null===(p=e.budget)||void 0===p?void 0:p._id,v=D?t.payload.budgets.find((function(e){return e._id===D})):D;return Object(x.a)(Object(x.a)({},e),{},{budgets:t.payload.budgets,budget:v});case"SET_ACCOUNT":var f=t.payload.id;return Object(x.a)(Object(x.a)({},e),{},{account:e.accounts.find((function(e){return e._id===f}))});case"SET_BUDGET":var y=t.payload.id;return Object(x.a)(Object(x.a)({},e),{},{budget:y?e.budgets.find((function(e){return e._id===y})):y});case"SET_EDITED_ITEM":return Object(x.a)(Object(x.a)({},e),{},{editedItem:t.payload.item});case"SET_POPOUT":window.history.pushState(null,null);var b=e.history,O=e.canClose;return 0!==b.length||t.payload.popout?O=1===b.length&&!t.payload.popout:0!==b.length||t.payload.popout||(O=!0),Object(x.a)(Object(x.a)({},e),{},{popout:t.payload.popout,popoutHistory:t.payload.popout?[t.payload.popout]:[],canClose:O});case"SET_MODAL":window.history.pushState(null,null);var h=e.history,g=e.canClose;return 0!==h.length||t.payload.modal?g=1===h.length&&!t.payload.modal:0!==h.length||t.payload.modal||(g=!0),Object(x.a)(Object(x.a)({},e),{},{modal:t.payload.modal,modalsHistory:t.payload.modal?[t.payload.modal]:[],canClose:g});case"SET_SUCCESS_MESSAGE":return Object(x.a)(Object(x.a)({},e),{},{successMessage:t.payload.message});case"SET_ERROR":return Object(x.a)(Object(x.a)({},e),{},{error:t.payload.error});case"SET_DATE":return Object(x.a)(Object(x.a)({},e),{},{currentDate:new Date(t.payload.date)});default:return e}},I=Object(n.createContext)(),M=function(e){var t=e.children,a=Object(n.useReducer)(k,B);return u.a.createElement(I.Provider,{value:a},t)},P=a(152),R=a.n(P),L=a(153),H=a.n(L),V=function(){var e=Object(n.useContext)(I),t=Object(d.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(null),r=Object(d.a)(o,2),c=r[0],i=r[1];return Object(n.useEffect)((function(){a.error&&i(u.a.createElement(h.I,{onClose:function(){l({type:"SET_ERROR",payload:{error:null}}),i(null)},before:u.a.createElement(R.a,{style:{color:"var(--destructive)"}})},a.error.message))}),[i,l,a.error]),Object(n.useEffect)((function(){a.successMessage&&i(u.a.createElement(h.I,{onClose:function(){l({type:"SET_SUCCESS_MESSAGE",payload:{message:null}}),i(null)},before:u.a.createElement(H.a,{style:{color:"var(--accent)"}})},a.successMessage))}),[i,l,a.successMessage]),u.a.createElement(u.a.Fragment,null,c)},G=a(334),N=a(154),q=a(335),U=a(336),K=a(64),W=a(155),z=a.n(W),Y=a(156),J=a.n(Y),Q=function(e){var t=e.onRefresh,a=Object(n.useContext)(I),l=Object(d.a)(a,2),o=l[0],r=l[1],c=Object(G.a)(Object(N.a)(o.currentDate,1),new Date),i=Object(n.useState)(0),s=Object(d.a)(i,2),m=s[0],E=s[1];return u.a.createElement(h.m,null,u.a.createElement(h.e,{before:u.a.createElement(h.c,{onClick:function(){var e=+new Date;e-m>500&&(r({type:"SET_DATE",payload:{date:Object(q.a)(o.currentDate,1)}}),t(),E(e))},mode:"secondary"},u.a.createElement(z.a,null)),asideContent:u.a.createElement(h.c,{disabled:c,onClick:function(){var e=+new Date;e-m>500&&(r({type:"SET_DATE",payload:{date:Object(N.a)(o.currentDate,1)}}),t(),E(e))},mode:"secondary"},u.a.createElement(J.a,null)),style:{textAlign:"center",fontWeight:"bold"}},Object(U.a)(o.currentDate,"LLLL yyyy",{locale:K.a}).toLocaleUpperCase()))},X=function(e){var t=e.id,a=e.accounts,n=e.budgets,l=e.dispatch,o=e.onRefresh,r=e.isFetching,c=a.map((function(e){return e.sum})).reduce((function(e,t){return e+t}),0);return u.a.createElement(p.a,{id:t},u.a.createElement(v.a,{left:u.a.createElement(u.a.Fragment,null,u.a.createElement(h.x,{onClick:function(){l({type:"SET_MODAL",payload:{modal:"add-account"}})}},u.a.createElement(_.a,null)),0!==a.length&&u.a.createElement(h.x,{onClick:function(){l({type:"SET_ACCOUNT",payload:{id:null}}),l({type:"SET_MODAL",payload:{modal:"add-money"}})}},u.a.createElement(A.a,null)))},"\u0411\u0430\u043b\u0430\u043d\u0441"),u.a.createElement(Q,{onRefresh:o}),u.a.createElement(h.C,{onRefresh:o,isFetching:r},u.a.createElement(h.q,null,u.a.createElement(y.a,{header:u.a.createElement(h.n,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0441\u0447\u0435\u0442\u0430"),separator:"show"},u.a.createElement(O.a,null,u.a.createElement(h.O,{level:"1",weight:"semibold",style:{marginBottom:16}},g(c)),u.a.createElement(j,{data:a,dispatch:l,showAll:!1,itemsName:"accounts"}))),u.a.createElement(y.a,{header:u.a.createElement(h.n,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0431\u044e\u0434\u0436\u0435\u0442\u044b"),separator:"show"},u.a.createElement(O.a,null,u.a.createElement(j,{data:n,dispatch:l,showAll:!1,itemsName:"budgets"}))))),u.a.createElement(V,null))},Z=a(56),$=a(99),ee=a.n($),te=a(159),ae=a.n(te),ne=function(e){var t=Object(n.useState)(!1),a=Object(d.a)(t,2),l=a[0],o=a[1],r=Object(n.useState)(null),s=Object(d.a)(r,2),m=s[0],E=s[1],p=Object(n.useState)(null),D=Object(d.a)(p,2),v=D[0],f=D[1],y=Object(n.useState)({}),b=Object(d.a)(y,2),O=b[0],g=b[1],C=Object(n.useContext)(I),T=Object(d.a)(C,2)[1],j=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(e),E(null),f(null),o(!0),T({type:"SET_POPOUT",payload:{popout:u.a.createElement(h.B,null,u.a.createElement(h.F,null))}})}),[T]),S=O.method,A=void 0===S?"GET":S,F=O.params,_=Object(Z.a)(O,["method","params"]),w={method:A,baseURL:"https://balance.z-labz.ru/api",url:e,headers:{"Content-Type":"application/json"},params:F?Object(x.a)(Object(x.a)({},F),ee.a.parse(window.location.search)):Object(x.a)({},ee.a.parse(window.location.search)),data:"GET"!==A?_:null};return Object(n.useEffect)((function(){l&&function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!1),e.next=3,ae()(w).then(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t.data.data),T({type:"SET_POPOUT",payload:{popout:null}}),T({type:"SET_MODAL",payload:{modal:null}}),T({type:"SET_SUCCESS_MESSAGE",payload:{message:t.data.message}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t=(null===e||void 0===e?void 0:e.response)?e.response.data.error:new Error("\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043a API");f(t),o(!1),T({type:"SET_POPOUT",payload:{popout:null}}),T({type:"SET_MODAL",payload:{modal:null}}),T({type:"SET_ERROR",payload:{error:t}})}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[l,w,T]),[{isLoading:l,response:m,error:v},j]},ue=a(30),le=a.n(ue),oe=a(53),re=a.n(oe),ce=a(164),ie=a.n(ce),de=a(165),se=a.n(de),me=a(166),Ee=a.n(me),pe=function(e){var t=e.currentTarget.validity;return t.valid&&" "!==e.currentTarget.value?{status:"valid",message:null}:t.badInput||t.valueMissing||" "===e.currentTarget.value?{status:"error",message:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0432\u043e\u0434\u0430 | \u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}:t.tooLong?{status:"error",message:"\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430"}:t.typeMismatch?{status:"error",message:"\u041d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0442\u0438\u043f\u0430"}:t.stepMismatch?{status:"error",message:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c"}:t.rangeOverflow?"date"===e.currentTarget.type?{status:"error",message:"\u041d\u0435\u043b\u044c\u0437\u044f \u0432\u0432\u0435\u0441\u0442\u0438 \u0431\u0443\u0434\u0443\u0449\u0443\u044e \u0434\u0430\u0442\u0443"}:{status:"error",message:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u0447\u0438\u0441\u043b\u043e"}:t.rangeUnderflow?"date"===e.currentTarget.type?{status:"error",message:"\u041d\u0435\u043b\u044c\u0437\u044f \u0432\u0432\u0435\u0441\u0442\u0438 \u0434\u0430\u0442\u0443 \u0440\u0430\u043d\u044c\u0448\u0435 1 \u044f\u043d\u0432\u0430\u0440\u044f 2015"}:{status:"error",message:"\u041d\u0435\u043b\u044c\u0437\u044f \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0447\u0438\u0441\u043b\u0430"}:{status:"default",message:null}},De=function(e){return e.replace(/^\s*/g,"").replace(/\s{2,}/g," ").replace(/(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])/g,"")},ve={title:"",sum:"",titleValidation:{},sumValidation:{}},fe=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload;return Object(x.a)(Object(x.a)({},e),a);default:return e}},ye=function(e){var t=e.onRefresh,a=Object(n.useReducer)(fe,ve),l=Object(d.a)(a,2),o=l[0],r=l[1],s=ne("/money-box"),m=Object(d.a)(s,2),E=m[0].response,p=m[1];return Object(n.useEffect)((function(){E&&t()}),[E,t]),u.a.createElement(h.l,{onSubmit:function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,p({method:"POST",title:o.title,sum:o.sum});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},u.a.createElement(h.p,{type:"text",placeholder:"\u041a\u0430\u0440\u0442\u0430, \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0435, \u0441\u0447\u0435\u0442 \u0432 \u0431\u0430\u043d\u043a\u0435",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:o.title,required:!0,maxLength:"20",status:o.titleValidation.status,bottom:o.titleValidation.message?o.titleValidation.message:"".concat(o.title.length," \u0438\u0437 20"),onChange:function(e){return r({type:"CHANGE_STATE",payload:{title:De(e.currentTarget.value),titleValidation:pe(e)}})}}),u.a.createElement(h.p,{type:"number",placeholder:g(0),top:"\u0411\u0430\u043b\u0430\u043d\u0441 \u0441\u0447\u0435\u0442\u0430",value:o.sum,required:!0,status:o.sumValidation.status,max:999999999,min:0,step:.01,bottom:o.sumValidation.message?o.sumValidation.message:"\u0414\u0435\u043d\u0435\u0436\u043d\u044b\u0435 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430, \u043d\u0430\u0445\u043e\u0434\u044f\u0449\u0438\u0435\u0441\u044f \u043d\u0430 \u0441\u0447\u0435\u0442\u0435 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442",onChange:function(e){return r({type:"CHANGE_STATE",payload:{sum:e.currentTarget.value,sumValidation:pe(e)}})}}),u.a.createElement(h.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},be={account:"",title:"",date:Object(U.a)(new Date,"yyyy-MM-dd"),income:!1,description:"",price:"",quantity:"",tags:[],boxPrice:!1,validate:{account:{},title:{},description:{},price:{},quantity:{},tags:{}}},Oe=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload,n=a.validateForm,u=Object(Z.a)(a,["validateForm"]);return Object(x.a)(Object(x.a)(Object(x.a)({},e),u),{},{validate:Object(x.a)(Object(x.a)({},e.validate),n)});default:return e}},he=function(e){var t,a,l,o,r,c,i,s,m,E,p,D,v,f,y,b,O,C,T,j,S,A,F,_,w,B,k,I,M,P,R,L,H,V,G=e.accounts,N=e.id,q=void 0===N?null:N,K=e.editedItem,W=void 0===K?null:K,z=e.onRefresh,Y=e.budget,J=Object(n.useState)((function(){return W?"/item/".concat(W._id):"/item"})),Q=Object(d.a)(J,1)[0],X=ne(Q),Z=Object(d.a)(X,2),$=Z[0].response,ee=Z[1],te=Object(n.useReducer)(Oe,be),ae=Object(d.a)(te,2),ue=ae[0],le=ae[1],oe=G.map((function(e){return u.a.createElement("option",{key:e._id,value:e._id},e.title," (",g(e.sum),")")}));Object(n.useEffect)((function(){W&&(W.date=Object(U.a)(new Date(W.date),"yyyy-MM-dd"),le({type:"CHANGE_STATE",payload:Object(x.a)({},W)}))}),[W,le]),Object(n.useEffect)((function(){(null===Y||void 0===Y?void 0:Y.title)&&le({type:"CHANGE_STATE",payload:{tags:""!==(null===Y||void 0===Y?void 0:Y.title)?null===Y||void 0===Y?void 0:Y.title.toLowerCase().split(" "):[]}})}),[Y,le]),Object(n.useEffect)((function(){$&&z()}),[$,z]);var re=ue.tags.map((function(e,t){return u.a.createElement(h.h,{style:{marginRight:"5px",marginBottom:"5px"},key:t},e)}));return u.a.createElement(h.l,{onSubmit:function(e){e.preventDefault(),ee({method:W?"PATCH":"POST",date:ue.date,title:ue.title,description:ue.description,price:ue.boxPrice?(ue.price/ue.quantity).toFixed(4):ue.price,quantity:ue.quantity,income:ue.income,tags:ue.tags,itemFrom:(null===W||void 0===W?void 0:W.itemFrom)||q||ue.account})}},u.a.createElement(h.H,{top:"\u0421\u0447\u0435\u0442",placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0447\u0435\u0442",onChange:function(e){le({type:"CHANGE_STATE",payload:{account:e.currentTarget.value,validateForm:{account:pe(e)}}})},defaultValue:(null===W||void 0===W?void 0:W.itemFrom)||q||ue.account,required:!0,status:null===(t=ue.validate)||void 0===t||null===(a=t.account)||void 0===a?void 0:a.status,bottom:null===(l=ue.validate)||void 0===l||null===(o=l.account)||void 0===o?void 0:o.message},oe),u.a.createElement(h.p,{type:"date",top:"\u0414\u0430\u0442\u0430",value:ue.date,required:!0,min:"2015-01-01",max:Object(U.a)(new Date,"yyyy-MM-dd"),onChange:function(e){le({type:"CHANGE_STATE",payload:{date:e.currentTarget.value,validateForm:{date:pe(e)}}})},status:null===(r=ue.validate)||void 0===r||null===(c=r.date)||void 0===c?void 0:c.status,bottom:null===(i=ue.validate)||void 0===i||null===(s=i.date)||void 0===s?void 0:s.message}),u.a.createElement(h.p,{type:"text",placeholder:"\u041f\u0440\u043e\u0434\u0443\u043a\u0442, \u0443\u0441\u043b\u0443\u0433\u0430, \u0442\u043e\u0432\u0430\u0440",value:ue.title,top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,maxLength:20,status:null===(m=ue.validate)||void 0===m||null===(E=m.title)||void 0===E?void 0:E.status,bottom:(null===(p=ue.validate)||void 0===p||null===(D=p.title)||void 0===D?void 0:D.message)?null===(v=ue.validate)||void 0===v||null===(f=v.title)||void 0===f?void 0:f.message:"".concat(ue.title.length," \u0438\u0437 20"),onChange:function(e){le({type:"CHANGE_STATE",payload:{title:De(e.currentTarget.value),validateForm:{title:pe(e)}}})}}),u.a.createElement(h.D,{name:"income",value:!1,defaultChecked:!ue.income||null,onClick:function(){le({type:"CHANGE_STATE",payload:{income:!1}})}},"\u0420\u0430\u0441\u0445\u043e\u0434"),u.a.createElement(h.D,{name:"income",value:!0,defaultChecked:!!ue.income||null,onClick:function(){le({type:"CHANGE_STATE",payload:{income:!0}})}},"\u0414\u043e\u0445\u043e\u0434"),!ue.income&&u.a.createElement(h.N,{top:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430(\u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430, \u0443\u0441\u043b\u0443\u0433\u0438)",value:ue.description,maxLength:70,status:null===(y=ue.validate)||void 0===y||null===(b=y.description)||void 0===b?void 0:b.status,bottom:(null===(O=ue.validate)||void 0===O||null===(C=O.description)||void 0===C?void 0:C.message)?null===(T=ue.validate)||void 0===T||null===(j=T.description)||void 0===j?void 0:j.message:"".concat(ue.description.length," \u0438\u0437 70"),onChange:function(e){le({type:"CHANGE_STATE",payload:{description:De(e.currentTarget.value),validateForm:{description:pe(e)}}})}}),u.a.createElement(h.p,{type:"text",top:"\u0422\u0435\u0433\u0438",value:ue.tags.join(" "),placeholder:"\u0422\u0435\u0433\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u0431\u0435\u043b",status:null===(S=ue.validate)||void 0===S||null===(A=S.tags)||void 0===A?void 0:A.status,maxLength:100,bottom:(null===(F=ue.validate)||void 0===F||null===(_=F.tags)||void 0===_?void 0:_.message)?null===(w=ue.validate)||void 0===w||null===(B=w.tags)||void 0===B?void 0:B.message:"".concat(ue.tags.join(" ").length," \u0438\u0437 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),onChange:function(e){le({type:"CHANGE_STATE",payload:{tags:""!==e.currentTarget.value?De(e.currentTarget.value).toLowerCase().split(" "):[],validateForm:{tags:pe(e)}}})}}),0!==ue.tags.length&&u.a.createElement(h.i,{style:{display:"flex",flexWrap:"wrap"}},re),u.a.createElement(h.p,{type:"number",placeholder:g(0),top:"\u0426\u0435\u043d\u0430",max:99999999,min:0,step:1e-4,status:null===(k=ue.validate)||void 0===k||null===(I=k.price)||void 0===I?void 0:I.status,bottom:null===(M=ue.validate)||void 0===M||null===(P=M.price)||void 0===P?void 0:P.message,value:ue.price,required:!0,onChange:function(e){le({type:"CHANGE_STATE",payload:{price:e.currentTarget.value,validateForm:{price:pe(e)}}})}}),!ue.income&&u.a.createElement(h.f,{value:ue.boxPrice,onClick:function(){le({type:"CHANGE_STATE",payload:{boxPrice:!ue.boxPrice}})}},"\u0426\u0435\u043d\u0430 \u0437\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0443"),u.a.createElement(h.p,{type:"number",placeholder:"0",top:"\u041a\u043e\u043b-\u0432\u043e",max:9999999,min:0,step:.001,status:null===(R=ue.validate)||void 0===R||null===(L=R.quantity)||void 0===L?void 0:L.status,bottom:null===(H=ue.validate)||void 0===H||null===(V=H.quantity)||void 0===V?void 0:V.message,value:ue.quantity,required:!0,onChange:function(e){le({type:"CHANGE_STATE",payload:{quantity:e.currentTarget.value,validateForm:{quantity:pe(e)}}})}}),u.a.createElement(h.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c ".concat(ue.boxPrice?g(ue.price):g(ue.price*ue.quantity))))},ge=a(73),Ce=a.n(ge),Te=a(74),je=a.n(Te);function Se(e){return function(t,a){return(null===t||void 0===t?void 0:t.titleDate)?u.a.createElement(h.d,{level:"2",weight:"semibold",caps:!0,key:a},Object(U.a)(new Date(null===t||void 0===t?void 0:t.titleDate),"dd MMMM yyyy",{locale:K.a})):u.a.createElement(h.E,{key:a,multiline:!0,caption:Object(U.a)(new Date(null===t||void 0===t?void 0:t.date),"dd MMMM yyyy",{locale:K.a}),after:(null===t||void 0===t?void 0:t.income)?g(null===t||void 0===t?void 0:t.sum):g(-1*(null===t||void 0===t?void 0:t.sum)),"data-id":null===t||void 0===t?void 0:t._id,onClick:function(){e({type:"SET_EDITED_ITEM",payload:{item:t}}),e({type:"SET_MODAL",payload:{modal:"add-money"}})}},null===t||void 0===t?void 0:t.title)}}var Ae=a(160),Fe=function(e,t){var a=new Date(e.date),n=new Date(t.date);return Object(Ae.a)(n,a)},_e=a(161),we=function(e,t){var a;return Object(_e.a)(new Date(null===(a=e[e.length-1])||void 0===a?void 0:a.date),new Date(t.date))?[].concat(Object(w.a)(e),[t]):[].concat(Object(w.a)(e),[{titleDate:t.date},t])},xe=function(e){var t=e.id,a=e.account,l=e.dispatch,o=e.onRefresh,r=Object(n.useState)(!1),s=Object(d.a)(r,2),m=s[0],E=s[1],p=ne("/money-box/".concat(null===a||void 0===a?void 0:a._id)),D=Object(d.a)(p,2),v=D[0].response,f=D[1],b=Object(n.useState)((function(){return a?null===a||void 0===a?void 0:a.operations:[]})),O=Object(d.a)(b,2),C=O[0],T=O[1],j=Object(n.useState)((function(){return C||[]})),S=Object(d.a)(j,2),F=S[0],_=S[1],w=F.sort(Fe).reduce(we,[]).map(Se(l)),x=function(){E(!m)},B=u.a.createElement(h.b,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mode:"destructive",autoclose:!0,action:function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(),e.next=3,f({method:"DELETE"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],onClose:function(){x(),l({type:"SET_POPOUT",payload:{popout:null}})}},u.a.createElement("h2",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0447\u0435\u0442?"),u.a.createElement("p",null,"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u0442 \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0432\u0441\u0435\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0434\u043e\u0445\u043e\u0434\u0430\u043c \u0438 \u0440\u0430\u0441\u0445\u043e\u0434\u0430\u043c, \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u043c \u043a \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0441\u0447\u0435\u0442\u0443. \u0421\u0443\u043c\u043c\u044b \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u0432 \u043c\u043e\u0433\u0443\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e."));Object(n.useEffect)((function(){a&&(T(null===a||void 0===a?void 0:a.operations),_(null===a||void 0===a?void 0:a.operations))}),[a]),Object(n.useEffect)((function(){v&&(l({type:"SET_HISTORY_BACK"}),l({type:"SET_EDITED_ITEM",payload:{item:null}}),o())}),[l,v,o]);return u.a.createElement(h.u,{id:t},u.a.createElement(h.v,{left:u.a.createElement(u.a.Fragment,null,u.a.createElement(h.w,{onClick:function(){l({type:"SET_HISTORY_BACK"}),l({type:"SET_EDITED_ITEM",payload:{item:null}})}}),u.a.createElement(h.x,{onClick:function(){l({type:"SET_EDITED_ITEM",payload:{item:null}}),l({type:"SET_MODAL",payload:{modal:"add-money"}})}},u.a.createElement(A.a,null)))},u.a.createElement(h.y,{aside:a&&u.a.createElement(Ce.a,{style:{transform:"rotate(".concat(m?"180deg":"0",")")}}),onClick:x},a?null===a||void 0===a?void 0:a.title:"\u0421\u0447\u0435\u0442 \u0443\u0434\u0430\u043b\u0451\u043d")),a&&u.a.createElement(u.a.Fragment,null,u.a.createElement(h.z,{opened:m,onClose:x},u.a.createElement(h.q,null,u.a.createElement(h.e,{before:u.a.createElement(je.a,null),onClick:function(){l({type:"SET_POPOUT",payload:{popout:B}})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0447\u0435\u0442 ",null===a||void 0===a?void 0:a.title))),u.a.createElement(Q,{onRefresh:o}),u.a.createElement(h.G,{onChange:function(e){var t;t=e.currentTarget.value,_(""===t?C:null===a||void 0===a?void 0:a.operations.filter((function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1})))}}),u.a.createElement(y.a,{header:u.a.createElement(h.n,{mode:"secondary"},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u0441\u0447\u0435\u0442\u0443"),separator:"show"},u.a.createElement(h.i,null,u.a.createElement(h.O,{level:"1",weight:"semibold",style:{marginBottom:16}},g(null===a||void 0===a?void 0:a.sum))),0===(null===a||void 0===a?void 0:a.operations.length)&&u.a.createElement(h.k,null,"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u043f\u043e \u0441\u0447\u0435\u0442\u0443 \u0435\u0449\u0435 \u043d\u0435 \u0431\u044b\u043b\u043e"),u.a.createElement(h.i,null,w,0===w.length&&u.a.createElement(h.k,null,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"))),u.a.createElement(V,null)))},Be=function(e){var t=e.id,a=e.budgets,n=e.dispatch,l=e.date,o=void 0===l?new Date:l,r=e.onRefresh,c=a.map((function(e){return e.startSum})).reduce((function(e,t){return e+t}),0),i=a.map((function(e){return e.sum})).reduce((function(e,t){return e+t}),0);return u.a.createElement(h.u,{id:t},u.a.createElement(h.v,{left:u.a.createElement(h.x,{onClick:function(){return n({type:"SET_MODAL",payload:{modal:"add-budget"}})}},u.a.createElement(_.a,null))},"\u0411\u044e\u0434\u0436\u0435\u0442\u044b"),u.a.createElement(Q,{onRefresh:r}),u.a.createElement(h.m,{header:u.a.createElement(h.n,{mode:"secondary"},"\u0412\u0430\u0448\u0438 \u0431\u044e\u0434\u0436\u0435\u0442\u044b \u043d\u0430 ",Object(U.a)(new Date(o),"dd MMMM yyyy",{locale:K.a})),separator:"show"},u.a.createElement(j,{data:a,dispatch:n,showAll:!0,itemsName:"budgets",needHide:!1}),u.a.createElement(h.k,null,"\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ",g(i)," \u0438\u0437 ",g(c))),u.a.createElement(V,null))},ke={title:"",startSum:"",validate:{title:{},startSum:{}}},Ie=function(e,t){switch(t.type){case"CHANGE_STATE":var a=t.payload,n=a.validateForm,u=Object(Z.a)(a,["validateForm"]);return Object(x.a)(Object(x.a)(Object(x.a)({},e),u),{},{validate:Object(x.a)(Object(x.a)({},e.validate),n)});default:return e}},Me=function(e){var t,a,l,o,r,s,m,E,p,D,v,f,y=e.onRefresh,b=e.editedItem,O=void 0===b?null:b,C=Object(n.useReducer)(Ie,ke),T=Object(d.a)(C,2),j=T[0],S=T[1],A=Object(n.useState)((function(){return O?"/budget/".concat(O._id):"/budget"})),F=Object(d.a)(A,1)[0],_=ne(F),w=Object(d.a)(_,2),B=w[0].response,k=w[1];return Object(n.useEffect)((function(){O&&(B||S({type:"CHANGE_STATE",payload:Object(x.a)({},O)}))}),[O,S,B]),Object(n.useEffect)((function(){B&&y()}),[y,B]),u.a.createElement(h.l,{onSubmit:function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,k({method:O?"PATCH":"POST",title:j.title,sum:j.startSum});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},u.a.createElement(h.p,{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u044e\u0434\u0436\u0435\u0442\u0430",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:j.title,required:!0,maxLength:"20",status:null===(t=j.validate)||void 0===t||null===(a=t.title)||void 0===a?void 0:a.status,bottom:(null===(l=j.validate)||void 0===l||null===(o=l.title)||void 0===o?void 0:o.message)?null===(r=j.validate)||void 0===r||null===(s=r.title)||void 0===s?void 0:s.message:"".concat(j.title.length," \u0438\u0437 20"),onChange:function(e){return S({type:"CHANGE_STATE",payload:{title:De(e.currentTarget.value),validateForm:{title:pe(e)}}})}}),u.a.createElement(h.p,{type:"number",placeholder:g(0),top:"\u0411\u044e\u0434\u0436\u0435\u0442 \u0432 \u0440\u0443\u0431\u043b\u044f\u0445",value:j.startSum,required:!0,status:null===(m=j.validate)||void 0===m||null===(E=m.startSum)||void 0===E?void 0:E.status,min:0,max:999999999,step:.01,bottom:(null===(p=j.validate)||void 0===p||null===(D=p.startSum)||void 0===D?void 0:D.message)?null===(v=j.validate)||void 0===v||null===(f=v.startSum)||void 0===f?void 0:f.message:"\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u044b \u0433\u043e\u0442\u043e\u0432\u044b \u043d\u0430 \u044d\u0442\u043e \u043f\u043e\u0442\u0440\u0430\u0442\u0438\u0442\u044c?",onChange:function(e){return S({type:"CHANGE_STATE",payload:{startSum:e.currentTarget.value,validateForm:{startSum:pe(e)}}})}}),u.a.createElement(h.c,{size:"xl"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},Pe=a(162),Re=a.n(Pe),Le=function(e){var t=e.id,a=e.budget,l=e.dispatch,o=e.onRefresh,r=Object(n.useState)(!1),s=Object(d.a)(r,2),m=s[0],E=s[1],p=ne("/budget/".concat(null===a||void 0===a?void 0:a._id)),D=Object(d.a)(p,2),v=D[0].response,f=D[1],y=Object(n.useState)((function(){return null===a||void 0===a?void 0:a.items})),b=Object(d.a)(y,2),O=b[0],g=b[1],C=Object(n.useState)((function(){return O})),T=Object(d.a)(C,2),j=T[0],S=T[1];Object(n.useEffect)((function(){g(null===a||void 0===a?void 0:a.items),S(null===a||void 0===a?void 0:a.items)}),[a]),Object(n.useEffect)((function(){v&&(null===v||void 0===v?void 0:v.deletedCount)&&(l({type:"SET_HISTORY_BACK"}),l({type:"SET_EDITED_ITEM",payload:{item:null}}),o())}),[v,l,o]);var F=function(){E(!m)},_=u.a.createElement(h.b,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mode:"destructive",autoclose:!0,action:function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(),e.next=3,f({method:"DELETE"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],onClose:function(){F(),l({type:"SET_POPOUT",payload:{popout:null}})}},u.a.createElement("h2",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442?"),u.a.createElement("p",null,"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442?")),w=j&&j.sort(Fe).reduce(we,[]).map(Se(l));return u.a.createElement(h.u,{id:t},u.a.createElement(h.v,{left:u.a.createElement(u.a.Fragment,null,u.a.createElement(h.w,{onClick:function(){l({type:"SET_HISTORY_BACK"})}}),u.a.createElement(h.x,{onClick:function(){l({type:"SET_EDITED_ITEM",payload:{item:null}}),l({type:"SET_MODAL",payload:{modal:"add-money"}})}},u.a.createElement(A.a,null)))},u.a.createElement(h.y,{aside:a&&u.a.createElement(Ce.a,{style:{transform:"rotate(".concat(m?"180deg":"0",")")}}),onClick:F},a?null===a||void 0===a?void 0:a.title:"\u0411\u044e\u0434\u0436\u0435\u0442 \u0443\u0434\u0430\u043b\u0451\u043d")),a&&u.a.createElement(u.a.Fragment,null,u.a.createElement(h.z,{opened:m,onClose:F},u.a.createElement(h.q,null,u.a.createElement(h.e,{before:u.a.createElement(Re.a,null),onClick:function(){l({type:"SET_EDITED_ITEM",payload:{item:a}}),l({type:"SET_MODAL",payload:{modal:"add-budget"}}),F()}},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442 ",null===a||void 0===a?void 0:a.title),u.a.createElement(h.e,{before:u.a.createElement(je.a,null),onClick:function(){l({type:"SET_POPOUT",payload:{popout:_}})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442 ",null===a||void 0===a?void 0:a.title))),u.a.createElement(h.G,{onChange:function(e){var t;t=e.currentTarget.value,S(""===t?O:a.items.filter((function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1})))}}),u.a.createElement(h.i,null,w,0===(null===w||void 0===w?void 0:w.length)&&u.a.createElement(h.k,null,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f")),u.a.createElement(V,null)))},He=function(e){var t=e.id,a=e.accounts,l=e.onRefresh,o=Object(n.useState)((function(){return a.map((function(e){return e.operations})).flat().filter((function(e){return!e.income})).sort((function(e,t){return e.title.localeCompare(t.title)}))})),r=Object(d.a)(o,2),c=r[0],i=r[1],s=Object(n.useState)((function(){return c})),m=Object(d.a)(s,2),E=m[0],p=m[1],D=E.reduce((function(e,t){var a;if((null===(a=e[e.length-1])||void 0===a?void 0:a.title)===t.title){var n=e[e.length-1];n.sum=n.sum+t.sum,n.quantity+=t.quantity;var u=[].concat(Object(w.a)(e.slice(0,e.length-1)),[n]);return Object(w.a)(u)}return[].concat(Object(w.a)(e),[{title:t.title,sum:t.sum,quantity:t.quantity}])}),[]).map((function(e,t){return u.a.createElement(h.E,{key:t,multiline:!0,caption:"\u041a\u043e\u043b-\u0432\u043e: ".concat(null===e||void 0===e?void 0:e.quantity," | \u0421\u0440. \u0446\u0435\u043d\u0430 ").concat(g((null===e||void 0===e?void 0:e.sum)/(null===e||void 0===e?void 0:e.quantity))),after:g(null===e||void 0===e?void 0:e.sum),"data-title":null===e||void 0===e?void 0:e.title},null===e||void 0===e?void 0:e.title)}));Object(n.useEffect)((function(){var e=a.map((function(e){return e.operations})).flat().filter((function(e){return!e.income})).sort((function(e,t){return e.title.localeCompare(t.title)}));i(e),p(e)}),[a]);return u.a.createElement(h.u,{id:t},u.a.createElement(h.v,null,"\u0421\u0432\u043e\u0434\u043a\u0430"),u.a.createElement(Q,{onRefresh:l}),u.a.createElement(h.G,{onChange:function(e){var t;t=e.currentTarget.value,p(""===t?a.map((function(e){return e.operations})).flat().filter((function(e){return!e.income})).sort((function(e,t){return e.title.localeCompare(t.title)})):a.map((function(e){return e.operations})).flat().filter((function(e){return!e.income})).sort((function(e,t){return e.title.localeCompare(t.title)})).filter((function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1})))}}),u.a.createElement(h.m,null,D,0===D.length&&u.a.createElement(h.k,null,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f")))},Ve=a(163),Ge=a.n(Ve),Ne=function(e){var t=e.id,a=e.dispatch,n=e.loading;return u.a.createElement(h.u,{id:t},u.a.createElement(h.A,{icon:n?u.a.createElement(h.J,{size:"large"}):u.a.createElement(Ge.a,null),action:!n&&u.a.createElement(h.c,{onClick:function(){a({type:"SET_ACTIVE_VIEW",payload:{view:"home",panel:"home"}})},id:"initial-button"},"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c"),stretched:!0},n?"\u041f\u043e\u0434\u0433\u043e\u0442\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043a \u0437\u0430\u043f\u0443\u0441\u043a\u0443":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0433\u043e\u0442\u043e\u0432\u043e"))},qe=function(){var e,t=Object(h.P)(),a=ne("/state"),l=Object(d.a)(a,2),o=l[0],r=o.response,s=o.isLoading,E=l[1],p=Object(n.useState)(!0),D=Object(d.a)(p,2),v=D[0],f=D[1],y=Object(n.useContext)(I),b=Object(d.a)(y,2),O=b[0],g=b[1],C=Object(n.useState)(0),T=Object(d.a)(C,2),j=T[0],S=T[1];Object(n.useEffect)((function(){le.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;"VKWebAppUpdateConfig"===a&&g({type:"SET_COLOR_SCHEME",payload:{scheme:n.scheme}})})),le.a.send("VKWebAppInit",{})}),[g]);var A=u.a.createElement(h.b,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u0412\u044b\u0439\u0442\u0438",mode:"destructive",autoclose:!0,action:function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.a.send("VKWebAppClose",{status:"success"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],onClose:function(){g({type:"SET_POPOUT",payload:{popout:null}})}},u.a.createElement("h2",null,"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f?"),u.a.createElement("p",null,"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438?"));Object(n.useEffect)((function(){v&&(E({params:{date:new Date(O.currentDate)}}),f(!1))}),[v,E,O.currentDate]),Object(n.useEffect)((function(){r&&(g({type:"SET_ACCOUNTS",payload:{accounts:(null===r||void 0===r?void 0:r.accounts)?null===r||void 0===r?void 0:r.accounts:[]}}),g({type:"SET_BUDGETS",payload:{budgets:(null===r||void 0===r?void 0:r.budgets)?null===r||void 0===r?void 0:r.budgets:[]}}))}),[r,g]),Object(n.useEffect)((function(){window.onpopstate=function(){var e=+new Date;O.canClose?g({type:"SET_POPOUT",payload:{popout:A}}):e-j>500?(S(e),g({type:"SET_HISTORY_BACK"})):window.history.pushState(null,null)}}),[g,O.history,O.modal,j,O.canClose,A]);var F=Object(n.useCallback)((function(){f(!0)}),[]),_=function(){g({type:"SET_MODAL",payload:{modal:null}})},w=u.a.createElement(h.t,{activeModal:O.modal,onClose:_},u.a.createElement(h.r,{id:"add-account",header:u.a.createElement(h.s,{left:t===h.a&&u.a.createElement(h.x,{onClick:_},u.a.createElement(re.a,null)),right:u.a.createElement(h.x,{onClick:_},t===h.o?"\u0417\u0430\u043a\u0440\u044b\u0442\u044c":null)},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0447\u0435\u0442")},u.a.createElement(ye,{onRefresh:F})),u.a.createElement(h.r,{id:"add-money",header:u.a.createElement(h.s,{left:t===h.a&&u.a.createElement(h.x,{onClick:_},u.a.createElement(re.a,null)),right:u.a.createElement(h.x,{onClick:_},t===h.o?"\u0417\u0430\u043a\u0440\u044b\u0442\u044c":null)},O.editedItem?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c")},u.a.createElement(he,{accounts:O.accounts,id:null===(e=O.account)||void 0===e?void 0:e._id,editedItem:O.editedItem,onRefresh:F,budget:O.budget})),u.a.createElement(h.r,{id:"add-budget",header:u.a.createElement(h.s,{left:t===h.a&&u.a.createElement(h.x,{onClick:_},u.a.createElement(re.a,null)),right:u.a.createElement(h.x,{onClick:_},t===h.o?"\u0417\u0430\u043a\u0440\u044b\u0442\u044c":null)},O.editedItem?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u044e\u0434\u0436\u0435\u0442")},u.a.createElement(Me,{editedItem:O.editedItem,onRefresh:F,dispatch:g}))),x=function(e){g({type:"SET_ACTIVE_VIEW",payload:{view:e.currentTarget.dataset.story,panel:e.currentTarget.dataset.panel}})},B=u.a.createElement(h.K,null,u.a.createElement(h.L,{onClick:x,selected:"home"===O.activeView,"data-story":"home","data-panel":"home",text:"\u0411\u0430\u043b\u0430\u043d\u0441"},u.a.createElement(ie.a,null)),u.a.createElement(h.L,{onClick:x,selected:"info"===O.activeView&&("budgets"===O.activePanel||"budget"===O.activePanel),"data-story":"info","data-panel":"budgets",text:"\u0411\u044e\u0434\u0436\u0435\u0442\u044b"},u.a.createElement(se.a,null)),u.a.createElement(h.L,{onClick:x,selected:"info"===O.activeView&&"stats"===O.activePanel,"data-story":"info","data-panel":"stats",text:"\u0421\u0432\u043e\u0434\u043a\u0430"},u.a.createElement(Ee.a,null)));return u.a.createElement(h.g,{scheme:O.scheme},u.a.createElement(h.j,{activeStory:O.activeView,tabbar:"init"!==O.activeView&&"init"!==O.activePanel&&B},u.a.createElement(m.a,{id:"init",activePanel:O.activePanel},u.a.createElement(Ne,{id:"init",dispatch:g,loading:O.popout})),u.a.createElement(m.a,{id:"home",activePanel:O.activePanel,popout:O.popout,modal:w},u.a.createElement(X,{id:"home",accounts:O.accounts,budgets:O.budgets,dispatch:g,isLoading:s,onRefresh:F,isFetching:s})),u.a.createElement(m.a,{id:"info",activePanel:O.activePanel,popout:O.popout,modal:w},u.a.createElement(xe,{id:"account",account:O.accounts.find((function(e){var t;return e._id===(null===(t=O.account)||void 0===t?void 0:t._id)})),dispatch:g,onRefresh:F}),u.a.createElement(Le,{id:"budget",budget:O.budgets.find((function(e){var t;return e._id===(null===(t=O.budget)||void 0===t?void 0:t._id)})),dispatch:g,onRefresh:F}),u.a.createElement(Be,{id:"budgets",budgets:O.budgets,dispatch:g,onRefresh:F,date:O.currentDate}),u.a.createElement(He,{id:"stats",accounts:O.accounts,onRefresh:F,dispatch:g}))))};o.a.render(u.a.createElement(M,null,u.a.createElement(qe,null)),document.getElementById("root")),new URL(window.location.href).searchParams.get("vk_user_id")==="3479465".toString()&&Promise.all([a.e(3),a.e(4)]).then(a.bind(null,340)).then((function(){}))}},[[203,1,2]]]);
//# sourceMappingURL=main.6115e0a1.chunk.js.map